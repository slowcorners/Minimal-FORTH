                                                      ; ----------------------------------------------------------------------
                                                      ; M i n i m a l - F O R T H
                                                      ;
                                                      ; A minimal FORTH for the Minimal-CPU.
                                                      ;
                                                      ; Date:         2021-03-18
                                                      ; Version:      0.1
                                                      ; Author:       Nils "slowcorners" Kullberg
                                                      ; License:      MIT Open Source Initiative
                                                      ; ----------------------------------------------------------------------
                                                      
                                                      
                                                              ORG     0x8000
                                                              
                                                      
                                                      ; INCLUDE         defs.asm
                                                      
                                                      CH_BSP  EQU     8
                                                      CH_LF   EQU     10
                                                      CH_DEL  EQU     127
                                                      
                                                      ; INCLUDE         boot-table.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; BOOT TABLE
                                                      
8000 14 19 95                                         ORIGIN: JPA     CENT            ;  0: COLD start
8003 00                                                       NOP
8004 14 2B 95                                                 JPA     WENT            ;  4: WARM start
8007 00                                                       NOP
8008 00 00                                                    DW      0               ;  8: Processor type in radix 36
800A 00 00                                                    DW      0               ; 10: Revision
800C 5B 9C                                                    DW      HFORTH          ; 12: Pointer to latest word defined
800E 7F 00                                                    DW      CH_DEL          ; 14: Backspace character
8010 8E F6                                                    DW      XUP             ; 16: Pointer to initial user area
8012 B9 F5                                                    DW      XSP             ; 18: Initial data stack pointer
8014 8D F6                                                    DW      XRP             ; 20: Initial data stack pointer
8016 BA F5                                                    DW      XTIB            ; 22: Pointer to terminal input buffer
8018 1F 00                                                    DW      31              ; 24: Maximum FORTH word name length
801A 00 00                                                    DW      0               ; 26: Initial WARNING mode
801C 6D 9C                                                    DW      XDP             ; 28: Initial FENCE
801E 6D 9C                                                    DW      XDP             ; 30: Initial HERE
8020 6B 9C                                                    DW      XXVOC           ; 32: Pointer to initial VOC-LINK
8022 DF F6                                                    DW      DSKBF           ; 34: Initial FIRST
8024 E7 FE                                                    DW      ENDBF           ; 36: Initial LIMIT
8026 00 00                                                    DW      0               ; 38: unused
8028 00 00                                                    DW      0               ; 40: unused
                                                      
                                                      ; INCLUDE         helpers.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; HELPER FUNCTIONS
                                                      ;
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (IP)+
                                                      
802A 1D E8 FE                                         _LIT:   LDR     IP
802D 16 F2 FE                                                 STA     R1.0
8030 2E E8 FE                                                 INW     IP
8033 1D E8 FE                                                 LDR     IP
8036 16 F3 FE                                                 STA     R1.1
8039 2E E8 FE                                                 INW     IP
803C 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       IP = IP + (IP)+
                                                      
803D 1D E8 FE                                         _BRAN:  LDR     IP
8040 16 F2 FE                                                 STA     R1.0
8043 2E E8 FE                                                 INW     IP
8046 1D E8 FE                                                 LDR     IP
8049 16 F3 FE                                                 STA     R1.1
804C 2F E8 FE                                                 DEW     IP
804F 15 F2 FE                                                 LDA     R1.0
8052 28 E8 FE                                                 ADB     IP.0
8055 15 F3 FE                                                 LDA     R1.1
8058 2A E9 FE                                                 ACB     IP.1
805B 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (SP) "half function"
                                                      
805C 1D EC FE                                         _GET1_: LDR     SP
805F 16 F2 FE                                                 STA     R1.0
8062 2E EC FE                                                 INW     SP
8065 1D EC FE                                                 LDR     SP
8068 16 F3 FE                                                 STA     R1.1
806B 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (SP)
                                                      
806C 38 5C 80                                         _GET1:  JPS     _GET1_
806F 2F EC FE                                                 DEW     SP
8072 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (SP)+
                                                      
8073 38 5C 80                                         _POP1:  JPS     _GET1_
8076 2E EC FE                                                 INW     SP
8079 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1X = (SP)+
                                                      
807A 1D EC FE                                         _DPOP1: LDR     SP
807D 16 F2 FE                                                 STA     R1.0
8080 2E EC FE                                                 INW     SP
8083 1D EC FE                                                 LDR     SP
8086 16 F3 FE                                                 STA     R1.1
8089 2E EC FE                                                 INW     SP
808C 1D EC FE                                                 LDR     SP
808F 16 F4 FE                                                 STA     R1.2
8092 2E EC FE                                                 INW     SP
8095 1D EC FE                                                 LDR     SP
8098 16 F5 FE                                                 STA     R1.3
809B 2E EC FE                                                 INW     SP
809E 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R2 = (SP) "half function"
                                                      
809F 1D EC FE                                         _GET2_: LDR     SP
80A2 16 F6 FE                                                 STA     R2.0
80A5 2E EC FE                                                 INW     SP
80A8 1D EC FE                                                 LDR     SP
80AB 16 F7 FE                                                 STA     R2.1
80AE 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R2 = (SP)
                                                      
80AF 38 9F 80                                         _GET2:  JPS     _GET2_
80B2 2F EC FE                                                 DEW     SP
80B5 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (SP)+
                                                      
80B6 38 9F 80                                         _POP2:  JPS     _GET2_
80B9 2E EC FE                                                 INW     SP
80BC 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R2X = (SP)+
                                                      
80BD 1D EC FE                                         _DPOP2: LDR     SP
80C0 16 F6 FE                                                 STA     R2.0
80C3 2E EC FE                                                 INW     SP
80C6 1D EC FE                                                 LDR     SP
80C9 16 F7 FE                                                 STA     R2.1
80CC 2E EC FE                                                 INW     SP
80CF 1D EC FE                                                 LDR     SP
80D2 16 F8 FE                                                 STA     R2.2
80D5 2E EC FE                                                 INW     SP
80D8 1D EC FE                                                 LDR     SP
80DB 16 F9 FE                                                 STA     R2.3
80DE 2E EC FE                                                 INW     SP
80E1 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R3 = (SP) "half function"
                                                      
80E2 1D EC FE                                         _GET3_: LDR     SP
80E5 16 FA FE                                                 STA     R3.0
80E8 2E EC FE                                                 INW     SP
80EB 1D EC FE                                                 LDR     SP
80EE 16 FB FE                                                 STA     R3.1
80F1 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R3 = (SP)
                                                      
80F2 38 E2 80                                         _GET3:  JPS     _GET3_
80F5 2F EC FE                                                 DEW     SP
80F8 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R3 = (SP)+
                                                      
80F9 38 E2 80                                         _POP3:  JPS     _GET3_
80FC 2E EC FE                                                 INW     SP
80FF 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R2 = (SP)+
                                                      ;       R1 = (SP)+
                                                      
8100 38 B6 80                                         _POP21: JPS     _POP2
8103 38 73 80                                                 JPS     _POP1
8106 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (RP) "half function"
                                                      
8107 1D EE FE                                         _RGET1_: LDR    RP
810A 16 F2 FE                                                 STA     R1.0
810D 2E EE FE                                                 INW     RP
8110 1D EE FE                                                 LDR     RP
8113 16 F3 FE                                                 STA     R1.1
8116 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (RP)
                                                      
8117 38 07 81                                         _RGET1: JPS     _RGET1_
811A 2F EE FE                                                 DEW     RP
811D 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (RP)+
                                                      
811E 38 07 81                                         _RPOP1: JPS     _RGET1_
8121 2E EE FE                                                 INW     RP
8124 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R2 = (RP) "half function"
                                                      
8125 1D EE FE                                         _RGET2_: LDR    RP
8128 16 F6 FE                                                 STA     R2.0
812B 2E EE FE                                                 INW     RP
812E 1D EE FE                                                 LDR     RP
8131 16 F7 FE                                                 STA     R2.1
8134 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R2 = (RP)
                                                      
8135 38 25 81                                         _RGET2: JPS     _RGET2_
8138 2F EE FE                                                 DEW     RP
813B 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (RP)
                                                      
813C 38 25 81                                         _RPOP2: JPS     _RGET2_
813F 2E EE FE                                                 INW     RP
8142 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R3 = (RP) "half function"
                                                      
8143 1D EE FE                                         _RGET3_: LDR    RP
8146 16 FA FE                                                 STA     R3.0
8149 2E EE FE                                                 INW     RP
814C 1D EE FE                                                 LDR     RP
814F 16 FB FE                                                 STA     R3.1
8152 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R3 = (RP)
                                                      
8153 38 43 81                                         _RGET3: JPS     _RGET3_
8156 2F EE FE                                                 DEW     RP
8159 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R3 = (RP)
                                                      
815A 38 43 81                                         _RPOP3: JPS     _RGET3_
815D 2E EE FE                                                 INW     RP
8160 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (SP) = R1 "half function"
                                                      
8161 15 F3 FE                                         _PUT1_: LDA     R1.1
8164 1E EC FE                                                 STR     SP
8167 2F EC FE                                                 DEW     SP
816A 15 F2 FE                                                 LDA     R1.0
816D 1E EC FE                                                 STR     SP
8170 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (SP) = R1
                                                      
8171 2E EC FE                                         _PUT1:  INW     SP
8174 38 61 81                                                 JPS     _PUT1_
8177 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       -(SP) = R1
                                                      
8178 2F EC FE                                         _PUSH1: DEW     SP
817B 38 61 81                                                 JPS     _PUT1_
817E 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (SP) = R2 "half function"
                                                      
817F 15 F7 FE                                         _PUT2_: LDA     R2.1
8182 1E EC FE                                                 STR     SP
8185 2F EC FE                                                 DEW     SP
8188 15 F6 FE                                                 LDA     R2.0
818B 1E EC FE                                                 STR     SP
818E 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (SP) = R2
                                                      
818F 2E EC FE                                         _PUT2:  INW     SP
8192 38 7F 81                                                 JPS     _PUT2_
8195 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       -(SP) = R2
                                                      
8196 2F EC FE                                         _PUSH2: DEW     SP
8199 38 7F 81                                                 JPS     _PUT2_
819C 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (SP) = R3 "half function"
                                                      
819D 15 FB FE                                         _PUT3_: LDA     R3.1
81A0 1E EC FE                                                 STR     SP
81A3 2F EC FE                                                 DEW     SP
81A6 15 FA FE                                                 LDA     R3.0
81A9 1E EC FE                                                 STR     SP
81AC 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (SP) = R3
                                                      
81AD 2E EC FE                                         _PUT3:  INW     SP
81B0 38 9D 81                                                 JPS     _PUT3_
81B3 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       -(SP) = R3
                                                      
81B4 2F EC FE                                         _PUSH3: DEW     SP
81B7 38 9D 81                                                 JPS     _PUT3_
81BA 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (RP) = R1 "half function"
                                                      
81BB 15 F3 FE                                         _RPUT1_: LDA    R1.1
81BE 1E EE FE                                                 STR     RP
81C1 2F EE FE                                                 DEW     RP
81C4 15 F2 FE                                                 LDA     R1.0
81C7 1E EE FE                                                 STR     RP
81CA 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (RP) = R1
                                                      
81CB 2E EE FE                                         _RPUT1: INW     RP
81CE 38 BB 81                                                 JPS     _RPUT1_
81D1 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       -(RP) = R1
                                                      
81D2 2F EE FE                                         _RPUSH1: DEW    RP
81D5 38 BB 81                                                 JPS     _RPUT1_
81D8 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (RP) = R2 "half function"
                                                      
81D9 15 F7 FE                                         _RPUT2_: LDA    R2.1
81DC 1E EE FE                                                 STR     RP
81DF 2F EE FE                                                 DEW     RP
81E2 15 F6 FE                                                 LDA     R2.0
81E5 1E EE FE                                                 STR     RP
81E8 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (RP) = R2
                                                      
81E9 2E EE FE                                         _RPUT2: INW     RP
81EC 38 D9 81                                                 JPS     _RPUT2_
81EF 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       -(RP) = R2
                                                      
81F0 2F EE FE                                         _RPUSH2: DEW    RP
81F3 38 D9 81                                                 JPS     _RPUT2_
81F6 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (RP) = R3 "half function"
                                                      
81F7 15 FB FE                                         _RPUT3_: LDA    R3.1
81FA 1E EE FE                                                 STR     RP
81FD 2F EE FE                                                 DEW     RP
8200 15 FA FE                                                 LDA     R3.0
8203 1E EE FE                                                 STR     RP
8206 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (RP) = R3
                                                      
8207 2E EE FE                                         _RPUT3: INW     RP
820A 38 F7 81                                                 JPS     _RPUT3_
820D 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       -(RP) = R3
                                                      
820E 2F EE FE                                         _RPUSH3: DEW    RP
8211 38 F7 81                                                 JPS     _RPUT3_
8214 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = R1 + R2
                                                      
8215 15 F6 FE                                         _ADD16: LDA     R2.0
8218 28 F2 FE                                                 ADB     R1.0
821B 15 F7 FE                                                 LDA     R2.1
821E 2A F3 FE                                                 ACB     R1.1
8221 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1X = R1X + R2X
                                                      
8222 15 F6 FE                                         _ADD32: LDA     R2.0
8225 28 F2 FE                                                 ADB     R1.0
8228 15 F7 FE                                                 LDA     R2.1
822B 2A F3 FE                                                 ACB     R1.1
822E 15 F8 FE                                                 LDA     R2.2
8231 2A F4 FE                                                 ACB     R1.2
8234 15 F9 FE                                                 LDA     R2.3
8237 2A F5 FE                                                 ACB     R1.3
823A 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (R3)
                                                      
823B 1D FA FE                                         _LD16:  LDR     R3
823E 16 F2 FE                                                 STA     R1.0
8241 2E FA FE                                                 INW     R3
8244 1D FA FE                                                 LDR     R3
8247 16 F3 FE                                                 STA     R1.1
824A 2F FA FE                                                 DEW     R3
824D 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (R3) = R1
                                                      
824E 15 F2 FE                                         _ST16:  LDA     R1.0
8251 1E FA FE                                                 STR     R3
8254 2E FA FE                                                 INW     R3
8257 15 F3 FE                                                 LDA     R1.1
825A 1E FA FE                                                 STR     R3
825D 2F FA FE                                                 DEW     R3
8260 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1.0 = R1.0 & R2.0
                                                      
8261 0E 08                                            _AND8:  LDI     8               ; Load bit counter
8263 16 FE FE                                                 STA     BC              ; :
8266 15 F6 FE                                         _AND81: LDA     R2.0            ; Load second operand
8269 05                                                       LSL                     ; Shift 2b7 into C
826A 16 F6 FE                                                 STA     R2.0            ; Store shifted second operand
826D 15 F2 FE                                                 LDA     R1.0            ; Load first operand
8270 3C 79 82                                                 BCC     _AND82          ; If C is clear: Shift in a zero
                                                              ; 2b7 is set
8273 11 00                                                    CPI     0               ; Is first operand < 0, i.e. is 1b7 set?
8275 3F 79 82                                                 BMI     _AND82           ; N is set: 1b7 is set
                                                              ; 1b7 is clear
8278 03                                                       CLC                     ; 1b7 is clear: Clear C
8279 06                                               _AND82: ROL                     ; Shift C into result
827A 16 F2 FE                                                 STA     R1.0            ; Store first operand/result
827D 27 FE FE                                                 DEB     BC              ; All bits done?
8280 3A 66 82                                                 BNE     _AND81          ;   NO: Do one more
8283 39                                                       RTS                     ;   YES: All done
                                                      
                                                      ; ------------------------------
                                                      ;       R1.0 = R1.0 | R2.0
                                                      
8284 0E 08                                            _OR8:   LDI     8               ; Load bit counter
8286 16 FE FE                                                 STA     BC              ; :
8289 15 F6 FE                                         _OR810: LDA     R2.0            ; Load second operand
828C 05                                                       LSL                     ; Shift 2b7 into C
828D 16 F6 FE                                                 STA     R2.0            ; Store shifted second operand
8290 15 F2 FE                                                 LDA     R1.0            ; Load first operand
8293 3D 9C 82                                                 BCS     _OR820          ; If C is set, shift it into result
                                                              ; 2b7 is clear
8296 11 00                                                    CPI     0               ; Is first operand < 0, i.e. is 1b7 set?
8298 3F 9C 82                                                 BMI     _OR820          ; N is clear: 1b7 is clear
                                                              ; 1b7 is clear
829B 03                                                       CLC                     ; Neither bit is set: Clear C 
829C 06                                               _OR820: ROL                     ; Shift C into result
829D 16 F2 FE                                                 STA     R1.0            ; Store first operand/result
82A0 27 FE FE                                                 DEB     BC              ; All bits done?
82A3 3A 89 82                                                 BNE     _OR810          ;   NO: Do one more
82A6 39                                                       RTS                     ;   YES: All done
                                                      
                                                      ; ------------------------------
                                                      ;       R1.0 = R1.0 ^ R2.0
                                                      
82A7 0E 08                                            _XOR8:  LDI     8               ; Load bit counter
82A9 16 FE FE                                                 STA     BC              ; :
82AC 15 F6 FE                                         _XOR81: LDA     R2.0            ; Get second operand
82AF 05                                                       LSL                     ; Shift b7 into C
82B0 16 F6 FE                                                 STA     R2.0            ; Store shifted second operand
82B3 15 F2 FE                                                 LDA     R1.0            ; Load first operand
82B6 3D C1 82                                                 BCS     _XOR82          ; C is set, check 1b7 for zero
                                                              ; 2b7 is clear
82B9 11 00                                                    CPI     0               ; Is first operand < 0, i.e. is b7 set?
82BB 3F C7 82                                                 BMI     _XOR84          ; 1b7 is set and 2b7 is clear, shift in C which is set
82BE 14 C6 82                                                 JPA     _XOR83          ; 1b7 and 2b7 are both zero, clear C and shift in 
                                                              ; 2b7 is set, check 1b7 for zero
82C1 11 00                                            _XOR82: CPI     0
82C3 3E C7 82                                                 BPL     _XOR84          ; If 1b7 is zero, shift in C which is set
82C6 03                                               _XOR83: CLC                     ; 1b7 and 2b7 are equal, shift in a zero
82C7 06                                               _XOR84: ROL                     ; Shift whatever is in C into result
82C8 16 F2 FE                                                 STA     R1.0            ; Store first operand/result
82CB 27 FE FE                                                 DEB     BC              ; All bits done?
82CE 3A AC 82                                                 BNE     _XOR81          ;   NO: Do one more
82D1 39                                                       RTS                     ;   YES: All done
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = ~R1
                                                      
82D2 15 F5 FE                                         _NOT32: LDA     R1.3            ; Negate MSB
82D5 0B                                                       NEG                     ; Two-complement negation
82D6 10 01                                                    SBI     1               ; Adjust to bitwise not
82D8 16 F5 FE                                                 STA     R1.3            ; Store negated MSB
82DB 15 F4 FE                                                 LDA     R1.2            ; Negate byte2
82DE 0B                                                       NEG                     ; Two-complement negation
82DF 10 01                                                    SBI     1               ; Adjust to bitwise not
82E1 16 F4 FE                                                 STA     R1.2            ; Store negated byte2
82E4 15 F3 FE                                         _NOT16: LDA     R1.1            ; Negate byte1
82E7 0B                                                       NEG                     ; Two-complement negation
82E8 10 01                                                    SBI     1               ; Adjust to bitwise not
82EA 16 F3 FE                                                 STA     R1.1            ; Store negated byte1
82ED 15 F2 FE                                                 LDA     R1.0            ; Negate LSB
82F0 0B                                                       NEG                     ; Two-complement negation
82F1 10 01                                                    SBI     1               ; Adjust to bitwise not
82F3 16 F2 FE                                                 STA     R1.0            ; Store negated LSB
82F6 39                                                       RTS                     ; Done
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = -R1
                                                      
82F7 38 E4 82                                         _NEG16: JPS     _NOT16          ; Bitwise NOT R1
82FA 0E 01                                                    LDI     1               ; Add one to make it 2-complement
82FC 28 F2 FE                                                 ADB     R1.0            ; :
82FF 0E 00                                                    LDI     0               ; :
8301 2A F3 FE                                                 ACB     R1.1            ; :
8304 39                                                       RTS                     ; Done
                                                      
                                                      ; ------------------------------
                                                      ;       R1X = -R1X
                                                      
8305 38 D2 82                                         _NEG32: JPS     _NOT32          ; Bitwise NOT R1X
8308 0E 01                                                    LDI     1               ; Add one to make it 2-complement
830A 28 F2 FE                                                 ADB     R1.0            ; :
830D 0D                                                       DEC                     ; :
830E 2A F3 FE                                                 ACB     R1.1            ; :
8311 2A F4 FE                                                 ACB     R1.2            ; :
8314 2A F5 FE                                                 ACB     R1.3            ; :
8317 39                                                       RTS                     ; Done
                                                      
                                                      ; ------------------------------
                                                      ;       R1 <-> R2
                                                      
8318 38 78 81                                         _XCH16: JPS     _PUSH1          ; Temp = R1
831B 15 F6 FE                                                 LDA     R2.0            ; R1 = R2
831E 16 F2 FE                                                 STA     R1.0            ; :
8321 15 F7 FE                                                 LDA     R2.1            ; :
8324 16 F3 FE                                                 STA     R1.1            ; :
8327 38 B6 80                                                 JPS     _POP2           ; R2 = Temp
832A 39                                                       RTS                     ; Done
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (R1)
                                                      
832B 1D F2 FE                                         _AT:    LDR     R1              ; Get LSB
832E 16 F4 FE                                                 STA     R1.2            ; ... Store temp
8331 2E F2 FE                                                 INW     R1              ; Bump
8334 1D F2 FE                                                 LDR     R1              ; Get MSB
8337 16 F5 FE                                                 STA     R1.3            ; ... Store temp
833A 15 F4 FE                                                 LDA     R1.2            ; Get temp LSB
833D 16 F2 FE                                                 STA     R1.0            ; ... Store
8340 15 F5 FE                                                 LDA     R1.3            ; Get temp MSB
8343 16 F3 FE                                                 STA     R1.1            ; ... Store
8346 39                                                       RTS                     ; Done
                                                      
                                                      ; ------------------------------
                                                      ;       "HALT"
                                                      
8347 49 83                                            _HALT:  DW      _HALT0
8349 14 49 83                                         _HALT0: JPA     _HALT0
                                                      
                                                      ; ------------------------------
                                                      ;       +ORIGIN
                                                      ; NOTE: Index number in R2
                                                      
834C 0E 00                                            _PORIG: LDI     <ORIGIN         ; R1 = ORIGIN address
834E 16 F2 FE                                                 STA     R1.0            ; :
8351 0E 80                                                    LDI     >ORIGIN         ; :
8353 16 F3 FE                                                 STA     R1.1            ; :
8356 15 F6 FE                                                 LDA     R2.0            ; Get index number
8359 30 F2 FE                                                 ADW     R1              ; Compute addr
835C 39                                                       RTS                     ; Done
                                                      
                                                      ; ------------------------------
                                                      ;       _USER
                                                      ; NOTE: Index number in R2
                                                      
835D 15 F0 FE                                         _USER:  LDA     UP.0            ; R1 = UP
8360 16 F2 FE                                                 STA     R1.0            ; :
8363 15 F1 FE                                                 LDA     UP.1            ; :
8366 16 F3 FE                                                 STA     R1.1            ; :
8369 15 F6 FE                                                 LDA     R2.0            ; Get index number
836C 30 F2 FE                                                 ADW     R1              ; Compute addr
836F 39                                                       RTS                     ; Done
                                                      
                                                      ; ------------------------------
                                                      ;       _SWAP8
                                                      ; Swaps R1.1 <-> R1.0
                                                      ;       R2.1 <-> R2.0
                                                      
8370 15 F2 FE                                         _SWAP8: LDA     R1.0
8373 16 FF FE                                                 STA     TMP
8376 15 F3 FE                                                 LDA     R1.1
8379 16 F2 FE                                                 STA     R1.0
837C 15 FF FE                                                 LDA     TMP
837F 16 F3 FE                                                 STA     R1.1
8382 15 F6 FE                                                 LDA     R2.0
8385 16 FF FE                                                 STA     TMP
8388 15 F7 FE                                                 LDA     R2.1
838B 16 F6 FE                                                 STA     R2.0
838E 15 FF FE                                                 LDA     TMP
8391 16 F7 FE                                                 STA     R2.1
8394 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = R1 & R2
                                                      
8395 38 61 82                                         _AND16: JPS     _AND8
8398 38 70 83                                                 JPS     _SWAP8
839B 38 61 82                                                 JPS     _AND8
839E 38 70 83                                                 JPS     _SWAP8
83A1 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = R1 | R2
                                                      
83A2 38 84 82                                         _OR16:  JPS     _OR8
83A5 38 70 83                                                 JPS     _SWAP8
83A8 38 84 82                                                 JPS     _OR8
83AB 38 70 83                                                 JPS     _SWAP8
83AE 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = R1 ^ R2
                                                      
83AF 38 A7 82                                         _XOR16: JPS     _XOR8
83B2 38 70 83                                                 JPS     _SWAP8
83B5 38 A7 82                                                 JPS     _XOR8
83B8 38 70 83                                                 JPS     _SWAP8
83BB 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1X = R1X * R2X
                                                      
83BC 0E 00                                            _UMULT: LDI     0               ; R1H = 0
83BE 16 F4 FE                                                 STA     R1.2
83C1 16 F5 FE                                                 STA     R1.3
83C4 16 F8 FE                                                 STA     R2.2            ; R2H = 0
83C7 16 F9 FE                                                 STA     R2.3
83CA 16 FC FE                                                 STA     R3.2            ; R3H = 0
83CD 16 FD FE                                                 STA     R3.3
                                                      
83D0 15 F2 FE                                                 LDA     R1.0            ; R3L = R1L
83D3 16 FA FE                                                 STA     R3.0
83D6 15 F3 FE                                                 LDA     R1.1
83D9 16 FB FE                                                 STA     R3.1
                                                      
83DC 0E 00                                                    LDI     0               ; R1L = 0
83DE 16 F2 FE                                                 STA     R1.0
83E1 16 F3 FE                                                 STA     R1.1
                                                      
83E4 0E 10                                                    LDI     16              ; Set bit counter
83E6 16 FE FE                                                 STA     BC
                                                      
83E9 15 FB FE                                         _UMU10: LDA     R3.1            ; R3L = R3L >> 1
83EC 07                                                       LSR
83ED 16 FB FE                                                 STA     R3.1
83F0 15 FA FE                                                 LDA     R3.0
83F3 08                                                       ROR
83F4 16 FA FE                                                 STA     R3.0
83F7 3C FD 83                                                 BCC     _UMU20
                                                      
83FA 38 22 82                                                 JPS     _ADD32          ; R1X = R1X + R2X
                                                      
83FD 15 F6 FE                                         _UMU20: LDA     R2.0            ; R2X = R2X << 1
8400 05                                                       LSL
8401 16 F6 FE                                                 STA     R2.0
8404 15 F7 FE                                                 LDA     R2.1
8407 06                                                       ROL
8408 16 F7 FE                                                 STA     R2.1
840B 15 F8 FE                                                 LDA     R2.2
840E 06                                                       ROL
840F 16 F8 FE                                                 STA     R2.2
8412 15 F9 FE                                                 LDA     R2.3
8415 06                                                       ROL
8416 16 F9 FE                                                 STA     R2.3
                                                      
8419 27 FE FE                                                 DEB     BC
841C 3A E9 83                                                 BNE     _UMU10
841F 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1X / R2L
                                                      ;       R1H: Quotient
                                                      ;       R1L: Remainder
                                                      
8420 0E 10                                            _UDIV:  LDI     16              ; Set bit counter
8422 16 FE FE                                                 STA     BC              ; :
                                                              
8425 15 F2 FE                                         _UDI10: LDA     R1.0            ; R1X = R1X << 1
8428 05                                                       LSL                     ; :
8429 16 F2 FE                                                 STA     R1.0            ; :
842C 15 F3 FE                                                 LDA     R1.1            ; :
842F 06                                                       ROL                     ; :
8430 16 F3 FE                                                 STA     R1.1            ; :
8433 15 F4 FE                                                 LDA     R1.2            ; :
8436 06                                                       ROL                     ; :
8437 16 F4 FE                                                 STA     R1.2            ; :
843A 15 F5 FE                                                 LDA     R1.3            ; :
843D 06                                                       ROL                     ; :
843E 16 F5 FE                                                 STA     R1.3            ; :
                                                      
8441 15 F4 FE                                                 LDA     R1.2            ; R3H = R1H
8444 16 FC FE                                                 STA     R3.2            ; :
8447 15 F5 FE                                                 LDA     R1.3            ; :
844A 16 FD FE                                                 STA     R3.3            ; :
                                                              
844D 15 FC FE                                                 LDA     R3.2            ; R3H = R3H - R2L
8450 18 F6 FE                                                 SBA     R2.0            ; :
8453 16 FC FE                                                 STA     R3.2            ; :
8456 15 FD FE                                                 LDA     R3.3            ; :
8459 1B F7 FE                                                 SCA     R2.1            ; :
845C 16 FD FE                                                 STA     R3.3            ; :
                                                              
845F 3C 71 84                                                 BCC     _UDI20
                                                              
8462 15 FC FE                                                 LDA     R3.2            ; R1H = R3H
8465 16 F4 FE                                                 STA     R1.2            ; :
8468 15 FD FE                                                 LDA     R3.3            ; :
846B 16 F5 FE                                                 STA     R1.3            ; :
                                                              
846E 2E F2 FE                                                 INW     R1.0            ; R1L++
                                                              
8471 27 FE FE                                         _UDI20: DEB     BC              ; All bits done?
8474 3A 25 84                                                 BNE     _UDI10          ; NO: Loop again
                                                              
8477 39                                                       RTS
                                                      
                                                      ; INCLUDE         inner.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; INNER INTERPRETER
                                                      
8478 2F EC FE                                         IPUSH:  DEW     SP              ; -(SP) = R1H
847B 15 F5 FE                                                 LDA     R1.3
847E 1E EC FE                                                 STR     SP
8481 2F EC FE                                                 DEW     SP
8484 15 F4 FE                                                 LDA     R1.2
8487 1E EC FE                                                 STR     SP
848A 2F EC FE                                         PUSH:   DEW     SP              ; -(SP) = R1L
848D 15 F3 FE                                                 LDA     R1.1
8490 1E EC FE                                                 STR     SP
8493 2F EC FE                                                 DEW     SP
8496 15 F2 FE                                                 LDA     R1.0
8499 1E EC FE                                                 STR     SP
849C 1D E8 FE                                         NEXT:   LDR     IP              ; WA = (IP)+
849F 16 EA FE                                                 STA     WA.0
84A2 2E E8 FE                                                 INW     IP
84A5 1D E8 FE                                                 LDR     IP
84A8 16 EB FE                                                 STA     WA.1
84AB 2E E8 FE                                                 INW     IP
84AE 1D EA FE                                         NEXT10: LDR     WA              ; R1 = (WA)+
84B1 16 F2 FE                                                 STA     R1.0
84B4 2E EA FE                                                 INW     WA
84B7 1D EA FE                                                 LDR     WA
84BA 16 F3 FE                                                 STA     R1.1
84BD 2E EA FE                                                 INW     WA
84C0 1C F2 FE                                                 JPR     R1              ; jump @(R1)
                                                      
                                                      ; ------------------------------
                                                      ;       Push TRUE and FALSE
                                                      
84C3 2C F2 FE                                         PUSHT:  CLW     R1              ; A zero
84C6 2F F2 FE                                                 DEW     R1              ; Make it into a -1 i.e. TRUE flag
84C9 14 8A 84                                                 JPA     PUSH
                                                      
84CC 2C F2 FE                                         PUSHF:  CLW     R1              ; A zero
84CF 14 8A 84                                                 JPA     PUSH
                                                      
                                                      ; ------------------------------
                                                      ;       Push R1X, MSB as TOS
                                                      
84D2 2F EC FE                                         DPUSH:  DEW     SP              ; -(SP) = R1X
84D5 15 F3 FE                                                 LDA     R1.1
84D8 1E EC FE                                                 STR     SP
84DB 2F EC FE                                                 DEW     SP
84DE 15 F2 FE                                                 LDA     R1.0
84E1 1E EC FE                                                 STR     SP
84E4 2F EC FE                                                 DEW     SP
84E7 15 F5 FE                                                 LDA     R1.3
84EA 1E EC FE                                                 STR     SP
84ED 2F EC FE                                                 DEW     SP
84F0 15 F4 FE                                                 LDA     R1.2
84F3 1E EC FE                                                 STR     SP
84F6 14 9C 84                                                 JPA     NEXT
                                                      
                                                      ; INCLUDE         primaries.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; FORTH PRIMARIES
                                                      ;
                                                      
84F9 83 4C 49 D4                                      HLIT:   DB      ^3 "LI" ^'T'                            ; ***** LIT
84FD 00 00                                                    DW      0
84FF 01 85                                            LIT:    DW      LIT0
8501 38 2A 80                                         LIT0:   JPS     _LIT            ; R1 = (IP)+
8504 14 8A 84                                                 JPA     PUSH            ; -(SP) = R1; NEXT
                                                      
8507 87 45 58 45 43 55 54 C5                          HEXEC:  DB      ^7 "EXECUT" ^'E'                        ; ***** EXECUTE
850F F9 84                                                    DW      HLIT
8511 13 85                                            EXEC:   DW      EXEC0
8513 1D EC FE                                         EXEC0:  LDR     SP              ; WA = (SP)+
8516 16 EA FE                                                 STA     WA.0
8519 2E EC FE                                                 INW     SP
851C 1D EC FE                                                 LDR     SP
851F 16 EB FE                                                 STA     WA.1
8522 2E EC FE                                                 INW     SP
8525 14 AE 84                                                 JPA     NEXT10          ; jump @(WA)+
                                                      
8528 86 42 52 41 4E 43 C8                             HBRAN:  DB      ^6 "BRANC" ^'H'                         ; ***** BRANCH
852F 07 85                                                    DW      HEXEC
8531 33 85                                            BRAN:   DW      BRAN0
8533 38 3D 80                                         BRAN0:  JPS     _BRAN           ; IP = IP + (IP)
8536 14 9C 84                                                 JPA     NEXT
                                                      
8539 87 30 42 52 41 4E 43 C8                          HZBRAN: DB      ^7 "0BRANC" ^'H'                        ; ***** 0BRANCH
8541 28 85                                                    DW      HBRAN
8543 45 85                                            ZBRAN:  DW      ZBRAN0
8545 1D EC FE                                         ZBRAN0: LDR     SP
8548 11 00                                                    CPI     0               ; Low byte non-zero?
854A 3A 5E 85                                                 BNE     ZBRA10          ; YES: Do not branch
854D 2E EC FE                                                 INW     SP
8550 1D EC FE                                                 LDR     SP
8553 11 00                                                    CPI     0               ; High byte non-zero?
8555 3A 61 85                                                 BNE     ZBRA20          ; YES: Do not branch
8558 2E EC FE                                                 INW     SP
855B 14 33 85                                                 JPA     BRAN0           ; IP = IP + (IP); NEXT
855E 2E EC FE                                         ZBRA10: INW     SP
8561 2E EC FE                                         ZBRA20: INW     SP
8564 2E E8 FE                                                 INW     IP              ; Just skip jump offset
8567 2E E8 FE                                                 INW     IP
856A 14 9C 84                                                 JPA     NEXT
                                                      
856D 87 28 2B 4C 4F 4F 50 A9                          HXPLOO: DB      ^7 "(+LOOP" ^')'                        ; ***** (+LOOP)
8575 39 85                                                    DW      HZBRAN
8577 79 85                                            XPLOO:  DW      XPLOO0
8579 38 AF 80                                         XPLOO0: JPS     _GET2           ; R2 = (SP) [only copying increment]
857C 38 1E 81                                                 JPS     _RPOP1          ; R1 = (RP)+
857F 38 15 82                                                 JPS     _ADD16          ; R1 = counter'
8582 38 35 81                                                 JPS     _RGET2          ; R2 = limit
8585 38 D2 81                                                 JPS     _RPUSH1         ; -(RP) = R1'
8588 38 F9 80                                                 JPS     _POP3           ; R3 = (SP)+ [now popping incr]
858B 15 FB FE                                                 LDA     R3.1            ; Is increment negative?
858E 11 00                                                    CPI     0               ; :
8590 3E 96 85                                                 BPL     XPLO10
                                                              ; Handle negative increment
8593 38 18 83                                                 JPS     _XCH16          ; R1 <-> R2
                                                              ; Compare counter to limit
8596 15 F3 FE                                         XPLO10: LDA     R1.1            ; Compare MSB
8599 19 F7 FE                                                 CPA     R2.1            ; :
859C 3F 33 85                                                 BMI     BRAN0           ; R2 is greater, continue looping
859F 3B A5 85                                                 BEQ     XPLO20          ; MSBs are equal, check LSBs
85A2 14 AE 85                                                 JPA     XPLO30          ; R1 is greater, stop looping
                                                              ; MSBs are equal
85A5 15 F2 FE                                         XPLO20: LDA     R1.0            ; Compare LSB
85A8 19 F6 FE                                                 CPA     R2.0            
85AB 3F 33 85                                                 BMI     BRAN0           ; R2 is greater, continue looping
                                                              ; Limit reached, cleanup rstack and stop looping
85AE 0E 04                                            XPLO30: LDI     4               ; Drop loop counter ...
85B0 30 EE FE                                                 ADW     RP              ; ... and loop limit
85B3 0E 02                                                    LDI     2               ; Skip branch offset
85B5 30 E8 FE                                                 ADW     IP              ; :
85B8 14 9C 84                                                 JPA     NEXT
                                                      
85BB 86 28 4C 4F 4F 50 A9                             HXLOOP: DB      ^6 "(LOOP" ^')'                         ; ***** (LOOP)
85C2 6D 85                                                    DW      HXPLOO
85C4 C6 85                                            XLOOP:  DW      XLOOP0
85C6 2C F2 FE                                         XLOOP0: CLW     R1              ; Push a one
85C9 2E F2 FE                                                 INW     R1              ; :
85CC 38 78 81                                                 JPS     _PUSH1          ; :
85CF 14 79 85                                                 JPA     XPLOO0          ; (+LOOP)
                                                      
85D2 84 28 44 4F A9                                   HXDO:   DB      ^4 "(DO" ^')'                           ; ***** (DO)
85D7 BB 85                                                    DW      HXLOOP
85D9 DB 85                                            XDO:    DW      XDO0
85DB 38 00 81                                         XDO0:   JPS     _POP21          ; Loop counter, limit
85DE 38 D2 81                                                 JPS     _RPUSH1         ; Push limit onto rstack
85E1 38 F0 81                                                 JPS     _RPUSH2         ; Push loop counter onto rstack
85E4 14 9C 84                                                 JPA     NEXT
                                                      
85E7 81 C9                                            HI:     DB      ^1 ^'I'                                 ; ***** I
85E9 D2 85                                                    DW      HXDO
85EB ED 85                                            I:      DW      I0
85ED 38 17 81                                         I0:     JPS     _RGET1          ; Get loop counter
85F0 14 8A 84                                                 JPA     PUSH            ; Push it onto dstack
                                                      
85F3 85 44 49 47 49 D4                                HDIGIT: DB      ^5 "DIGI" ^'T'                          ; ***** DIGIT
85F9 E7 85                                                    DW      HI
85FB FD 85                                            DIGIT:  DW      DIGIT0
85FD 38 00 81                                         DIGIT0: JPS     _POP21          ; R2 = base, R1 = char
8600 15 F2 FE                                                 LDA     R1.0            ; Get character into A
8603 10 30                                                    SBI     '0'             ; Assume '0' - '9'
8605 3F 21 86                                                 BMI     DIGI88          ; Oops! Negative
8608 11 0A                                                    CPI     10              ; Greater than 9?
860A 3F 0F 86                                                 BMI     DIGI10          ; No, it is 0 - 9
                                                              ; 'A' - 'Z' case
860D 10 07                                                    SBI     7               ; ch -= ('A' - '0') + 10
860F 19 F6 FE                                         DIGI10: CPA     R2.0            ; Greater than base?
8612 3F 18 86                                                 BMI     DIGI77
8615 14 21 86                                                 JPA     DIGI88
8618 16 F2 FE                                         DIGI77: STA     R1.0            ; Store binary value
861B 38 78 81                                                 JPS     _PUSH1          ; Push the value
861E 14 C3 84                                                 JPA     PUSHT           ; Push TRUE; NEXT
8621 14 CC 84                                         DIGI88: JPA     PUSHF           ; Push FALSE; NEXT
                                                      
8624 86 28 46 49 4E 44 A9                             HPFIND: DB      ^6 "(FIND" ^')'                         ; ***** (FIND)
862B F3 85                                                    DW      HDIGIT
862D 2F 86                                            PFIND:  DW      PFIND0
862F 38 73 80                                         PFIND0: JPS     _POP1           ; NFA
8632 38 F9 80                                                 JPS     _POP3           ; String address
8635 15 FA FE                                         PFIN10: LDA     R3.0            ; R2 = R3 (string address)
8638 16 F6 FE                                                 STA     R2.0            ; :
863B 15 FB FE                                                 LDA     R3.1            ; :
863E 16 F7 FE                                                 STA     R2.1            ; :
                                                              ; Fast comparison of length bytes
8641 1D F2 FE                                                 LDR     R1              ; Get lByte
8644 16 F4 FE                                                 STA     R1.2            ; ... Store as potential result
8647 05                                                       LSL                     ; lByte &= 0x3F
8648 05                                                       LSL                     ; :
8649 07                                                       LSR                     ; :
864A 07                                                       LSR                     ; :
864B 16 F8 FE                                                 STA     R2.2            ; R2.2 is counter for string match
864E 21 F6 FE                                                 CPR     R2              ; lByte == string length?
8651 3A 70 86                                                 BNE     PFIN25
                                                              ; Length bytes match, check names
8654 2E F2 FE                                         PFIN20: INW     R1              ; Bump pointers
8657 2E F6 FE                                                 INW     R2              ; :
865A 1D F2 FE                                                 LDR     R1              ; Get char from dictionary
865D 05                                                       LSL                     ; char &= 0x7F
865E 07                                                       LSR
865F 21 F6 FE                                                 CPR     R2              ; Is it a match with search string?
8662 3A 73 86                                                 BNE     PFIN30          ; NO: Look at next header in dictionary
8665 27 F8 FE                                                 DEB     R2.2            ; Decrement character counter
8668 11 00                                                    CPI     0               ; :
866A 3B 94 86                                                 BEQ     PFIN77          ; YES: This is the word we are looking for
866D 14 54 86                                                 JPA     PFIN20          ; Match so far, try next char
                                                              ; Step to next header in dictionary
8670 2E F2 FE                                         PFIN25: INW     R1              ; Bump NFA pointer to actual characters
8673 2E F2 FE                                         PFIN30: INW     R1              ; Bump NFA pointer
8676 27 F8 FE                                                 DEB     R2.2            ; Decrement character counter
8679 11 00                                                    CPI     0               ; End of name field?
867B 3A 73 86                                                 BNE     PFIN30          ; NO: Step to next char
867E 38 2B 83                                                 JPS     _AT             ; R1 = (R1)
8681 15 F3 FE                                                 LDA     R1.1            ; At end of dictionary?
8684 11 00                                                    CPI     0               ; :
8686 3A 35 86                                                 BNE     PFIN10          ; NO: Try this word for match
8689 15 F2 FE                                                 LDA     R1.0            ; :
868C 11 00                                                    CPI     0               ; :
868E 3A 35 86                                                 BNE     PFIN10          ; NO: Try this word for match
                                                              ; Word not found, return a single FALSE
8691 14 CC 84                                         PFIN88: JPA     PUSHF           ; Done
                                                              ; Word found, return PFA, lByte, TRUE
8694 0E 05                                            PFIN77: LDI     5               ; Bump ptr to PFA
8696 30 F2 FE                                                 ADW     R1              ; :
8699 38 78 81                                                 JPS     _PUSH1          ; Push PFA
869C 15 F4 FE                                                 LDA     R1.2            ; Get stored length byte
869F 16 F2 FE                                                 STA     R1.0            ; :
86A2 24 F3 FE                                                 CLB     R1.1            ; Clear MSB
86A5 38 78 81                                                 JPS     _PUSH1          ; Push length byte
86A8 14 C3 84                                                 JPA     PUSHT           ; Done
                                                      
86AB 87 45 4E 43 4C 4F 53 C5                          HENCL:  DB      ^7 "ENCLOS" ^'E'                        ; ***** ENCLOSE
86B3 24 86                                                    DW      HPFIND
86B5 B7 86                                            ENCL:   DW      ENCL0
86B7 38 F9 80                                         ENCL0:  JPS     _POP3           ; Get delimiter char
86BA 38 6C 80                                                 JPS     _GET1           ; Get addr of input
86BD 2C F6 FE                                                 CLW     R2              ; Initialize char index
                                                              ; Scan preceeding delimiters
86C0 1D F2 FE                                         ENCL10: LDR     R1              ; Get char from input
86C3 11 00                                                    CPI     0               ; Is it <NUL>?
86C5 3B FD 86                                                 BEQ     ENCL50          ; YES: <NUL> before first non-delimiter
86C8 19 FA FE                                                 CPA     R3.0            ; Is it a delimiter?
86CB 3A D7 86                                                 BNE     ENCL20          ; NO: We have the start of next token
86CE 2E F2 FE                                                 INW     R1              ; Bump to next char ...
86D1 26 F6 FE                                                 INB     R2.0            ; ... also increase index
86D4 14 C0 86                                                 JPA     ENCL10          ; Go back to look at next char
                                                              ; Start of token
86D7 38 96 81                                         ENCL20: JPS     _PUSH2          ; Push result n1 (first char of token)
86DA 1D F2 FE                                         ENCL30: LDR     R1              ; Get char from input
86DD 11 00                                                    CPI     0               ; Is it <NUL>?
86DF 3B 0C 87                                                 BEQ     ENCL60          ; YES: <NUL> found
86E2 19 FA FE                                                 CPA     R3.0            ; Is it a delimiter?
86E5 3B F1 86                                                 BEQ     ENCL40          ; YES: We have the end of the token
86E8 2E F2 FE                                                 INW     R1              ; Bump to next char ...
86EB 26 F6 FE                                                 INB     R2.0            ; ... also increase index
86EE 14 DA 86                                                 JPA     ENCL30          ; Go back to look at next char
                                                              ; End of token
86F1 38 96 81                                         ENCL40: JPS     _PUSH2          ; Push result n2 (ending delimiter)
86F4 26 F6 FE                                                 INB     R2.0            ; Also push n3 ...
86F7 38 96 81                                                 JPS     _PUSH2          ; : ... (index to first non-scanned char)
86FA 14 9C 84                                                 JPA     NEXT            ; Done
                                                              ; <NUL> appears before token
86FD 26 F6 FE                                         ENCL50: INB     R2.0            ; Push i + 1
8700 38 96 81                                                 JPS     _PUSH2          ; :
8703 27 F6 FE                                                 DEB     R2.0            ; Push i
8706 38 96 81                                                 JPS     _PUSH2          ; : ... indicating <NUL> before token
8709 14 9C 84                                                 JPA     NEXT            ; Done
                                                              ; Token ends with a <NUL>
870C 38 96 81                                         ENCL60: JPS     _PUSH2          ; Push i twice to indicate ...
870F 38 96 81                                                 JPS     _PUSH2          ; : ... that token ends in a <NUL>
8712 14 9C 84                                                 JPA     NEXT            ; Done
                                                      
8715 84 45 4D 49 D4                                   HEMIT:  DB      ^4 "EMI" ^'T'                           ; ***** EMIT
871A AB 86                                                    DW      HENCL
871C 1E 87                                            EMIT:   DW      EMIT0
871E 38 73 80                                         EMIT0:  JPS     _POP1           ; Get character
8721 15 F2 FE                                                 LDA     R1.0            ; Send char to terminal
8724 02                                                       OUT                     ;
8725 14 9C 84                                                 JPA     NEXT            ; Done
                                                      
8728 83 4B 45 D9                                      HKEY:   DB      ^3 "KE" ^'Y'                            ; ***** KEY
872C 15 87                                                    DW      HEMIT
872E 30 87                                            KEY:    DW      KEY0
8730 0A                                               KEY0:   INP                     ; Get char form terminal
8731 11 FF                                                    CPI     0xFF            ; Did we get a character?
8733 3B 30 87                                                 BEQ     KEY0            ; NO: Try again
8736 16 F2 FE                                                 STA     R1.0            ; YES: Push character
8739 24 F3 FE                                                 CLB     R1.1            ; :
873C 14 8A 84                                                 JPA     PUSH            ; Push R1; NEXT
                                                      
873F 89 3F 54 45 52 4D 49 4E 41 CC                    HQTERM: DB      ^9 "?TERMINA" ^'L'                      ; ***** ?TERMINAL
8749 28 87                                                    DW      HKEY
874B 4D 87                                            QTERM:  DW      QTERM0
874D 2C F2 FE                                         QTERM0: CLW     R1              ; Default FALSE to return
8750 0A                                                       INP                     ; Get char from terminal
8751 11 FF                                                    CPI     0xFF            ; Did we get a character?
8753 3B 59 87                                                 BEQ     QTER10          ; NO: Return FALSE
8756 2F F2 FE                                                 DEW     R1              ; Make default FALSE into TRUE
8759 14 8A 84                                         QTER10: JPA     PUSH            ; Push R1; NEXT
                                                      
875C 82 43 D2                                         HCR:    DB      ^2 "C" ^'R'                             ; ***** CR
875F 3F 87                                                    DW      HQTERM
8761 63 87                                            CR:     DW      CR0
8763 0E 0A                                            CR0:    LDI     CH_LF           ; Output a linefeed ...
8765 02                                                       OUT                     ; ... to the terminal
8766 14 9C 84                                                 JPA     NEXT            ; Done
                                                      
8769 83 52 2F D7                                      HRW:    DB      ^3 "R/" ^'W'                            ; ***** R/W
876D 5C 87                                                    DW      HCR
876F 71 87                                            RW:     DW      RW0
8771 38 F9 80                                         RW0:    JPS     _POP3           ; 1:read 0:write
8774 38 00 81                                                 JPS     _POP21          ; R2:block# R1:addr
8777 14 9C 84                                                 JPA     NEXT
                                                      
877A 85 43 4D 4F 56 C5                                HCMOVE: DB      ^5 "CMOV" ^'E'                          ; ***** CMOVE
8780 69 87                                                    DW      HRW
8782 84 87                                            CMOVE:  DW      CMOVE0
8784 38 F9 80                                         CMOVE0: JPS     _POP3           ; R3 = count
8787 38 00 81                                                 JPS     _POP21          ; R2 = dst, R1 = src
878A 1D F2 FE                                         CMOV10: LDR     R1              ; Get byte from source
878D 1E F6 FE                                                 STR     R2              ; Store to destination
8790 2E F2 FE                                                 INW     R1              ; Bump source pointer
8793 2E F6 FE                                                 INW     R2              ; Bump destination pointer
8796 2F FA FE                                                 DEW     R3              ; Decrement count
8799 3B 9F 87                                                 BEQ     CMOV20          ; Count zero: We are done
879C 14 8A 87                                                 JPA     CMOV10          ; Count non-zero: Next byte
879F 14 9C 84                                         CMOV20: JPA     NEXT            ; Done
                                                      
87A2 82 55 AA                                         HUSTAR: DB      ^2 "U" ^'*'                             ; ***** U*
87A5 7A 87                                                    DW      HCMOVE
87A7 A9 87                                            USTAR:  DW      USTAR0
87A9 38 00 81                                         USTAR0: JPS     _POP21          ; R2 = oper2, R1 = oper1
87AC 38 BC 83                                                 JPS     _UMULT          ; u32 = u16 * u16
87AF 14 D2 84                                                 JPA     DPUSH           ; Done
                                                      
87B2 82 55 AF                                         HUSLAS: DB      ^2 "U" ^'/'                             ; ***** U/
87B5 A2 87                                                    DW      HUSTAR
87B7 B9 87                                            USLAS:  DW      USLAS0
87B9 38 00 81                                         USLAS0: JPS     _POP21          ; R2 = divisor, R1 = dividend-hi
87BC 15 F2 FE                                                 LDA     R1.0            ; Move high part to R1.2 and R1.3
87BF 16 F4 FE                                                 STA     R1.2            ; :
87C2 15 F3 FE                                                 LDA     R1.1            ; :
87C5 16 F5 FE                                                 STA     R1.3            ; :
87C8 38 73 80                                                 JPS     _POP1           ; dividend, low 16b
87CB 38 20 84                                                 JPS     _UDIV           ; u32 / u16 --> quot_u16, rem_u16
87CE 14 78 84                                                 JPA     IPUSH           ; Push R1H; Push R1L; NEXT
                                                      
87D1 83 41 4E C4                                      HAND:   DB      ^3 "AN" ^'D'                            ; ***** AND
87D5 B2 87                                                    DW      HUSLAS
87D7 D9 87                                            AND:    DW      AND0
87D9 38 00 81                                         AND0:   JPS     _POP21          ; R2 = oper2, R1 = oper1
87DC 38 95 83                                                 JPS     _AND16          ; R1 = R1 & R2
87DF 14 8A 84                                                 JPA     PUSH            ; Done
                                                      
87E2 82 4F D2                                         HOR:    DB      ^2 "O" ^'R'                             ; ***** OR
87E5 D1 87                                                    DW      HAND
87E7 E9 87                                            OR:     DW      OR0
87E9 38 00 81                                         OR0:    JPS     _POP21          ; R2 = oper2, R1 = oper1
87EC 38 A2 83                                                 JPS     _OR16           ; R1 = R1 | R2
87EF 14 8A 84                                                 JPA     PUSH            ; Done
                                                      
87F2 83 58 4F D2                                      HXOR:   DB      ^3 "XO" ^'R'                            ; ***** XOR
87F6 E2 87                                                    DW      HOR
87F8 FA 87                                            XOR:    DW      XOR0
87FA 38 00 81                                         XOR0:   JPS     _POP21          ; R2 = oper2, R1 = oper1
87FD 38 AF 83                                                 JPS     _XOR16          ; R1 = R1 ^ R2
8800 14 8A 84                                                 JPA     PUSH            ; Done
                                                      
8803 83 53 50 C0                                      HSPAT:  DB      ^3 "SP" ^'@'                            ; ***** SP@
8807 F2 87                                                    DW      HXOR
8809 0B 88                                            SPAT:   DW      SPAT0
880B 15 EC FE                                         SPAT0:  LDA     SP.0            ; Get stack pointer
880E 16 F2 FE                                                 STA     R1.0            ; : into R1
8811 15 ED FE                                                 LDA     SP.1            ; :
8814 16 F3 FE                                                 STA     R1.1            ; :
8817 14 8A 84                                                 JPA     PUSH            ; Push R1; NEXT
                                                      
881A 83 53 50 A1                                      HSPSTO: DB      ^3 "SP" ^'!'                            ; ***** SP!
881E 03 88                                                    DW      HSPAT
8820 22 88                                            SPSTO:  DW      SPSTO0
8822 0E 06                                            SPSTO0: LDI     6               ; Index of SP0
8824 16 F6 FE                                                 STA     R2.0            ; : in USER table
8827 38 5D 83                                                 JPS     _USER           ; R1 = &USER[R2]
882A 38 2B 83                                                 JPS     _AT             ; R1 = (R1)
882D 15 F2 FE                                                 LDA     R1.0            ; SP = R1
8830 16 EC FE                                                 STA     SP.0            ; :
8833 15 F3 FE                                                 LDA     R1.1            ; :
8836 16 ED FE                                                 STA     SP.1            ; :
8839 14 9C 84                                                 JPA     NEXT            ; Done
                                                      
883C 83 52 50 A1                                      HRPSTO: DB      ^3 "RP" ^'!'                            ; ***** RP!
8840 1A 88                                                    DW      HSPSTO
8842 44 88                                            RPSTO:  DW      RPSTO0
8844 0E 18                                            RPSTO0: LDI     24              ; Index of SP0
8846 16 F6 FE                                                 STA     R2.0            ; : in boot table
8849 38 4C 83                                                 JPS     _PORIG          ; R1 = &bootTable[R2]
884C 38 2B 83                                                 JPS     _AT             ; R1 = XRP
884F 15 F2 FE                                                 LDA     R1.0            ; SP = R1
8852 16 EE FE                                                 STA     RP.0            ; :
8855 15 F3 FE                                                 LDA     R1.1            ; :
8858 16 EF FE                                                 STA     RP.1            ; :
885B 14 9C 84                                                 JPA     NEXT            ; Done
                                                      
885E 83 55 50 A1                                      HUPSTO: DB      ^3 "UP" ^'!'                            ; ***** UP!
8862 3C 88                                                    DW      HRPSTO
8864 66 88                                            UPSTO:  DW      UPSTO0
8866 0E 10                                            UPSTO0: LDI     16              ; Index of UP0
8868 16 F6 FE                                                 STA     R2.0            ; : in boot table
886B 38 4C 83                                                 JPS     _PORIG          ; R1 = &bootTable[R2]
886E 38 2B 83                                                 JPS     _AT             ; R1 = XUP
8871 15 F2 FE                                                 LDA     R1.0            ; UP = R1
8874 16 F0 FE                                                 STA     UP.0            ; :
8877 15 F3 FE                                                 LDA     R1.1            ; :
887A 16 F1 FE                                                 STA     UP.1            ; :
887D 14 9C 84                                                 JPA     NEXT            ; Done
                                                      
8880 82 3B D3                                         HSEMIS: DB      ^2 ";" ^'S'                             ; ***** ;S
8883 3C 88                                                    DW      HRPSTO
8885 87 88                                            SEMIS:  DW      SEMIS0
8887 1D EE FE                                         SEMIS0: LDR     RP              ; IP = (RP)+
888A 16 E8 FE                                                 STA     IP.0            ; :
888D 2E EE FE                                                 INW     RP              ; :
8890 1D EE FE                                                 LDR     RP              ; :
8893 16 E9 FE                                                 STA     IP.1            ; :
8896 2E EE FE                                                 INW     RP              ; :
8899 14 9C 84                                                 JPA     NEXT            ; Done
                                                      
889C 85 4C 45 41 56 C5                                HLEAVE: DB      ^5 "LEAV" ^'E'                          ; ***** LEAVE
88A2 80 88                                                    DW      HSEMIS
88A4 A6 88                                            LEAVE:  DW      LEAVE0
88A6 38 1E 81                                         LEAVE0: JPS     _RPOP1          ; 2(RP) = (RP)
88A9 38 CB 81                                                 JPS     _RPUT1          ; :
88AC 38 D2 81                                                 JPS     _RPUSH1         ; :
88AF 14 9C 84                                                 JPA     NEXT
                                                      
88B2 82 3E D2                                         HTOR:   DB      ^2 ">" ^'R'                             ; ***** >R
88B5 9C 88                                                    DW      HLEAVE
88B7 B9 88                                            TOR:    DW      TOR0
88B9 38 73 80                                         TOR0:   JPS     _POP1           ; -(RP) = (SP)+
88BC 38 D2 81                                                 JPS     _RPUSH1         ; :
88BF 14 9C 84                                                 JPA     NEXT
                                                      
88C2 82 52 BE                                         HFROMR: DB      ^2 "R" ^'>'                             ; ***** R>
88C5 B2 88                                                    DW      HTOR
88C7 C9 88                                            FROMR:  DW      FROMR0
88C9 38 1E 81                                         FROMR0: JPS     _RPOP1          ; -(SP) = (RP)+
88CC 14 8A 84                                                 JPA     PUSH            ; :
                                                      
88CF 81 D2                                            HR:     DB      ^1 ^'R'                                 ; ***** R
88D1 C2 88                                                    DW      HFROMR
88D3 D5 88                                            R:      DW      R0
88D5 38 17 81                                         R0:     JPS     _RGET1          ; -(SP) = (RP)
88D8 14 8A 84                                                 JPA     PUSH            ; :
                                                      
88DB 82 30 BD                                         HZEQU:  DB      ^2 "0" ^'='                             ; ***** 0=
88DE CF 88                                                    DW      HR
88E0 E2 88                                            ZEQU:   DW      ZEQU0
88E2 1D EC FE                                         ZEQU0:  LDR     SP              ; Get low byte
88E5 11 00                                                    CPI     0               ; Is it zero?
88E7 3A FB 88                                                 BNE     ZEQU10          ; NO: Return FALSE
88EA 2E EC FE                                                 INW     SP              ; YES: Have to inspect
88ED 1D EC FE                                                 LDR     SP              ; : high byte as well
88F0 11 00                                                    CPI     0               ; Is it zero?
88F2 3A FE 88                                                 BNE     ZEQU20          ; NO: Return FALSE
88F5 2E EC FE                                                 INW     SP              ; Make POP complete
88F8 14 C3 84                                                 JPA     PUSHT           ; YES: Return TRUE
88FB 2E EC FE                                         ZEQU10: INW     SP              ; POP argument off dstack
88FE 2E EC FE                                         ZEQU20: INW     SP              ; : Make POP complete
8901 14 CC 84                                                 JPA     PUSHF           ; Return FALSE
                                                      
8904 82 30 BC                                         HZLESS: DB      ^2 "0" ^'<'                             ; ***** 0<
8907 DB 88                                                    DW      HZEQU
8909 0B 89                                            ZLESS:  DW      ZLESS0
890B 2E EC FE                                         ZLESS0: INW     SP              ; Inspect high byte only
890E 1D EC FE                                                 LDR     SP              ; Get high byte
8911 11 00                                                    CPI     0               ; Is high byte negative?
8913 3F 1C 89                                                 BMI     ZLES10          ; YES: Return TRUE
8916 2E EC FE                                                 INW     SP              ; NO: POP high byte also
8919 14 CC 84                                                 JPA     PUSHF           ; Return FALSE
891C 2E EC FE                                         ZLES10: INW     SP              ; POP high byte also
891F 14 C3 84                                                 JPA     PUSHT           ; Return TRUE
                                                      
8922 81 AB                                            HPLUS:  DB      ^1 ^'+'                                 ; ***** +
8924 04 89                                                    DW      HZLESS
8926 28 89                                            PLUS:   DW      PLUS0
8928 38 00 81                                         PLUS0:  JPS     _POP21          ; R2 = oper2, R1 = oper1
892B 38 15 82                                                 JPS     _ADD16          ; R1 = R1 + R2
892E 14 8A 84                                                 JPA     PUSH            ; -(SP) = R1; NEXT
                                                      
8931 82 44 AB                                         HDPLUS: DB      ^2 "D" ^'+'                             ; ***** D+
8934 22 89                                                    DW      HPLUS
8936 38 89                                            DPLUS:  DW      DPLUS0
8938 38 BD 80                                         DPLUS0: JPS     _DPOP2          ; Get second operand
893B 38 7A 80                                                 JPS     _DPOP1          ; Get first operand
893E 38 22 82                                                 JPS     _ADD32          ; R1X = R1X + R2X
8941 14 D2 84                                                 JPA     DPUSH           ; -(SP) = R1X; NEXT
                                                      
8944 85 4D 49 4E 55 D3                                HMINUS: DB      ^5 "MINU" ^'S'                          ; ***** MINUS
894A 31 89                                                    DW      HDPLUS
894C 4E 89                                            MINUS:  DW      MINUS0
894E 38 73 80                                         MINUS0: JPS     _POP1           ; Get operand
8951 38 F7 82                                                 JPS     _NEG16          ; Negate
8954 14 8A 84                                                 JPA     PUSH
                                                      
8957 86 44 4D 49 4E 55 D3                             HDMINU: DB      ^6 "DMINU" ^'S'                         ; ***** DMINUS
895E 44 89                                                    DW      HMINUS
8960 62 89                                            DMINU:  DW      DMINU0
8962 38 7A 80                                         DMINU0: JPS     _DPOP1          ; Get operand
8965 38 05 83                                                 JPS     _NEG32          ; Negate
8968 14 D2 84                                                 JPA     DPUSH
                                                      
896B 84 4F 56 45 D2                                   HOVER:  DB      ^4 "OVE" ^'R'                           ; **** OVER
8970 57 89                                                    DW      HDMINU
8972 74 89                                            OVER:   DW      OVER0
8974 38 B6 80                                         OVER0:  JPS     _POP2           ; n1 n2 -- n1 n2 n1
8977 38 6C 80                                                 JPS     _GET1           ; :
897A 38 96 81                                                 JPS     _PUSH2          ; :
897D 14 8A 84                                                 JPA     PUSH            ; :
                                                      
8980 84 44 52 4F D0                                   HDROP:  DB      ^4 "DRO" ^'P'                           ; **** DROP
8985 6B 89                                                    DW      HOVER
8987 89 89                                            DROP:   DW      DROP0
8989 2E EC FE                                         DROP0:  INW     SP              ; n1 --
898C 2E EC FE                                                 INW     SP              ; :
898F 14 9C 84                                                 JPA     NEXT            ; Done
                                                      
8992 84 53 57 41 D0                                   HSWAP:  DB      ^4 "SWA" ^'P'                           ; **** SWAP
8997 80 89                                                    DW      HDROP
8999 74 89                                            SWAP:   DW      OVER0
899B 38 00 81                                         SWAP0:  JPS     _POP21          ; n1 n2 -- n2 n1
899E 38 96 81                                                 JPS     _PUSH2          ; :
89A1 14 8A 84                                                 JPA     PUSH            ; :
                                                      
89A4 83 44 55 D0                                      HDUP:   DB      ^3 "DU" ^'P'                            ; **** DUP
89A8 92 89                                                    DW      HSWAP
89AA AC 89                                            DUP:    DW      DUP0
89AC 38 6C 80                                         DUP0:   JPS     _GET1           ; n1 -- n1 n1
89AF 14 8A 84                                                 JPA     PUSH            ; :
                                                      
89B2 82 2B A1                                         HPSTOR: DB      ^2 "+" ^'!'                             ; ***** +!
89B5 A4 89                                                    DW      HDUP
89B7 B8                                               PSTOR:  DB      PSTOR0
89B8 38 F9 80                                         PSTOR0: JPS     _POP3           ; R3 = addr
89BB 38 B6 80                                                 JPS     _POP2           ; R2 = incr
89BE 38 3B 82                                                 JPS     _LD16           ; R1 = (R3)
89C1 38 15 82                                                 JPS     _ADD16          ; R1 = R1 + R2
89C4 38 4E 82                                                 JPS     _ST16           ; (R3) = R1
89C7 14 9C 84                                                 JPA     NEXT            ; Done
                                                      
89CA 86 54 4F 47 47 4C C5                             HTOGGL: DB      ^6 "TOGGL" ^'E'                         ; ***** TOGGLE
89D1 B2 89                                                    DW      HPSTOR
89D3 D5 89                                            TOGGL:  DW      TOGGL0
89D5 38 B6 80                                         TOGGL0: JPS     _POP2           ; R2 = bit mask
89D8 38 F9 80                                                 JPS     _POP3           ; R3 = addr
89DB 38 3B 82                                                 JPS     _LD16           ; R1 = (R3)
89DE 38 AF 83                                                 JPS     _XOR16          ; R1 = R1 ^ R2
89E1 38 4E 82                                                 JPS     _ST16           ; (R3) = R1
89E4 14 9C 84                                                 JPA     NEXT            ; Done
                                                      
89E7 81 C0                                            HAT:    DB      ^1 ^'@'                                 ; ***** @
89E9 CA 89                                                    DW      HTOGGL
89EB ED 89                                            AT:     DW      AT0
89ED 38 F9 80                                         AT0:    JPS     _POP3           ; R3 = addr
89F0 38 3B 82                                                 JPS     _LD16           ; R1 = (R3)
89F3 14 8A 84                                                 JPA     PUSH            ; -(SP) = R1; NEXT
                                                      
89F6 82 43 C0                                         HCAT:   DB      ^2 "C" ^'@'                             ; ***** C@
89F9 E7 89                                                    DW      HAT
89FB FD 89                                            CAT:    DW      CAT0
89FD 2C F2 FE                                         CAT0:   CLW     R1              ; R1 = 0
8A00 38 F9 80                                                 JPS     _POP3           ; R3 = addr
8A03 1D FA FE                                                 LDR     R3              ; A = (R3)
8A06 16 F2 FE                                                 STA     R1.0            ; R1 = A
8A09 14 8A 84                                                 JPA     PUSH            ; -(SP) = R1; NEXT
                                                      
8A0C 81 A1                                            HSTORE: DB      ^1 ^'!'                                 ; ***** !
8A0E F6 89                                                    DW      HCAT
8A10 12 8A                                            STORE:  DW      STORE0
8A12 38 F9 80                                         STORE0: JPS     _POP3           ; R3 = addr
8A15 38 73 80                                                 JPS     _POP1           ; R1 = data
8A18 38 4E 82                                                 JPS     _ST16           ; (R3) = R1
8A1B 14 9C 84                                                 JPA     NEXT            ; Done
                                                      
8A1E 82 43 A1                                         HCSTOR: DB      ^2 "C" ^'!'                             ; ***** C!
8A21 0C 8A                                                    DW      HSTORE
8A23 25 8A                                            CSTOR:  DW      CSTOR0
8A25 38 F9 80                                         CSTOR0: JPS     _POP3           ; R3 = addr
8A28 38 73 80                                                 JPS     _POP1           ; R1 = data
8A2B 15 F2 FE                                                 LDA     R1.0            ; A = R1.0
8A2E 1E FA FE                                                 STR     R3              ; (R3) = A
8A31 14 9C 84                                                 JPA     NEXT            ; Done
                                                      
                                                      ; INCLUDE         precompiled.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; PRECOMPILED FORTH WORDS
                                                      ;
                                                      
8A34 C1 BA                                            HCOLON: DB      ^^1 ^':'                                ; ***** :
8A36 1E 8A                                                    DW      HCSTOR
8A38 4C 8A EC 8D A7 8D 0F 8C EB 89 01 8C 10 8A        COLON:  DW      DOCOL QEXEC SCSP CURR AT CONT STORE
8A46 10 93 71 8E D8 8E                                        DW      CREAT RBRAC PSCOD
8A4C 2F EE FE                                         DOCOL:  DEW     RP              ; -(RP) = IP
8A4F 15 E9 FE                                                 LDA     IP.1            ; :
8A52 1E EE FE                                                 STR     RP              ; :
8A55 2F EE FE                                                 DEW     RP              ; :
8A58 15 E8 FE                                                 LDA     IP.0            ; :
8A5B 1E EE FE                                                 STR     RP              ; :
8A5E 15 EA FE                                                 LDA     WA.0            ; IP = WA
8A61 16 E8 FE                                                 STA     IP.0            ; :
8A64 15 EB FE                                                 LDA     WA.1            ; :
8A67 16 E9 FE                                                 STA     IP.1            ; :
8A6A 14 9C 84                                                 JPA     NEXT
                                                      
8A6D C1 BB                                            HSEMI:  DB      ^^1 ^';'                                ; ***** ;
8A6F 34 8A                                                    DW      HCOLON
8A71 16 8E 4D 8E 85 88 86 8E 63 8E 85 88              SEMI:   DW      QCSP COMP SEMIS SMUDG LBRAC SEMIS
                                                      
8A7D 88 43 4F 4E 53 54 41 4E D4                       HCON:   DB      ^8 "CONSTAN" ^'T'                       ; ***** CONSTANT
8A86 6D 8A                                                    DW      HSEMI
8A88 4C 8A 10 93 86 8E AD 8C D8 8E                    CON:    DW      DOCOL CREAT SMUDG COMMA PSCOD
8A92 1D EA FE                                         DOCON:  LDR     WA              ; -(SP) = (WA)
8A95 16 F2 FE                                                 STA     R1.0            ; :
8A98 2E EA FE                                                 INW     WA              ; :
8A9B 1D EA FE                                                 LDR     WA              ; :
8A9E 16 F3 FE                                                 STA     R1.1            ; :
8AA1 2F EA FE                                                 DEW     WA              ; :
8AA4 14 8A 84                                                 JPA     PUSH            ; Done
                                                      
8AA7 88 56 41 52 49 41 42 4C C5                       HVAR:   DB      ^8 "VARIABL" ^'E'                       ; ***** VARIABLE
8AB0 7D 8A                                                    DW      HCON
8AB2 4C 8A 88 8A D8 8E                                VAR:    DW      DOCOL CON PSCOD
8AB8 2F EC FE                                         DOVAR:  DEW     SP              ; -(SP) = WA
8ABB 15 EB FE                                                 LDA     WA.1            ; :
8ABE 1E EC FE                                                 STR     SP              ; :
8AC1 2F EC FE                                                 DEW     SP              ; :
8AC4 15 EA FE                                                 LDA     WA.0            ; :
8AC7 1E EC FE                                                 STR     SP              ; :
8ACA 14 9C 84                                                 JPA     NEXT            ; Done
                                                      
8ACD 84 55 53 45 D2                                   HUSER:  DB      ^4 "USE" ^'R'                           ; ***** USER
8AD2 A7 8A                                                    DW      HVAR
8AD4 4C 8A 88 8A D8 8E                                USER:   DW      DOCOL CON PSCOD
8ADA 38 73 80                                         DOUSE:  JPS     _POP1           ; Get index
8ADD 15 F2 FE                                                 LDA     R1.0            ; Compute UP[index]
8AE0 17 F0 FE                                                 ADA     UP.0            ; :
8AE3 16 F2 FE                                                 STA     R1.0            ; :
8AE6 15 F3 FE                                                 LDA     R1.1            ; :
8AE9 1A F1 FE                                                 ACA     UP.1            ; :
8AEC 16 F3 FE                                                 STA     R1.1            ; :
8AEF 14 8A 84                                                 JPA     PUSH            ; Push address; NEXT
                                                      
                                                      ; ------------------------------
                                                      ; PRECOMPILED CONSTANTS
                                                      
8AF2 81 B0                                            HZERO:  DB      ^1 ^'0'                                 ; ***** 0
8AF4 CD 8A                                                    DW      HUSER
8AF6 92 8A 00 00                                      ZERO:   DW      DOCON 0
                                                      
8AFA 81 B1                                            HONE:   DB      ^1 ^'1'                                 ; ***** 1
8AFC F2 8A                                                    DW      HZERO
8AFE 92 8A 01 00                                      ONE:    DW      DOCON 1
                                                      
8B02 81 B2                                            HTWO:   DB      ^1 ^'2'                                 ; ***** 2
8B04 FA 8A                                                    DW      HONE
8B06 92 8A 02 00                                      TWO:    DW      DOCON 2
                                                      
8B0A 81 B3                                            HTHREE: DB      ^1 ^'3'                                 ; ***** 3
8B0C 02 8B                                                    DW      HTWO
8B0E 92 8A 03 00                                      THREE:  DW      DOCON 3
                                                      
8B12 82 42 CC                                         HBL:    DB      ^2 "B" ^'L'                             ; ***** BL
8B15 0A 8B                                                    DW      HTHREE
8B17 92 8A 20 00                                      BL:     DW      DOCON 32
                                                      
8B1B 83 43 2F CC                                      HCL:    DB      ^3 "C/" ^'L'                            ; ***** C/L
8B1F 12 8B                                                    DW      HBL
8B21 92 8A 50 00                                      CL:     DW      DOCON 80
                                                      
8B25 85 42 2F 42 55 C6                                HBBUF:  DB      ^5 "B/BU" ^'F'                          ; ***** B/BUF
8B2B 1B 8B                                                    DW      HCL
8B2D 92 8A 00 04                                      BBUF:   DW      DOCON 1024
                                                      
8B31 85 42 2F 53 43 D2                                HBSCR:  DB      ^5 "B/SC" ^'R'                          ; ***** B/SCR
8B37 25 8B                                                    DW      HBBUF
8B39 92 8A 01 00                                      BSCR:   DW      DOCON 1
                                                      
8B3D 87 2B 4F 52 49 47 49 CE                          HPORIG: DB      ^7 "+ORIGI" ^'N'                        ; ***** +ORIGIN
8B45 31 8B                                                    DW      HBSCR
8B47 4C 8A FF 84 00 80 26 89 85 88                    PORIG:  DW      DOCOL LIT ORIGIN PLUS SEMIS
                                                      
                                                      ; ------------------------------
                                                      ; USER VARIABLES
                                                      
8B51 82 53 B0                                         HSZERO: DB      ^2 "S" ^'0'                             ; ***** S0
8B54 3D 8B                                                    DW      HPORIG
8B56 DA 8A 06 00                                      SZERO:  DW      DOUSE 6
                                                      
8B5A 82 52 B0                                         HRZERO: DB      ^2 "R" ^'0'                             ; ***** R0
8B5D 51 8B                                                    DW      HSZERO
8B5F DA 8A 08 00                                      RZERO:  DW      DOUSE 8
                                                      
8B63 83 54 49 C2                                      HTIB:   DB      ^3 "TI" ^'B'                            ; ***** TIB
8B67 5A 8B                                                    DW      HRZERO
8B69 DA 8A 0A 00                                      TIB:    DW      DOUSE 10
                                                      
8B6D 85 57 49 44 54 C8                                HWIDTH: DB      ^5 "WIDT" ^'H'                          ; ***** WIDTH
8B73 63 8B                                                    DW      HTIB
8B75 DA 8A 0C 00                                      WIDTH:  DW      DOUSE 12
                                                      
8B79 87 57 41 52 4E 49 4E C7                          HWARN:  DB      ^7 "WARNIN" ^'G'                        ; ***** WARNING
8B81 6D 8B                                                    DW      HWIDTH
8B83 DA 8A 0E 00                                      WARN:   DW      DOUSE 14
                                                      
8B87 85 46 45 4E 43 C5                                HFENCE: DB      ^5 "FENC" ^'E'                          ; ***** FENCE
8B8D 79 8B                                                    DW      HWARN
8B8F DA 8A 10 00                                      FENCE:  DW      DOUSE 16
                                                      
8B93 82 44 D0                                         HDP:    DB      ^2 "D" ^'P'                             ; ***** DP
8B96 87 8B                                                    DW      HFENCE
8B98 DA 8A 12 00                                      DP:     DW      DOUSE 18
                                                      
8B9C 88 56 4F 43 2D 4C 49 4E CB                       HVOCL:  DB      ^8 "VOC-LIN" ^'K'                       ; ***** VOC-LINK
8BA5 93 8B                                                    DW      HDP
8BA7 DA 8A 14 00                                      VOCL:   DW      DOUSE 20
                                                      
8BAB 85 46 49 52 53 D4                                HFIRST: DB      ^5 "FIRS" ^'T'                          ; ***** FIRST
8BB1 9C 8B                                                    DW      HVOCL
8BB3 DA 8A 16 00                                      FIRST:  DW      DOUSE 22
                                                      
8BB7 85 4C 49 4D 49 D4                                HLIMIT: DB      ^5 "LIMI" ^'T'                          ; ***** LIMIT
8BBD AB 8B                                                    DW      HFIRST
8BBF DA 8A 18 00                                      LIMIT:  DW      DOUSE 24
                                                      
8BC3 83 42 4C CB                                      HBLK:   DB      ^3 "BL" ^'K'                            ; ***** BLK
8BC7 B7 8B                                                    DW      HLIMIT
8BC9 DA 8A 1E 00                                      BLK:    DW      DOUSE 30
                                                      
8BCD 82 49 C9                                         HIN:    DB      ^2 "I" ^'I'                             ; ***** IN
8BD0 C3 8B                                                    DW      HBLK
8BD2 DA 8A 20 00                                      IN:     DW      DOUSE 32
                                                      
8BD6 83 4F 55 D4                                      HOUT:   DB      ^3 "OU" ^'T'                            ; ***** OUT
8BDA CD 8B                                                    DW      HIN
8BDC DA 8A 22 00                                      OUT:    DW      DOUSE 34
                                                      
8BE0 83 53 43 D2                                      HSCR:   DB      ^3 "SC" ^'R'                            ; ***** SCR
8BE4 D6 8B                                                    DW      HOUT
8BE6 DA 8A 24 00                                      SCR:    DW      DOUSE 36
                                                      
8BEA 86 4F 46 46 53 45 D4                             HOFFSE: DB      ^6 "OFFSE" ^'T'                         ; ***** OFFSET
8BF1 E0 8B                                                    DW      HSCR
8BF3 DA 8A 26 00                                      OFFSE:  DW      DOUSE 38
                                                      
8BF7 87 43 4F 4E 54 45 58 D4                          HCONT:  DB      ^7 "CONTEX" ^'T'                        ; ***** CONTEXT
8BFF EA 8B                                                    DW      HOFFSE
8C01 DA 8A 28 00                                      CONT:   DW      DOUSE 40
                                                      
8C05 87 43 55 52 52 45 4E D4                          HCURR:  DB      ^7 "CURREN" ^'T'                        ; ***** CURRENT
8C0D F7 8B                                                    DW      HCONT
8C0F DA 8A 2A 00                                      CURR:   DW      DOUSE 42
                                                      
8C13 85 53 54 41 54 C5                                HSTATE: DB      ^5 "STAT" ^'E'                          ; ***** STATE
8C19 05 8C                                                    DW      HCURR
8C1B DA 8A 2C 00                                      STATE:  DW      DOUSE 44
                                                      
8C1F 84 42 41 53 C5                                   HBASE:  DB      ^4 "BAS" ^'E'                           ; ***** BASE
8C24 13 8C                                                    DW      HSTATE
8C26 DA 8A 2E 00                                      BASE:   DW      DOUSE 46
                                                      
8C2A 83 44 50 CC                                      HDPL:   DB      ^3 "DP" ^'L'                            ; ***** DPL
8C2E 1F 8C                                                    DW      HBASE
8C30 DA 8A 32 00                                      DPL:    DW      DOUSE 50
                                                      
8C34 83 46 4C C4                                      HFLD:   DB      ^3 "FL" ^'D'                            ; ***** FLD
8C38 2A 8C                                                    DW      HDPL
8C3A DA 8A 34 00                                      FLD:    DW      DOUSE 52
                                                      
8C3E 83 43 53 D0                                      HCSP:   DB      ^3 "CS" ^'P'                            ; ***** CSP
8C42 34 8C                                                    DW      HFLD
8C44 DA 8A 34 00                                      CSP:    DW      DOUSE 52
                                                      
8C48 82 52 A3                                         HRNUM:  DB      ^2 "R" ^'#'                             ; ***** R#
8C4B 3E 8C                                                    DW      HCSP
8C4D DA 8A 36 00                                      RNUM:   DW      DOUSE 54
                                                      
8C51 83 48 4C C4                                      HHLD:   DB      ^3 "HL" ^'D'                            ; ***** HLD
8C55 48 8C                                                    DW      HRNUM
8C57 DA 8A 38 00                                      HLD:    DW      DOUSE 56
                                                      
8C5B 83 55 53 C5                                      HUSE:   DB      ^3 "US" ^'E'                            ; ***** USE
8C5F 51 8C                                                    DW      HHLD
8C61 DA 8A 3A 00                                      USE:    DW      DOUSE 58
                                                      
8C65 84 50 52 45 D6                                   HPREV:  DB      ^4 "PRE" ^'V'                           ; ***** PREV
8C6A 5B 8C                                                    DW      HUSE
8C6C DA 8A 3C 00                                      PREV:   DW      DOUSE 60
                                                      
                                                      ; END OF USER VARIABLES
                                                      ; ------------------------------
                                                      
8C70 82 31 AB                                         HONEP:  DB      ^2 "1" ^'+'                             ; ***** 1+
8C73 65 8C                                                    DW      HPREV
8C75 4C 8A FE 8A 26 89 85 88                          ONEP:   DW      DOCOL ONE PLUS SEMIS
                                                      
8C7D 82 32 AB                                         HTWOP:  DB      ^2 "2" ^'+'                             ; ***** 2+
8C80 65 8C                                                    DW      HPREV
8C82 4C 8A 06 8B 26 89 85 88                          TWOP:   DW      DOCOL TWO PLUS SEMIS
                                                      
8C8A 84 48 45 52 C5                                   HHERE:  DB      ^4 "HER" ^'E'                           ; ***** HERE
8C8F 7D 8C                                                    DW      HTWOP
8C91 4C 8A 98 8B EB 89 85 88                          HERE:   DW      DOCOL DP AT SEMIS
                                                      
8C99 85 41 4C 4C 4F D4                                HALLOT: DB      ^5 "ALLO" ^'T'                          ; ***** ALLOT
8C9F 8A 8C                                                    DW      HHERE
8CA1 4C 8A 98 8B B7 89 85 88                          ALLOT:  DW      DOCOL DP PSTOR SEMIS
                                                      
8CA9 81 AC                                            HCOMMA: DB      ^1 ^','                                 ; ***** ,
8CAB 99 8C                                                    DW      HALLOT
8CAD 4C 8A 91 8C 10 8A 06 8B A1 8C 85 88              COMMA:  DW      DOCOL HERE STORE TWO ALLOT SEMIS
                                                      
8CB9 81 AD                                            HSUB:   DB      ^1 ^'-'                                 ; ***** -
8CBB A9 8C                                                    DW      HCOMMA
8CBD 4C 8A 4C 89 26 89 85 88                          SUB:    DW      DOCOL MINUS PLUS SEMIS
                                                      
8CC5 81 BD                                            HEQUAL: DB      ^1 ^'='                                 ; ***** =
8CC7 B9 8C                                                    DW      HSUB
8CC9 4C 8A BD 8C E0 88 85 88                          EQUAL:  DW      DOCOL SUB ZEQU SEMIS
                                                      
8CD1 81 BC                                            HLESS:  DB      ^1 ^'<'                                 ; ***** <
8CD3 C5 8C                                                    DW      HEQUAL
8CD5 4C 8A BD 8C 09 89 85 88                          LESS:   DW      DOCOL SUB ZLESS SEMIS
                                                      
8CDD 81 BE                                            HGREAT: DB      ^1 ^'>'                                 ; ***** >
8CDF D1 8C                                                    DW      HLESS
8CE1 4C 8A 99 89 D5 8C 85 88                          GREAT:  DW      DOCOL SWAP LESS SEMIS
                                                      
8CE9 83 52 4F D4                                      HROT:   DB      ^3 "RO" ^'T'                            ; ***** ROT
8CED DD 8C                                                    DW      HGREAT
8CEF 4C 8A B7 88 99 89 C7 88 99 89 85 88              ROT:    DW      DOCOL TOR SWAP FROMR SWAP SEMIS
                                                      
8CFB 85 53 50 41 43 C5                                HSPACE: DB      ^5 "SPAC" ^'E'                          ; ***** SPACE
8D01 E9 8C                                                    DW      HROT
8D03 4C 8A 17 8B 1C 87 85 88                          SPACE:  DW      DOCOL BL EMIT SEMIS
                                                      
8D0B 84 2D 44 55 D0                                   HDDUP:  DB      ^4 "-DU" ^'P'                           ; ***** -DUP
8D10 FB 8C                                                    DW      HSPACE
8D12 4C 8A AA 89 43 85 04 00                          DDUP:   DW      DOCOL DUP ZBRAN +DDU10
8D1A AA 89                                                    DW      DUP
8D1C 85 88                                            DDU10:  DW      SEMIS
                                                      
8D1E 88 54 52 41 56 45 52 53 C5                       HTRAV:  DB      ^8 "TRAVERS" ^'E'                       ; ***** TRAVERSE
8D27 0B 8D                                                    DW      HDDUP
8D29 4C 8A 99 89                                      TRAV:   DW      DOCOL SWAP
8D2D 72 89 26 89 FF 84 FF 00                          TRAV10: DW      OVER PLUS LIT 0xFF
8D35 72 89 FB 89 D5 8C 31 85 F0 FF                            DW      OVER CAT LESS BRAN +TRAV10
8D3F 99 89 87 89 85 88                                        DW      SWAP DROP SEMIS
                                                      
8D45 86 4C 41 54 45 53 D4                             HLATES: DB      ^6 "LATES" ^'T'                         ; ***** LATEST
8D4C 1E 8D                                                    DW      HTRAV
8D4E 4C 8A 0F 8C EB 89 EB 89 85 88                    LATES:  DW      DOCOL CURR AT AT SEMIS
                                                      
8D58 83 4C 46 C1                                      HLFA:   DB      ^3 "LF" ^'A'                            ; ***** LFA
8D5C 45 8D                                                    DW      HLATES
8D5E 4C 8A FF 84 04 00 BD 8C 85 88                    LFA:    DW      DOCOL LIT 4 SUB SEMIS
                                                      
8D68 83 43 46 C1                                      HCFA:   DB      ^3 "CF" ^'A'                            ; ***** CFA
8D6C 58 8D                                                    DW      HLFA
8D6E 4C 8A 06 8B BD 8C 85 88                          CFA:    DW      DOCOL TWO SUB SEMIS
                                                      
8D76 83 4E 46 C1                                      HNFA:   DB      ^3 "NF" ^'A'                            ; ***** NFA
8D7A 68 8D                                                    DW      HCFA
8D7C 4C 8A FF 84 05 00 BD 8C FF 84 FF FF 29 8D 85 88  NFA:    DW      DOCOL LIT 5 SUB LIT -1 TRAV SEMIS
                                                      
8D8C 83 50 46 C1                                      HPFA:   DB      ^3 "PF" ^'A'                            ; ***** PFA
8D90 76 8D                                                    DW      HNFA
8D92 4C 8A FE 8A 29 8D FF 84 05 00 26 89 85 88        PFA:    DW      DOCOL ONE TRAV LIT 5 PLUS SEMIS
                                                      
                                                      ; ------------------------------
                                                      ; COMPILE TIME CHECKS
                                                      
8DA0 84 21 43 53 D0                                   HSCSP:  DB      ^4 "!CS" ^'P'                           ; ***** !CSP
8DA5 8C 8D                                                    DW      HPFA
8DA7 4C 8A 09 88 44 8C 10 8A 85 88                    SCSP:   DW      DOCOL SPAT CSP STORE SEMIS
                                                      
8DB1 86 3F 45 52 52 4F D2                             HQERR:  DB      ^6 "?ERRO" ^'R'                         ; ***** ?ERROR
8DB8 A0 8D                                                    DW      HSCSP
8DBA 4C 8A 99 89 43 85 08 00                          QERR:   DW      DOCOL SWAP ZBRAN +QERR10
8DC2 AB 92 31 85 04 00                                        DW      ERROR BRAN +QERR20
8DC8 87 89                                            QERR10: DW      DROP
8DCA 85 88                                            QERR20: DW      SEMIS
                                                      
8DCC 85 3F 43 4F 4D D0                                HQCOMP: DB      ^5 "?COM" ^'P'                          ; ***** ?COMP
8DD2 B1 8D                                                    DW      HQERR
8DD4 4C 8A 1B 8C EB 89 E0 88 FF 84 11 00 BA 8D 85 88  QCOMP:  DW      DOCOL STATE AT ZEQU LIT 17 QERR SEMIS
                                                      
8DE4 85 3F 45 58 45 C3                                HQEXEC: DB      ^5 "?EXE" ^'C'                          ; ***** ?EXEC
8DEA CC 8D                                                    DW      HQCOMP
8DEC 4C 8A 1B 8C EB 89 FF 84 12 00 BA 8D 85 88        QEXEC:  DW      DOCOL STATE AT LIT 18 QERR SEMIS
                                                      
8DFA 86 3F 50 41 49 52 D3                             HQPAIR: DB      ^6 "?PAIR" ^'S'                         ; ***** ?PAIRS
8E01 E4 8D                                                    DW      HQEXEC
8E03 4C 8A BD 8C FF 84 13 00 BA 8D 85 88              QPAIR:  DW      DOCOL SUB LIT 19 QERR SEMIS
                                                      
8E0F 84 3F 43 53 D0                                   HQCSP:  DB      ^4 "?CS" ^'P'                           ; ***** ?CSP
8E14 FA 8D                                                    DW      HQPAIR
8E16 4C 8A 09 88 44 8C EB 89 BD 8C                    QCSP:   DW      DOCOL SPAT CSP AT SUB
8E20 FF 84 14 00 BA 8D 85 88                                  DW      LIT 20 QERR SEMIS
                                                      
8E28 88 3F 4C 4F 41 44 49 4E C7                       HQLOAD: DB      ^8 "?LOADIN" ^'G'                       ; ***** ?LOADING
8E31 0F 8E                                                    DW      HQCSP
8E33 4C 8A C9 8B EB 89 E0 88 FF 84 16 00 BA 8D 85 88  QLOAD:  DW      DOCOL BLK AT ZEQU LIT 22 QERR SEMIS
                                                      
                                                      ; ------------------------------
                                                      ; COMPILER WORDS
                                                      
8E43 87 43 4F 4D 50 49 4C C5                          HCOMP:  DB      ^7 "COMPIL" ^'E'                        ; ***** COMPILE
8E4B 28 8E                                                    DW      HQLOAD
8E4D 4C 8A D4 8D C7 88 AA 89                          COMP:   DW      DOCOL QCOMP FROMR DUP
8E55 82 8C B7 88 EB 89 AD 8C 85 88                            DW      TWOP TOR AT COMMA SEMIS
                                                      
8E5F C1 DB                                            HLBRAC: DB      ^^1 ^'['                                ; ***** [
8E61 43 8E                                                    DW      HCOMP
8E63 4C 8A F6 8A 1B 8C 10 8A 85 88                    LBRAC:  DW      DOCOL ZERO STATE STORE SEMIS
                                                      
8E6D 81 DD                                            HRBRAC: DB      ^1 ^']'                                 ; ***** ]
8E6F 5F 8E                                                    DW      HLBRAC
8E71 4C 8A FF 84 C0 00 1B 8C 10 8A 85 88              RBRAC:  DW      DOCOL LIT 0xC0 STATE STORE SEMIS
                                                      
8E7D 86 53 4D 55 44 47 C5                             HSMUDG: DB      ^6 "SMUDG" ^'E'                         ; ***** SMUDGE
8E84 6D 8E                                                    DW      HRBRAC
8E86 4C 8A 4E 8D FF 84 20 00 D3 89 85 88              SMUDG:  DW      DOCOL LATES LIT 0x20 TOGGL SEMIS
                                                      
8E92 83 48 45 D8                                      HHEX:   DB      ^3 "HE" ^'X'                            ; ***** HEX
8E96 7D 8E                                                    DW      HSMUDG
8E98 4C 8A FF 84 10 00 26 8C 10 8A 85 88              HEX:    DW      DOCOL LIT 16 BASE STORE SEMIS
                                                      
8EA4 87 44 45 43 49 4D 41 CC                          HDEC:   DB      ^7 "DECIMA" ^'L'                        ; ***** DECIMAL
8EAC 92 8E                                                    DW      HHEX
8EAE 4C 8A FF 84 0A 00 26 8C 10 8A 85 88              DEC:    DW      DOCOL LIT 10 BASE STORE SEMIS
                                                      
8EBA 85 4F 43 54 41 CC                                HOCTAL: DB      ^5 "OCTA" ^'L'                          ; ***** OCTAL
8EC0 A4 8E                                                    DW      HDEC
8EC2 4C 8A FF 84 08 00 26 8C 10 8A 85 88              OCTAL:  DW      DOCOL LIT 8 BASE STORE SEMIS
                                                      
8ECE 87 28 3B 43 4F 44 45 A9                          HPSCOD: DB      ^7 "(;CODE" ^')'                        ; ***** (;CODE)
8ED6 BA 8E                                                    DW      HOCTAL
8ED8 4C 8A C7 88 4E 8D 92 8D 6E 8D 10 8A 85 88        PSCOD:  DW      DOCOL FROMR LATES PFA CFA STORE SEMIS
                                                      
8EE6 87 3C 42 55 49 4C 44 D3                          HBUILD: DB      ^7 "<BUILD" ^'S'                        ; ***** <BUILDS
8EEE CE 8E                                                    DW      HPSCOD
8EF0 4C 8A F6 8A 88 8A 85 88                          BUILD:  DW      DOCOL ZERO CON SEMIS
                                                      
8EF8 85 44 4F 45 53 BE                                HDOES:  DB      ^5 "DOES" ^'>'                          ; ***** DOES>
8EFE E6 8E                                                    DW      HBUILD
8F00 4C 8A C7 88 4E 8D 92 8D 10 8A D8 8E              DOES:   DW      DOCOL FROMR LATES PFA STORE PSCOD
8F0C 2F EE FE                                         DODOE:  DEW     RP              ; -(RP) = IP
8F0F 15 E9 FE                                                 LDA     IP.1            ; :
8F12 1E EE FE                                                 STR     RP              ; :
8F15 2F EE FE                                                 DEW     RP              ; :
8F18 15 E8 FE                                                 LDA     IP.0            ; :
8F1B 1E EE FE                                                 STR     RP              ; :
8F1E 1D EA FE                                                 LDR     WA              ; IP = (WA)+
8F21 16 E8 FE                                                 STA     IP.0            ; :
8F24 2E EA FE                                                 INW     WA              ; :
8F27 1D EA FE                                                 LDR     WA              ; :
8F2A 16 E9 FE                                                 STA     IP.1            ; :
8F2D 2E EA FE                                                 INW     WA              ; :
8F30 2F EC FE                                                 DEW     SP              ; -(SP) = WA
8F33 15 EB FE                                                 LDA     WA.1            ; :
8F36 1E EC FE                                                 STR     SP              ; :
8F39 2F EC FE                                                 DEW     SP              ; :
8F3C 15 EA FE                                                 LDA     WA.0            ; :
8F3F 1E EC FE                                                 STR     SP              ; :
8F42 14 9C 84                                                 JPA     NEXT            ; Done
                                                      
                                                      ; ------------------------------
                                                      ; MISC WORDS RELATED TO PRINTING
                                                      
8F45 85 43 4F 55 4E D4                                HCOUNT: DB      ^5 "COUN" ^'T'                          ; ***** COUNT
8F4B F8 8E                                                    DW      HDOES
8F4D 4C 8A AA 89 75 8C 99 89 FB 89 85 88              COUNT:  DW      DOCOL DUP ONEP SWAP CAT SEMIS
                                                      
8F59 84 54 59 50 C5                                   HTYPE:  DB      ^4 "TYP" ^'E'                           ; ***** TYPE
8F5E 45 8F                                                    DW      HCOUNT
8F60 4C 8A 12 8D 43 85 18 00                          TYPE:   DW      DOCOL DDUP ZBRAN +TYPE20
8F68 72 89 26 89 99 89 D9 85                                  DW      OVER PLUS SWAP XDO
8F70 EB 85 FB 89 1C 87 C4 85 F8 FF                    TYPE10: DW      I CAT EMIT XLOOP +TYPE10
8F7A 31 85 04 00                                              DW      BRAN +TYPE30
8F7E 87 89                                            TYPE20: DW      DROP
8F80 85 88                                            TYPE30: DW      SEMIS
                                                      
8F82 89 2D 54 52 41 49 4C 49 4E C7                    HDTRAI: DB      ^9 "-TRAILIN" ^'G'                      ; ***** -TRAILING
8F8C 59 8F                                                    DW      HTYPE
8F8E 4C 8A AA 89 F6 8A D9 85                          DTRAI:  DW      DOCOL DUP ZERO XDO
8F96 72 89 72 89 26 89 FE 8A BD 8C                    DTRA10: DW      OVER OVER PLUS ONE SUB
8FA0 FB 89 17 8B BD 8C 43 85 08 00                            DW      CAT BL SUB ZBRAN +DTRA20
8FAA A4 88 31 85 06 00                                        DW      LEAVE BRAN +DTRA30
8FB0 FE 8A BD 8C                                      DTRA20: DW      ONE SUB
8FB4 C4 85 E0 FF                                      DTRA30: DW      XLOOP +DTRA10
8FB8 85 88                                                    DW      SEMIS
                                                      
8FBA 84 28 2E 22 A9                                   HPDOTQ: DB      ^4 "(." '"' ^')'                        ; ***** (.")
8FBF 82 8F                                                    DW      HDTRAI
8FC1 4C 8A D3 88 4D 8F AA 89 75 8C                    PDOTQ:  DW      DOCOL R COUNT DUP ONEP
8FCB C7 88 26 89 B7 88 60 8F 85 88                            DW      FROMR PLUS TOR TYPE SEMIS
                                                      
8FD5 C2 2E A2                                         HDOTQ:  DB      ^^2 "." ^'"'                            ; ***** ."
8FD8 BA 8F                                                    DW      HPDOTQ
8FDA 4C 8A FF 84 22 00 1B 8C EB 89 43 85 14 00        DOTQ:   DW      DOCOL LIT '"' STATE AT ZBRAN +DOTQ10
8FE8 4D 8E C1 8F 3D 91 91 8C FB 89 75 8C                      DW      COMP PDOTQ WORD HERE CAT ONEP
8FF4 A1 8C 31 85 0A 00                                        DW      ALLOT BRAN +DOTQ20
8FFA 3D 91 91 8C 4D 8F 60 8F                          DOTQ10: DW      WORD HERE COUNT TYPE
9002 85 88                                            DOTQ20: DW      SEMIS
                                                      
                                                      ; ------------------------------
                                                      ; OUTER INTERPRETER
                                                      
9004 86 45 58 50 45 43 D4                             HEXPEC: DB      ^6 "EXPEC" ^'T'                         ; ***** EXPECT
900B D5 8F                                                    DW      HDOTQ
900D 4C 8A 72 89 26 89 72 89 D9 85                    EXPEC:  DW      DOCOL OVER PLUS OVER XDO
9017 2E 87 AA 89 FF 84 0E 00 47 8B                    EXPE10: DW      KEY DUP LIT 14 PORIG
9021 EB 89 C9 8C 43 85 20 00                                  DW      AT EQUAL ZBRAN +EXPE20
9029 87 89 FF 84 08 00 72 89 EB 85 C9 8C AA 89 C7 88          DW      DROP LIT 8 OVER I EQUAL DUP FROMR
9039 06 8B BD 8C 26 89 B7 88 BD 8C 31 85 28 00                DW      TWO SUB PLUS TOR SUB BRAN +EXPE50
9047 AA 89 FF 84 0D 00 C9 8C 43 85 0E 00              EXPE20: DW      DUP LIT 13 EQUAL ZBRAN +EXPE30
9053 A4 88 87 89 17 8B F6 8A 31 85 04 00                      DW      LEAVE DROP BL ZERO BRAN +EXPE40
905F AA 89                                            EXPE30: DW      DUP
9061 EB 85 23 8A F6 8A EB 85 75 8C 10 8A              EXPE40: DW      I CSTOR ZERO I ONEP STORE
906D 1C 87 C4 85 A6 FF                                EXPE50: DW      EMIT XLOOP +EXPE10
9073 87 89 85 88                                              DW      DROP SEMIS
                                                      
9077 86 51 55 45 52 D9                                HQUERY: DB      ^6 "QUER" ^'Y'                          ; ***** QUERY
907D 04 90                                                    DW      HEXPEC
907F 4C 8A 69 8B EB 89 FF 84 50 00 0D 90              QUERY:  DW      DOCOL TIB AT LIT 80 EXPEC
908B F6 8A D2 8B 10 8A 85 88                                  DW      ZERO IN STORE SEMIS
                                                      
9093 C1 80                                            HNULL:  DB      ^^1 ^0                                  ; ***** <the NULL word>
9095 77 90                                                    DW      HQUERY
9097 4C 8A C9 8B EB 89 43 85 26 00                    NULL:   DW      DOCOL BLK AT ZBRAN +NULL20
90A1 FE 8A C9 8B B7 89 F6 8A D2 8B 10 8A                      DW      ONE BLK PSTOR ZERO IN STORE
90AD C9 8B EB 89 39 8B A2 96 E0 88 43 85 08 00                DW      BLK AT BSCR MOD ZEQU ZBRAN +NULL10
90BB EC 8D C7 88 87 89                                        DW      QEXEC FROMR DROP
90C1 31 85 06 00                                      NULL10: DW      BRAN +NULL30
90C5 C7 88 87 89                                      NULL20: DW      FROMR DROP
90C9 85 88                                            NULL30: DW      SEMIS
                                                      
90CB 84 46 49 4C CC                                   HFILL:  DB      ^4 "FIL" ^'L'                           ; ***** FILL
90D0 93 90                                                    DW      HNULL
90D2 4C 8A 99 89 B7 88 72 89 23 8A AA 89              FILL:   DW      DOCOL SWAP TOR OVER CSTOR DUP
90DE 75 8C C7 88 FE 8A BD 8C 82 87 85 88                      DW      ONEP FROMR ONE SUB CMOVE SEMIS
                                                      
90EA 85 45 52 41 53 C5                                HERASE: DB      ^5 "ERAS" ^'E'                          ; ***** ERASE
90F0 CB 90                                                    DW      HFILL
90F2 4C 8A F6 8A D2 90 85 88                          ERASE:  DW      DOCOL ZERO FILL SEMIS
                                                      
90FA 86 42 4C 41 4E 4B D3                             HBLANK: DB      ^6 "BLANK" ^'S'                         ; ***** BLANKS
9101 EA 90                                                    DW      HERASE
9103 4C 8A 17 8B D2 90 85 88                          BLANK:  DW      DOCOL BL FILL SEMIS
                                                      
910B 84 48 4F 4C C4                                   HHOLD:  DB      ^4 "HOL" ^'D'                           ; ***** HOLD
9110 FA 90                                                    DW      HBLANK
9112 4C 8A FF 84 FF FF 57 8C B7 89                    HOLD:   DW      DOCOL LIT -1 HLD PSTOR
911C 57 8C EB 89 23 8A 85 88                                  DW      HLD AT CSTOR SEMIS
                                                      
9124 83 50 41 C4                                      HPAD:   DB      ^3 "PA" ^'D'                            ; ***** PAD
9128 0B 91                                                    DW      HHOLD
912A 4C 8A 91 8C FF 84 54 00 26 89 85 88              PAD:    DW      DOCOL HERE LIT 84 PLUS SEMIS
                                                      
9136 84 57 4F 52 C4                                   HWORD:  DB      ^4 "WOR" ^'D'                           ; ***** WORD
913B 24 91                                                    DW      HPAD
913D 4C 8A C9 8B EB 89 43 85 0C 00                    WORD:   DW      DOCOL BLK AT ZBRAN +WORD10
9147 C9 8B EB 89 EA 97 31 85 06 00                            DW      BLK AT BLOCK BRAN +WORD20
9151 69 8B EB 89                                      WORD10: DW      TIB AT
9155 D2 8B EB 89 26 89 99 89 B5 86                    WORD20: DW      IN AT PLUS SWAP ENCL
915F 91 8C FF 84 22 00 03 91 D2 8B                            DW      HERE LIT 34 BLANK IN
9169 B7 89 72 89 BD 8C B7 88 D3 88 91 8C 23 8A 26 89          DW      PSTOR OVER SUB TOR R HERE CSTOR PLUS
9179 91 8C 75 8C C7 88 82 87 85 88                            DW      HERE ONEP FROMR CMOVE SEMIS
                                                      
9183 88 28 4E 55 4D 42 45 52 A9                       HPNUMB: DB      ^8 "(NUMBER" ^')'                       ; ***** (NUMBER)
918C 36 91                                                    DW      HWORD
918E 4C 8A                                            PNUMB:  DW      DOCOL
9190 75 8C AA 89 B7 88 FB 89                          PNUM10: DW      ONEP DUP TOR CAT
9198 26 8C EB 89 FB 85 43 85 2C 00                            DW      BASE AT DIGIT ZBRAN +PNUM30
91A2 99 89 26 8C EB 89 A7 87 87 89 EF 8C 26 8C EB 89          DW      SWAP BASE AT USTAR DROP ROT BASE AT
91B2 A7 87 36 89 30 8C EB 89 75 8C 43 85 08 00                DW      USTAR DPLUS DPL AT ONEP ZBRAN +PNUM20
91C0 FE 8A 30 8C B7 89                                        DW      ONE DPL PSTOR
91C6 C7 88 31 85 C6 FF                                PNUM20: DW      FROMR BRAN +PNUM10
91CC C7 88 85 88                                      PNUM30: DW      FROMR SEMIS
                                                      
91D0 86 4E 55 4D 42 45 D2                             HNUMB:  DB      ^6 "NUMBE" ^'R'                         ; ***** NUMBER
91D7 83 91                                                    DW      HPNUMB
91D9 4C 8A F6 8A F6 8A EF 8C AA 89 75 8C FB 89        NUMB:   DW      DOCOL ZERO ZERO ROT DUP ONEP CAT
91E7 FF 84 2D 00 C9 8C AA 89 B7 88 26 89 FF 84 FF FF          DW      LIT '-' EQUAL DUP TOR PLUS LIT -1
91F7 30 8C 10 8A 8E 91 AA 89                          NUMB10: DW      DPL STORE PNUMB DUP
91FF FB 89 17 8B BD 8C 43 85 16 00                            DW      CAT BL SUB ZBRAN +NUMB20
9209 AA 89 FB 89 FF 84 2E 00 BD 8C                            DW      DUP CAT LIT '.' SUB
9213 F6 8A BA 8D F6 8A 31 85 DC FF                            DW      ZERO QERR ZERO BRAN +NUMB10
921D 87 89 C7 88 43 85 04 00                          NUMB20: DW      DROP FROMR ZBRAN +NUMB30
9225 60 89                                                    DW      DMINU
9227 85 88                                            NUMB30: DW      SEMIS
                                                      
9229 85 2D 46 49 4E C4                                HDFIND: DB      ^5 "-FIN" ^'D'                          ; ***** -FIND
922F D0 91                                                    DW      HNUMB
9231 4C 8A 17 8B 3D 91 91 8C 4D 8F 61 92              DFIND:  DW      DOCOL BL WORD HERE COUNT UPPER
923D 91 8C 01 8C EB 89 EB 89 2D 86                            DW      HERE CONT AT AT PFIND
9247 AA 89 E0 88 43 85 0A 00                                  DW      DUP ZEQU ZBRAN +DFIN10
924F 87 89 91 8C 4E 8D 2D 86                                  DW      DROP HERE LATES PFIND
9257 85 88                                            DFIN10: DW      SEMIS
                                                      
9259 85 55 50 50 45 D2                                HUPPER: DB      ^5 "UPPE" ^'R'                          ; ***** UPPER
925F 29 92                                                    DW      HDFIND
9261 4C 8A 72 89 26 89 99 89 D9 85                    UPPER:  DW      DOCOL OVER PLUS SWAP XDO
926B EB 85 FB 89 FF 84 60 00 E1 8C                    UPPE10: DW      I CAT LIT 0x60 GREAT
9275 EB 85 FB 89 FF 84 7B 00 D5 8C                            DW      I CAT LIT 0x7B LESS
927F D7 87 43 85 0A 00                                        DW      AND ZBRAN +UPPE20
9285 EB 85 FF 84 20 00 D3 89                                  DW      I LIT 0x20 TOGGL
928D C4 85 DC FF                                      UPPE20: DW      XLOOP +UPPE10
9291 85 88                                                    DW      SEMIS
                                                      
9293 87 28 41 42 4F 52 54 A9                          HPABOR: DB      ^7 "(ABORT" ^')'                        ; ***** (ABORT)
929B 59 92                                                    DW      HUPPER
929D 4C 8A F1 94 85 88                                PABOR:  DW      DOCOL ABORT SEMIS
                                                      
92A3 85 45 52 52 4F D2                                HERROR: DB      ^5 "ERRO" ^'R'                          ; ***** ERROR
92A9 93 92                                                    DW      HPABOR
92AB 4C 8A 83 8B EB 89 09 89 43 85 04 00              ERROR:  DW      DOCOL WARN AT ZLESS ZBRAN +ERRO10
92B7 9D 92                                                    DW      PABOR
92B9 91 8C 4D 8F 60 8F C1 8F                          ERRO10: DW      HERE COUNT TYPE PDOTQ
92C1 03 20 3F 20                                              DB      3 32 '?' 32
92C5 7F 98 20 88 D2 8B EB 89 C9 8B EB 89 C3 94 85 88          DW      MESS SPSTO IN AT BLK AT QUIT SEMIS
                                                      
92D5 83 49 44 AE                                      HIDDOT: DB      ^3 "ID" ^'.'                            ; ***** ID.
92D9 A3 92                                                    DW      HERROR
92DB 4C 8A 2A 91 17 8B FF 84 5F 00 D2 90              IDDOT:  DW      DOCOL PAD BL LIT 95 FILL
92E7 AA 89 92 8D 5E 8D 72 89 BD 8C 2A 91 99 89 82 87          DW      DUP PFA LFA OVER SUB PAD SWAP CMOVE
92F7 2A 91 4D 8F FF 84 1F 00 D7 87 60 8F 03 8D 85 88          DW      PAD COUNT LIT 31 AND TYPE SPACE SEMIS
                                                      
9307 86 43 52 45 41 54 C5                             HCREAT: DB      ^6 "CREAT" ^'E'                         ; ***** CREATE
930E D5 92                                                    DW      HIDDOT
9310 4C 8A 31 92 43 85 10 00                          CREAT:  DW      DOCOL DFIND ZBRAN +CREA10
9318 87 89 7C 8D DB 92 FF 84 04 00 7F 98 03 8D                DW      DROP NFA IDDOT LIT 4 MESS SPACE
9326 91 8C AA 89 FB 89 75 8B EB 89 01 96 75 8C A1 8C  CREA10: DW      HERE DUP CAT WIDTH AT MIN ONEP ALLOT
9336 AA 89 FF 84 A0 00 D3 89 91 8C FE 8A BD 8C                DW      DUP LIT 0xA0 TOGGL HERE ONE SUB
9344 FF 84 80 00 D3 89 4E 8D AD 8C 0F 8C EB 89 10 8A          DW      LIT 0x80 TOGGL LATES COMMA CURR AT STORE
9354 91 8C 82 8C AD 8C 85 88                                  DW      HERE TWOP COMMA SEMIS
                                                      
935C C9 5B 43 4F 4D 50 49 4C 45 DD                    HBCOMP: DB      ^^9 "[COMPILE" ^']'                     ; ***** [COMPILE]
9366 07 93                                                    DW      HCREAT
9368 4C 8A 31 92 E0 88 F6 8A BA 8D                    BCOMP:  DW      DOCOL DFIND ZEQU ZERO QERR
9372 87 89 6E 8D AD 8C 85 88                                  DW      DROP CFA COMMA SEMIS
                                                      
937A C7 4C 49 54 45 52 41 CC                          HLITER: DB      ^^7 "LITERA" ^'L'                       ; ***** LITERAL
9382 5C 93                                                    DW      HBCOMP
9384 4C 8A 1B 8C EB 89 43 85 08 00                    LITER:  DW      DOCOL STATE AT ZBRAN +LITE10
938E 4D 8E FF 84 AD 8C                                        DW      COMP LIT COMMA
9394 85 88                                            LITE10: DW      SEMIS
                                                      
9396 C8 44 4C 49 54 45 52 41 CC                       HDLITE: DB      ^^8 "DLITERA" ^'L'                      ; ***** DLITERAL
939F 7A 93                                                    DW      HLITER
93A1 4C 8A 1B 8C EB 89 43 85 08 00                    DLITE:  DW      DOCOL STATE AT ZBRAN +DLIT10
93AB 99 89 84 93 84 93                                        DW      SWAP LITER LITER
93B1 85 88                                            DLIT10: DW      SEMIS
                                                      
93B3 82 55 BC                                         HULESS: DB      ^2 "U" ^'<'                             ; ***** U<
93B6 96 93                                                    DW      HDLITE
93B8 4C 8A B7 88 F6 8A C7 88 F6 8A 60 89 36 89        ULESS:  DW      DOCOL TOR ZERO FROMR ZERO DMINU DPLUS
93C6 99 89 87 89 09 89 85 88                                  DW      SWAP DROP ZLESS SEMIS
                                                      
93CE 86 3F 53 54 41 43 CB                             HQSTAC: DB      ^6 "?STAC" ^'K'                         ; ***** ?STACK
93D5 B3 93                                                    DW      HULESS
93D7 4C 8A 56 8B EB 89 06 8B BD 8C 09 88 B8 93        QSTAC:  DW      DOCOL SZERO AT TWO SUB SPAT ULESS
93E5 FE 8A BA 8D 09 88 91 8C FF 84 80 00                      DW      ONE QERR SPAT HERE LIT 128
93F1 26 89 B8 93 06 8B BA 8D 85 88                            DW      PLUS ULESS TWO QERR SEMIS
                                                      
93FB 89 49 4E 54 45 52 50 52 45 D4                    HINTER: DB      ^9 "INTERPRE" ^'T'                      ; ***** INTERPRET
9405 CE 93                                                    DW      HQSTAC
9407 4C 8A                                            INTER:  DW      DOCOL
9409 31 92 43 85 1E 00                                INTE10: DW      DFIND ZBRAN +INTE40
940F 1B 8C EB 89 D5 8C 43 85 0A 00                            DW      STATE AT LESS ZBRAN +INTE20
9419 6E 8D AD 8C 31 85 0C 00                                  DW      CFA COMMA BRAN +INTE40
9421 6E 8D 11 85                                      INTE20: DW      CFA EXEC
9425 D7 93 31 85 1C 00                                INTE30: DW      QSTAC BRAN +INTE70
942B 91 8C D9 91 30 8C EB 89 75 8C 43 85 08 00        INTE40: DW      HERE NUMB DPL AT ONEP ZBRAN +INTE50
9439 A1 93 31 85 06 00                                        DW      DLITE BRAN +INTE60
943F 87 89 84 93                                      INTE50: DW      DROP LITER
9443 D7 93                                            INTE60: DW      QSTAC
9445 31 85 C2 FF                                      INTE70: DW      BRAN +INTE10
                                                      
9449 89 49 4D 4D 45 44 49 41 54 C5                    HIMMED: DB      ^9 "IMMEDIAT" ^'E'                      ; ***** IMMEDIATE
9453 FB 93                                                    DW      HINTER
9455 4C 8A 4E 8D FF 84 40 00 D3 89 85 88              IMMED:  DW      DOCOL LATES LIT 0x40 TOGGL SEMIS
                                                      
9461 8A 56 4F 43 41 42 55 4C 41 52 D9                 HVOCAB: DB      ^10 "VOCABULAR" ^'Y'                    ; ***** VOCABULARY
946C 49 94                                                    DW      HIMMED
946E 4C 8A F0 8E 81 A0 AD 8C 0F 8C EB 89 6E 8D AD 8C  VOCAB:  DW      DOCOL BUILD 0xa081 COMMA CURR AT CFA COMMA
947E 91 8C A7 8B EB 89 AD 8C A7 8B 10 8A 00 8F                DW      HERE VOCL AT COMMA VOCL STORE DOES
948C 82 8C 01 8C 10 8A 85 88                          DOVOC:  DW      TWOP CONT STORE SEMIS
                                                      
9494 8B 44 45 46 49 4E 49 54 49 4F 4E D3              HDEFIN: DB      ^11 "DEFINITION" ^'S'                   ; ***** DEFINITIONS
94A0 61 94                                                    DW      HVOCAB
94A2 4C 8A 01 8C EB 89 0F 8C 10 8A 85 88              DEFIN:  DW      DOCOL CONT AT CURR STORE SEMIS
                                                      
94AE 81 A8                                            HPAREN: DB      ^1 ^'('                                 ; ***** (
94B0 94 94                                                    DW      HDEFIN
94B2 4C 8A FF 84 29 00 3D 91 85 88                    PAREN:  DW      DOCOL LIT ')' WORD SEMIS
                                                      
94BC 84 51 55 49 D4                                   HQUIT:  DB      ^4 "QUI" ^'T'                           ; ***** QUIT
94C1 AE 94                                                    DW      HPAREN
94C3 4C 8A F6 8A C9 8B 10 8A 63 8E                    QUIT:   DW      DOCOL ZERO BLK STORE LBRAC
94CD 42 88 61 87 7F 90 07 94 1B 8C EB 89              QUIT10: DW      RPSTO CR QUERY INTER STATE AT
94D9 E0 88 43 85 08 00                                        DW      ZEQU ZBRAN +QUIT20
94DF C1 8F                                                    DW      PDOTQ
94E1 03 20 6F 6B                                              DB      3 32 "ok"
94E5 31 85 E6 FF                                      QUIT20: DW      BRAN +QUIT10
                                                      
94E9 85 41 42 4F 52 D4                                HABORT: DB      ^5 "ABOR" ^'T'                          ; ***** ABORT
94EF BC 94                                                    DW      HQUIT
94F1 4C 8A                                            ABORT:  DW      DOCOL
94F3 42 88 20 88 AE 8E 03 8D 61 87 C1 8F              ABOR10: DW      RPSTO SPSTO DEC SPACE CR PDOTQ
94FF 13 4D 69 6E 69 6D 61 6C 2D 46 4F 52 54 48                DB      19 "Minimal-FORTH"
950D 20 76 20 30 2E 31                                        DB      32 "v" 32 "0.1"
9513 63 9C A2 94 C3 94                                        DW      FORTH DEFIN QUIT
                                                      
                                                      ; INCLUDE         coldwarm.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; COLD AND WARM START ENTRY POINTS
                                                      
9519 0E FE                                            CENT:   LDI     0xFE            ; Initialize Minimal stack pointer
951B 16 FF FF                                                 STA     0xFFFF          ; :
951E 0E 46                                                    LDI     <COLD10         ; Start by executing COLD
9520 16 E8 FE                                                 STA     IP.0            ; :
9523 0E 95                                                    LDI     >COLD10         ; :
9525 16 E9 FE                                                 STA     IP.1            ; :
9528 14 9C 84                                                 JPA     NEXT            ; ... and over to FORTH VM
                                                      
952B 0E FE                                            WENT:   LDI     0xFE            ; Initialize Minimal stack pointer
952D 16 FF FF                                                 STA     0xFFFF          ; :
9530 0E F3                                                    LDI     <ABOR10         ; Start by executing ABORT
9532 16 E8 FE                                                 STA     IP.0            ; :
9535 0E 94                                                    LDI     >ABOR10         ; :
9537 16 E9 FE                                                 STA     IP.1            ; :
953A 14 9C 84                                                 JPA     NEXT            ; ... and over to FORTH VM
                                                      
953D 84 43 4F 4C C4                                   HCOLD:  DB      ^4 "COL" ^'D'                           ; ***** COLD
9542 E9 94                                                    DW      HABORT
9544 4C 8A                                            COLD:   DW      DOCOL
                                                      COLD10: ; Init FORTH registers
9546 42 88 20 88 64 88                                        DW      RPSTO SPSTO UPSTO
                                                              ; Set FORTH vocabulary
954C FF 84 0C 00 47 8B EB 89                                  DW      LIT 12 PORIG AT
9554 FF 84 06 00 FF 84 63 9C 26 89 10 8A                      DW      LIT 6 LIT FORTH PLUS STORE
9560 47 83                                                    DW      _HALT
                                                              ; Init 12 items (24 bytes) in user area ...
                                                              ; ... with values from boot table
9562 FF 84 12 00 47 8B                                        DW      LIT 18 PORIG
9568 FF 84 10 00 47 8B EB 89 FF 84 06 00 26 89                DW      LIT 16 PORIG AT LIT 6 PLUS
9576 FF 84 18 00 82 87                                        DW      LIT 24 CMOVE
                                                              ; Erase disk buffers
957C FF 84 22 00 47 8B EB 89 FF 84 24 00 47 8B EB 89          DW      LIT 34 PORIG AT LIT 36 PORIG AT
958C 72 89 BD 8C F2 90                                        DW      OVER SUB ERASE
                                                              ; Initialize some of the user variables
9592 F6 8A DC 8B 10 8A                                        DW      ZERO OUT STORE
9598 B3 8B EB 89 61 8C 10 8A                                  DW      FIRST AT USE STORE
95A0 B3 8B EB 89 6C 8C 10 8A                                  DW      FIRST AT PREV STORE
                                                              ; Continue via ABORT
95A8 F1 94                                                    DW      ABORT
                                                      
                                                      
                                                      
                                                      ; INCLUDE         math.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; MATHEMATICS WORDS
                                                      
95AA 84 53 2D 3E C4                                   HSTOD:  DB      ^4 "S->" ^'D'                           ; ***** S->D
95AF 3D 95                                                    DW      HCOLD
95B1 4C 8A AA 89 09 89 4C 89 85 88                    STOD:   DW      DOCOL DUP ZLESS MINUS SEMIS
                                                      
95BB 82 2B AD                                         HPM:    DB      ^2 "+" ^'-'                             ; ***** +-
95BE AA 95                                                    DW      HSTOD
95C0 4C 8A 09 89 43 85 04 00                          PM:     DW      DOCOL ZLESS ZBRAN +PM10
95C8 4C 89                                                    DW      MINUS
95CA 85 88                                            PM10:   DW      SEMIS
                                                      
95CC 83 44 2B AD                                      HDPM:   DB      ^3 "D+" ^'-'                            ; ***** D+-
95D0 BB 95                                                    DW      HPM
95D2 4C 8A 09 89 43 85 04 00                          DPM:    DW      DOCOL ZLESS ZBRAN +DPM10
95DA 60 89                                                    DW      DMINU
95DC 85 88                                            DPM10:  DW      SEMIS
                                                      
95DE 83 41 42 D3                                      HABS:   DB      ^3 "AB" ^'S'                            ; ***** ABS
95E2 CC 95                                                    DW      HDPM
95E4 4C 8A AA 89 C0 95 85 88                          ABS:    DW      DOCOL DUP PM SEMIS
                                                      
95EC 84 44 41 42 D3                                   HDABS:  DB      ^4 "DAB" ^'S'                           ; ***** DABS
95F1 DE 95                                                    DW      HABS
95F3 4C 8A AA 89 D2 95 85 88                          DABS:   DW      DOCOL DUP DPM SEMIS
                                                      
95FB 83 4D 49 CE                                      HMIN:   DB      ^3 "MI" ^'N'                            ; ***** MIN
95FF EC 95                                                    DW      HDABS
9601 4C 8A 72 89 72 89 E1 8C 43 85 04 00              MIN:    DW      DOCOL OVER OVER GREAT ZBRAN +MIN10
960D 99 89                                                    DW      SWAP
960F 87 89 85 88                                      MIN10:  DW      DROP SEMIS
                                                      
9613 83 4D 41 D8                                      HMAX:   DB      ^3 "MA" ^'X'                            ; ***** MAX
9617 FB 95                                                    DW      HMIN
9619 4C 8A 72 89 72 89 D5 8C 43 85 04 00              MAX:    DW      DOCOL OVER OVER LESS ZBRAN +MAX10
9625 99 89                                                    DW      SWAP
9627 87 89 85 88                                      MAX10:  DW      DROP SEMIS
                                                      
962B 82 4D AA                                         HMSTAR: DB      ^2 "M" ^'*'                             ; ****** M*
962E 13 96                                                    DW      HMAX
9630 4C 8A 72 89 72 89 F8 87 B7 88 E4 95 99 89 E4 95  MSTAR:  DW      DOCOL OVER OVER XOR TOR ABS SWAP ABS
9640 A7 87 C7 88 D2 95 85 88                                  DW      USTAR FROMR DPM SEMIS
                                                      
9648 82 4D AF                                         HMSLAS: DB      ^2 "M" ^'/'                             ; ***** M/
964B 2B 96                                                    DW      HMSTAR
964D 4C 8A 72 89 B7 88 B7 88 F3 95 D3 88 E4 95        MSLAS:  DW      DOCOL OVER TOR TOR DABS R ABS
965B B7 87 C7 88 D3 88 F8 87 C0 95 99 89                      DW      USLAS FROMR R XOR PM SWAP
9667 C7 88 C0 95 99 89 85 88                                  DW      FROMR PM SWAP SEMIS
                                                      
966F 81 AA                                            HSTAR:  DB      ^1 ^'*'                                 ; ***** *
9671 48 96                                                    DW      HMSLAS
9673 4C 8A 30 96 87 89 85 88                          STAR:   DW      DOCOL MSTAR DROP SEMIS
                                                      
967B 84 2F 4D 4F C4                                   HSLMOD: DB      ^4 "/MO" ^'D'                           ; ***** /MOD
9680 6F 96                                                    DW      HSTAR
9682 4C 8A B7 88 B1 95 C7 88 4D 96 85 88              SLMOD:  DW      DOCOL TOR STOD FROMR MSLAS SEMIS
                                                      
968E 81 AF                                            HSLAS:  DB      ^1 ^'/'                                 ; ***** /
9690 7B 96                                                    DW      HSLMOD
9692 4C 8A 82 96 99 89 87 89 85 88                    SLASH:  DW      DOCOL SLMOD SWAP DROP SEMIS
                                                      
969C 83 4D 4F C4                                      HMOD:   DB      ^3 "MO" ^'D'                            ; ***** MOD
96A0 8E 96                                                    DW      HSLAS
96A2 4C 8A 82 96 87 89 85 88                          MOD:    DW      DOCOL SLMOD DROP SEMIS
                                                      
96AA 85 2A 2F 4D 4F C4                                HSSMOD: DB      ^5 "*/MO" ^'D'                          ; ***** */MOD
96B0 9C 96                                                    DW      HMOD
96B2 4C 8A B7 88 30 96 C7 88 4D 96 85 88              SSMOD:  DW      DOCOL TOR MSTAR FROMR MSLAS SEMIS
                                                      
96BE 82 2A AF                                         HSSLA:  DB      ^2 "*" ^'/'                             ; ***** */
96C1 AA 96                                                    DW      HSSMOD
96C3 4C 8A B2 96 99 89 87 89 85 88                    SSLA:   DW      DOCOL SSMOD SWAP DROP SEMIS
                                                      
96CD 85 4D 2F 4D 4F C4                                HMSMOD: DB      ^5 "M/MO" ^'D'                          ; ***** M/MOD
96D3 AA 96                                                    DW      HSSMOD
96D5 4C 8A B7 88 F6 8A D3 88 B7 87 C7 88              MSMOD:  DW      DOCOL TOR ZERO R USLAS FROMR
96E1 99 89 B7 88 B7 87 C7 88 85 88                            DW      SWAP TOR USLAS FROMR SEMIS
                                                      
                                                      ; INCLUDE         diskio.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; DISK I/O
                                                      
96EB 84 2B 42 55 C6                                   HPBUF:  DB      ^4 "+BU" ^'F'                           ; ***** +BUF
96F0 CD 96                                                    DW      HMSMOD
96F2 4C 8A 2D 8B FF 84 04 00 26 89                    PBUF:   DW      DOCOL BBUF LIT 4 PLUS
96FC AA 89 BF 8B EB 89 C9 8C 43 85 08 00                      DW      DUP LIMIT AT EQUAL ZBRAN +PBUF10
9708 87 89 B3 8B EB 89                                        DW      DROP FIRST AT
970E AA 89 6C 8C EB 89 BD 8C 85 88                    PBUF10: DW      DUP PREV AT SUB SEMIS
                                                      
9718 86 55 50 44 41 54 C5                             HUPDAT: DB      ^6 "UPDAT" ^'E'                         ; ***** UPDATE
971F EB 96                                                    DW      HPBUF
9721 4C 8A 6C 8C EB 89 EB 89 FF 84 00 80              UPDAT:  DW      DOCOL PREV AT AT LIT 0x8000
972D E7 87 6C 8C EB 89 10 8A 85 88                            DW      OR PREV AT STORE SEMIS
                                                      
9737 8D 45 4D 50 54 59 2D 42 55 46 46 45 52 D3        HMTBUF: DB      ^13 "EMPTY-BUFFER" ^'S'                 ; ***** EMPTY-BUFFERS
9745 18 97                                                    DW      HUPDAT
9747 4C 8A B3 8B EB 89 BF 8B EB 89                    MTBUF:  DW      DOCOL FIRST AT LIMIT AT
9751 72 89 BD 8C F2 90 85 88                                  DW      OVER SUB ERASE SEMIS
                                                      
9759 85 46 4C 55 53 C8                                HFLUSH: DB      ^5 "FLUS" ^'H'                          ; ***** FLUSH
975F 37 97                                                    DW      HMTBUF
9761 4C 8A BF 8B EB 89 B3 8B EB 89 D9 85              FLUSH:  DW      DOCOL LIMIT AT FIRST AT XDO
976D EB 85 EB 89 09 89 43 85 14 00                    FLUS10: DW      I AT ZLESS ZBRAN +FLUS20
9777 EB 85 82 8C EB 85 EB 89 FF 84 FF 7F                      DW      I TWOP I AT LIT 0x7FFF
9783 D7 87 F6 8A 6F 87                                        DW      AND ZERO RW
9789 2D 8B FF 84 04 00 26 89 77 85 DA FF              FLUS20: DW      BBUF LIT 4 PLUS XPLOO +FLUS10
9795 47 97 85 88                                              DW      MTBUF SEMIS
                                                      
9799 86 42 55 46 46 45 D2                             HBUFFE: DB      ^6 "BUFFE" ^'R'                         ; ***** BUFFER
97A0 59 97                                                    DW      HFLUSH
97A2 4C 8A 61 8C EB 89 AA 89 B7 88                    BUFFE:  DW      DOCOL USE AT DUP TOR
97AC F2 96 43 85 FC FF                                BUFF10: DW      PBUF ZBRAN +BUFF10
97B2 61 8C 10 8A D3 88 EB 89 D5 8C 43 85 14 00                DW      USE STORE R AT LESS ZBRAN +BUFF20
97C0 D3 88 82 8C D3 88 EB 89 FF 84 FF 7F                      DW      R TWOP R AT LIT 0x7FFF
97CC D7 87 F6 8A 6F 87                                        DW      AND ZERO RW
97D2 D3 88 10 8A D3 88 6C 8C 10 8A C7 88 82 8C 85 88  BUFF20: DW      R STORE R PREV STORE FROMR TWOP SEMIS
                                                      
97E2 85 42 4C 4F 43 CB                                HBLOCK: DB      ^5 "BLOC" ^'K'                          ; ***** BLOCK
97E8 99 97                                                    DW      HBUFFE
97EA 4C 8A B7 88 6C 8C EB 89 AA 89                    BLOCK:  DW      DOCOL TOR PREV AT DUP
97F4 EB 89 FF 84 FF 7F D7 87 D3 88 BD 8C 43 85 36 00          DW      AT LIT 0x7FFF AND R SUB ZBRAN +BLOC30
9804 F2 96 E0 88 43 85 14 00                          BLOC10: DW      PBUF ZEQU ZBRAN +BLOC20
980C 87 89 D3 88 A2 97 AA 89 D3 88                            DW      DROP R BUFFE DUP R
9816 FE 8A 6F 87 06 8B BD 8C                                  DW      ONE RW TWO SUB
981E AA 89 EB 89 FF 84 FF 7F D7 87 D3 88              BLOC20: DW      DUP AT LIT 0x7FFF AND R
982A BD 8C E0 88 43 85 D4 FF                                  DW      SUB ZEQU ZBRAN +BLOC10
9832 AA 89 6C 8C 10 8A                                        DW      DUP PREV STORE
9838 C7 88 87 89 82 8C 85 88                          BLOC30: DW      FROMR DROP TWOP SEMIS
                                                      
9840 86 28 4C 49 4E 45 A9                             HPLINE: DB      ^6 "(LINE" ^')'                         ; ***** (LINE)
9847 E2 97                                                    DW      HBLOCK
9849 4C 8A B7 88 21 8B 2D 8B B2 96 C7 88 39 8B        PLINE:  DW      DOCOL TOR CL BBUF SSMOD FROMR BSCR
9857 73 96 26 89 EA 97 26 89 21 8B 85 88                      DW      STAR PLUS BLOCK PLUS CL SEMIS
                                                      
9863 85 2E 4C 49 4E C5                                HDLINE: DB      ^5 ".LIN" ^'E'                          ; ***** .LINE
9869 40 98                                                    DW      HPLINE
986B 4C 8A 49 98 8E 8F 60 8F 85 88                    DLINE:  DW      DOCOL PLINE DTRAI TYPE SEMIS
                                                      
9875 87 4D 45 53 53 41 47 C5                          HMESS:  DB      ^7 "MESSAG" ^'E'                        ; ***** MESSAGE
987D 63 98                                                    DW      HDLINE
987F 4C 8A 83 8B EB 89 43 85 1A 00                    MESS:   DW      DOCOL WARN AT ZBRAN +MESS20
9889 12 8D 43 85 10 00                                        DW      DDUP ZBRAN +MESS10
988F FF 84 10 00 82 96 FF 84 04 00 26 89 6B 98                DW      LIT 16 SLMOD LIT 4 PLUS DLINE
989D 31 85 0D 00                                      MESS10: DW      BRAN +MESS30
98A1 C1 8F                                            MESS20: DW      PDOTQ
98A3 06 4D 53 47 20 23 20                                     DB      6 "MSG" 32 '#' 32
98AA 68 9B                                                    DW      DOT
98AC 85 88                                            MESS30: DW      SEMIS
                                                      
98AE 84 4C 4F 41 C4                                   HLOAD:  DB      ^4 "LOA" ^'D'                           ; ***** LOAD
98B3 75 98                                                    DW      HMESS
98B5 4C 8A C9 8B EB 89 B7 88 D2 8B EB 89 B7 88 F6 8A  LOAD:   DW      DOCOL BLK AT TOR IN AT TOR ZERO IN
98C5 D2 8B 10 8A 39 8B 73 96 C9 8B 10 8A 07 94 C7 88          DW      STORE BSCR STAR BLK STORE INTER FROMR
98D5 D2 8B 10 8A C7 88 C9 8B 10 8A 85 88                      DW      IN STORE FROMR BLK STORE SEMIS
                                                      
98E1 83 2D 2D BE                                      HARROW: DB      ^3 "--" ^'>'                            ; ***** -->
98E5 AE 98                                                    DW      HLOAD
98E7 4C 8A 33 8E F6 8A D2 8B 10 8A 39 8B C9 8B EB 89  ARROW:  DW      DOCOL QLOAD ZERO IN STORE BSCR BLK AT
98F7 72 89 A2 96 BD 8C C9 8B B7 89 85 88                      DW      OVER MOD SUB BLK PSTOR SEMIS
                                                      
                                                      ; INCLUDE         misc.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; MISCELLANEOUS HIGHER LEVEL
                                                      
9903 81 A7                                            HTICK:  DB      ^1 ^39                                  ; ***** '
9905 E1 98                                                    DW      HARROW
9907 4C 8A 31 92 E0 88 F6 8A BA 8D 87 89 84 93 85 88  TICK:   DW      DOCOL DFIND ZEQU ZERO QERR DROP LITER SEMIS
                                                      
9917 86 46 4F 52 47 45 D4                             HFORGE: DB      ^6 "FORGE" ^'T'                         ; ***** FORGET
991E 03 99                                                    DW      HTICK
9920 4C 8A 0F 8C EB 89 01 8C EB 89 BD 8C FF 84 18 00  FORGE:  DW      DOCOL CURR AT CONT AT SUB LIT 24
9930 BA 8D 07 99 AA 89 8F 8B EB 89 D5 8C FF 84 15 00          DW      QERR TICK DUP FENCE AT LESS LIT 21
9940 BA 8D AA 89 7C 8D 98 8B 10 8A 5E 8D EB 89 01 8C          DW      QERR DUP NFA DP STORE LFA AT CONT
9950 EB 89 10 8A 85 88                                        DW      AT STORE SEMIS
                                                      
9956 84 42 41 43 CB                                   HBACK:  DB      ^4 "BAC" ^'K'                           ; ***** BACK
995B 17 99                                                    DW      HFORGE
995D 4C 8A 91 8C BD 8C AD 8C 85 88                    BACK:   DW      DOCOL HERE SUB COMMA SEMIS
                                                      
9967 C5 42 45 47 49 CE                                HBEGIN: DB      ^^5 "BEGI" ^'N'                         ; ***** BEGIN
996D 56 99                                                    DW      HBACK
996F 4C 8A D4 8D 91 8C FE 8A 85 88                    BEGIN:  DW      DOCOL QCOMP HERE ONE SEMIS
                                                      
9979 C5 45 4E 44 49 C6                                HENDIF: DB      ^^5 "ENDI" ^'F'                         ; ***** ENDIF
997F 67 99                                                    DW      HBEGIN
9981 4C 8A D4 8D 06 8B 03 8E 91 8C                    ENDIF:  DW      DOCOL QCOMP TWO QPAIR HERE
998B 72 89 BD 8C 99 89 10 8A 85 88                            DW      OVER SUB SWAP STORE SEMIS
                                                      
9995 C4 54 48 45 CE                                   HTHEN:  DB      ^^4 "THE" ^'N'                          ; ***** THEN
999A 79 99                                                    DW      HENDIF
999C 4C 8A 81 99 85 88                                THEN:   DW      DOCOL ENDIF SEMIS
                                                      
99A2 C2 44 CF                                         HDO:    DB      ^^2 "D" ^'O'                            ; ***** DO
99A5 95 99                                                    DW      HTHEN
99A7 4C 8A 4D 8E D9 85 91 8C FF 84 03 00 85 88        DO:     DW      DOCOL COMP XDO HERE LIT 3 SEMIS
                                                      
99B5 C4 4C 4F 4F D0                                   HLOOP:  DB      ^^4 "LOO" ^'P'                          ; ***** LOOP
99BA A2 99                                                    DW      HDO
99BC 4C 8A FF 84 03 00 03 8E 4D 8E C4 85 5D 99 85 88  LOOP:   DW      DOCOL LIT 3 QPAIR COMP XLOOP BACK SEMIS
                                                      
99CC C5 2B 4C 4F 4F D0                                HPLOOP: DB      ^^5 "+LOO" ^'P'                         ; ***** +LOOP
99D2 B5 99                                                    DW      HLOOP
99D4 4C 8A FF 84 03 00 03 8E 4D 8E 77 85 5D 99 85 88  PLOOP:  DW      DOCOL LIT 3 QPAIR COMP XPLOO BACK SEMIS
                                                      
99E4 C5 55 4E 54 49 CC                                HUNTIL: DB      ^^5 "UNTI" ^'L'                         ; ***** UNTIL
99EA CC 99                                                    DW      HPLOOP
99EC 4C 8A FE 8A 03 8E 4D 8E 43 85 5D 99 85 88        UNTIL:  DW      DOCOL ONE QPAIR COMP ZBRAN BACK SEMIS
                                                      
99FA C3 45 4E C4                                      HEND:   DB      ^^3 "EN" ^'D'                           ; ***** ENDI
99FE E4 99                                                    DW      HUNTIL
9A00 4C 8A EC 99 85 88                                END:    DW      DOCOL UNTIL SEMIS
                                                      
9A06 C5 41 47 41 49 CE                                HAGAIN: DB      ^^5 "AGAI" ^'N'                         ; ***** AGAIN
9A0C FA 99                                                    DW      HEND
9A0E 4C 8A FE 8A 03 8E 4D 8E 31 85 5D 99 85 88        AGAIN:  DW      DOCOL ONE QPAIR COMP BRAN BACK SEMIS
                                                      
9A1C C6 52 45 50 45 41 D4                             HREPEA: DB      ^^6 "REPEA" ^'T'                        ; ***** REPEAT
9A23 06 9A                                                    DW      HAGAIN
9A25 4C 8A B7 88 B7 88 0E 9A C7 88 C7 88              REPEA:  DW      DOCOL TOR TOR AGAIN FROMR FROMR
9A31 06 8B BD 8C 81 99 85 88                                  DW      TWO SUB ENDIF SEMIS
                                                      
9A39 C2 49 C6                                         HIF:    DB      ^^2 "I" ^'F'                            ; ***** IF
9A3C 1C 9A                                                    DW      HREPEA
9A3E 4C 8A 4D 8E 43 85 91 8C F6 8A AD 8C 06 8B 85 88  IF:     DW      DOCOL COMP ZBRAN HERE ZERO COMMA TWO SEMIS
                                                      
9A4E C4 45 4C 53 C5                                   HELSE:  DB      ^^4 "ELS" ^'E'                          ; ***** ELSE
9A53 39 9A                                                    DW      HIF
9A55 4C 8A 06 8B 03 8E 4D 8E 31 85 91 8C 06 8B AD 8C  ELSE:   DW      DOCOL TWO QPAIR COMP BRAN HERE TWO COMMA
9A65 99 89 06 8B 81 99 06 8B 85 88                            DW      SWAP TWO ENDIF TWO SEMIS
                                                      
9A6F C5 57 48 49 4C C5                                HWHILE: DB      ^^5 "WHIL" ^'E'                         ; ***** WHILE
9A75 4E 9A                                                    DW      HELSE
9A77 4C 8A 3E 9A 82 8C 85 88                          WHILE:  DW      DOCOL IF TWOP SEMIS
                                                      
9A7F 86 53 50 41 43 45 D3                             HSPACS: DB      ^6 "SPACE" ^'S'                         ; ***** SPACES
9A86 6F 9A                                                    DW      HWHILE
9A88 4C 8A F6 8A 19 96 12 8D 43 85 0C 00              SPACS:  DW      DOCOL ZERO MAX DDUP ZBRAN +SPAC20
9A94 F6 8A D9 85                                              DW      ZERO XDO
9A98 03 8D C4 85 FC FF                                SPAC10: DW      SPACE XLOOP +SPAC10
9A9E 85 88                                            SPAC20: DW      SEMIS
                                                      
9AA0 82 3C A3                                         HBDIGS: DB      ^2 "<" ^'#'                             ; ***** <#
9AA3 7F 9A                                                    DW      HSPACS
9AA5 4C 8A 2A 91 57 8C 10 8A 85 88                    BDIGS:  DW      DOCOL PAD HLD STORE SEMIS
                                                      
9AAF 82 23 BE                                         HEDIGS: DB      ^2 "#" ^'>'                             ; ***** #>
9AB2 A0 9A                                                    DW      HBDIGS
9AB4 4C 8A 87 89 87 89 57 8C EB 89                    EDIGS:  DW      DOCOL DROP DROP HLD AT
9ABE 2A 91 72 89 BD 8C 85 88                                  DW      PAD OVER SUB SEMIS
                                                      
9AC6 84 53 49 47 CE                                   HSIGN:  DB      ^4 "SIG" ^'N'                           ; ***** SIGN
9ACB AF 9A                                                    DW      HEDIGS
9ACD 4C 8A EF 8C 09 89 43 85 08 00                    SIGN:   DW      DOCOL ROT ZLESS ZBRAN +SIGN10
9AD7 FF 84 2D 00 12 91                                        DW      LIT '-' HOLD
9ADD 85 88                                            SIGN10: DW      SEMIS
                                                      
9ADF 81 A3                                            HDIG:   DB      ^1 ^'#'                                 ; ***** #
9AE1 C6 9A                                                    DW      HSIGN
9AE3 4C 8A 26 8C EB 89 D5 96 EF 8C                    DIG:    DW      DOCOL BASE AT MSMOD ROT
9AED FF 84 09 00 72 89 D5 8C 43 85 08 00                      DW      LIT 9 OVER LESS ZBRAN +DIG10
9AF9 FF 84 07 00 26 89                                        DW      LIT 7 PLUS
9AFF FF 84 30 00 26 89 12 91 85 88                    DIG10:  DW      LIT '0' PLUS HOLD SEMIS
                                                      
9B09 82 23 D3                                         HDIGS:  DB      ^2 "#" ^'S'                             ; ***** #S
9B0C DF 9A                                                    DW      HDIG
9B0E 4C 8A                                            DIGS:   DW      DOCOL
9B10 E3 9A 72 89 72 89 E7 87 E0 88 43 85 F4 FF        DIGS10: DW      DIG OVER OVER OR ZEQU ZBRAN +DIGS10
9B1E 85 88                                                    DW      SEMIS
                                                      
9B20 83 44 2E D2                                      HDDOTR: DB      ^3 "D." ^'R'                            ; ***** D.R
9B24 09 9B                                                    DW      HDIGS
9B26 4C 8A B7 88 99 89 72 89 F3 95                    DDOTR:  DW      DOCOL TOR SWAP OVER DABS
9B30 A5 9A 0E 9B CD 9A B4 9A                                  DW      BDIGS DIGS SIGN EDIGS
9B38 C7 88 72 89 BD 8C 88 9A 60 8F 85 88                      DW      FROMR OVER SUB SPACS TYPE SEMIS
                                                      
9B44 82 2E D2                                         HDOTR:  DB      ^2 "." ^'R'                             ; ***** .R
9B47 20 9B                                                    DW      HDDOTR
9B49 4C 8A B7 88 B1 95 C7 88 26 9B 85 88              DOTR:   DW      DOCOL TOR STOD FROMR DDOTR SEMIS
                                                      
9B55 82 44 AE                                         HDDOT:  DB      ^2 "D" ^'.'                             ; ***** D.
9B58 44 9B                                                    DW      HDOTR
9B5A 4C 8A F6 8A 26 9B 03 8D 85 88                    DDOT:   DW      DOCOL ZERO DDOTR SPACE SEMIS
                                                      
9B64 81 AE                                            HDOT:   DB      ^1 ^'.'                                 ; ***** .
9B66 55 9B                                                    DW      HDDOT
9B68 4C 8A B1 95 5A 9B 85 88                          DOT:    DW      DOCOL STOD DDOT SEMIS
                                                      
9B70 81 BF                                            HQUEST: DB      ^1 ^'?'                                 ; ***** ?
9B72 64 9B                                                    DW      HDOT
9B74 4C 8A EB 89 68 9B 85 88                          QUEST:  DW      DOCOL AT DOT SEMIS
                                                      
9B7C 82 55 AE                                         HUDOT:  DB      ^2 "U" ^'.'                             ; ***** U.
9B7F 70 9B                                                    DW      HQUEST
9B81 4C 8A F6 8A 5A 9B 85 88                          UDOT:   DW      DOCOL ZERO DDOT SEMIS
                                                      
                                                      ; ----------------------------------
                                                      ; UTILITY WORDS
                                                      
9B89 84 4C 49 53 D4                                   HLIST:  DB      ^4 "LIS" ^'T'                           ; ***** LIST
9B8E 7C 9B                                                    DW      HUDOT
9B90 4C 8A AE 8E 61 87 AA 89 E6 8B 10 8A C1 8F        LIST:   DW      DOCOL DEC CR DUP SCR STORE PDOTQ
9B9E 06 53 43 52 20 23 20                                     DB      6 "SCR" 32 "#" 32
9BA5 68 9B FF 84 10 00 F6 8A D9 85                            DW      DOT LIT 16 ZERO XDO
9BAF 61 87 EB 85 0E 8B 49 9B 03 8D                    LIST10: DW      CR I THREE DOTR SPACE
9BB9 EB 85 E6 8B EB 89 6B 98 C4 85 EC FF                      DW      I SCR AT DLINE XLOOP +LIST10
9BC5 61 87 85 88                                              DW      CR SEMIS
                                                      
9BC9 85 49 4E 44 45 D8                                HINDEX: DB      ^5 "INDE" ^'X'                          ; ***** INDEX
9BCF 89 9B                                                    DW      HLIST
9BD1 4C 8A 61 87 75 8C 99 89 D9 85                    INDEX:  DW      DOCOL CR ONEP SWAP XDO
9BDB 61 87 EB 85 0E 8B 49 9B 03 8D F6 8A EB 85 6B 98  INDE10: DW      CR I THREE DOTR SPACE ZERO I DLINE
9BEB 4B 87 43 85 04 00                                        DW      QTERM ZBRAN +INDE20
9BF1 A4 88                                                    DW      LEAVE
9BF3 C4 85 E6 FF                                      INDE20: DW      XLOOP +INDE10
9BF7 85 88                                                    DW      SEMIS
                                                      
9BF9 85 56 4C 49 53 D4                                HVLIST: DB      ^5 "VLIS" ^'T'                          ; ***** VLIST
9BFF C9 9B                                                    DW      HINDEX
9C01 4C 8A FF 84 80 00 DC 8B 10 8A 01 8C EB 89 EB 89  VLIST:  DW      DOCOL LIT 128 OUT STORE CONT AT AT
9C11 DC 8B EB 89 FF 84 50 00 E1 8C 43 85 0A 00        VLIS10: DW      OUT AT LIT 80 GREAT ZBRAN +VLIS20
9C1F 61 87 F6 8A DC 8B 10 8A                                  DW      CR ZERO OUT STORE
9C27 AA 89 DB 92 03 8D 03 8D 92 8D 5E 8D EB 89        VLIS20: DW      DUP IDDOT SPACE SPACE PFA LFA AT
9C35 AA 89 E0 88 4B 87 E7 87 43 85 D2 FF                      DW      DUP ZEQU QTERM OR ZBRAN +VLIS10
9C41 87 89 85 88                                              DW      DROP SEMIS
                                                      
9C45 C5 3B 43 4F 44 C5                                HSCODE: DB      ^^5 ";COD" ^'E'                         ; ***** ;CODE
9C4B F9 9B                                                    DW      HVLIST
9C4D 4C 8A 16 8E 4D 8E D8 8E 63 8E 86 8E 85 88        SCODE:  DW      DOCOL QCSP COMP PSCOD LBRAC SMUDG SEMIS
                                                      
9C5B C5 46 4F 52 54 C8                                HFORTH: DB      ^^5 "FORT" ^'H'                         ; ***** FORTH
9C61 45 9C                                                    DW      HSCODE
9C63 0C 8F 8C 94 81 A0 5B 9C                          FORTH:  DW      DODOE DOVOC 0xA081 HFORTH
9C6B 00 00                                            XXVOC:  DW      0
                                                      
9C6D 00                                               XDP:    DB      0
                                                      
                                                      ; INCLUDE         uppermem.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; UPPER MEMORY AREA
                                                      
                                                              ORG     0xF5B9
                                                      
F5B9 00                                               XSP:    DB      0
F5BA 00                                               XTIB:   DB      0
                                                              DS      210             ; TIB:      84
F68D 00                                               XRP:    DB      0               ; RSTACK:  128
F68E 00                                               XUP:    DB      0
                                                              DS      80              ; Room for 40 variables
F6DF 00                                               DSKBF:  DB      0
                                                              DS      2055            ; 2 * 1028 bytes
FEE7 00                                               ENDBF:  DB      0
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; THE VIRTUAL FORTH MACHINE REGISTERS
                                                      
                                                      IP:                             ; Instruction Pointer
FEE8 00                                               IP.0:   DB      0
FEE9 00                                               IP.1:   DB      0
                                                      
                                                      WA:                             ; Word Address Register
FEEA 00                                               WA.0:   DB      0
FEEB 00                                               WA.1:   DB      0
                                                      
                                                      SP:                             ; Data stack pointer
FEEC 00                                               SP.0:   DB      0
FEED 00                                               SP.1:   DB      0
                                                      
                                                      RP:                             ; Return stack pointer
FEEE 00                                               RP.0:   DB      0
FEEF 00                                               RP.1:   DB      0
                                                      
                                                      UP:                             ; User area pointer
FEF0 00                                               UP.0:   DB      0
FEF1 00                                               UP.1:   DB      0
                                                      
                                                      R1:                             ; Working register R1
FEF2 00                                               R1.0:   DB      0
FEF3 00                                               R1.1:   DB      0
                                                      R1H:
FEF4 00                                               R1.2:   DB      0
FEF5 00                                               R1.3:   DB      0
                                                      
                                                      R2:                             ; Working register R2
FEF6 00                                               R2.0:   DB      0
FEF7 00                                               R2.1:   DB      0
                                                      R2H:
FEF8 00                                               R2.2:   DB      0
FEF9 00                                               R2.3:   DB      0
                                                      
                                                      R3:                             ; Working register R3
FEFA 00                                               R3.0:   DB      0
FEFB 00                                               R3.1:   DB      0
                                                      R3H:
FEFC 00                                               R3.2:   DB      0
FEFD 00                                               R3.3:   DB      0
                                                      
FEFE 00                                               BC:     DB      0               ; "Hidden" registers
FEFF 00                                               TMP:    DB      0               ; (used by _AND8 _OR8 _XOR8)
