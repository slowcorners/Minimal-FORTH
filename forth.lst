                                                      ; ----------------------------------------------------------------------
                                                      ; M i n i m a l - F O R T H
                                                      ;
                                                      ; A minimal FORTH for the Minimal-CPU.
                                                      ;
                                                      ; Date:         2021-03-24
                                                      ; Version:      0.1
                                                      ; Adaptation:   Nils "slowcorners" Kullberg
                                                      ; License:      MIT Open Source Initiative
                                                      ;
                                                      ;
                                                      ; FIG-FORTH WAS ORIGINALLY DEVELOPED BY:
                                                      ; FORTH INTEREST GROUP / FORTH IMPLEMENTATION TEAM
                                                      ; P.O.BOX 1105
                                                      ; SAN CARLOS, CA. 94701
                                                      ;
                                                      ; THIS COMPILER EXISTS THANKS TO ALL THE WONDERFUL PEOPLE OF THE
                                                      ; FORTH INTEREST GROUP. IT IS THEIR DEDICATION AND GENEROSITY WHICH
                                                      ; STILL TODAY MAKES THESE NEW ADAPTATIONS POSSIBLE.
                                                      ;
                                                      ; MAY THIS COMPILER BE A SMALL TRIBUTE TO ALL THOSE INDIVIDUALS OF THE
                                                      ; FORTH INTEREST GROUP AS WELL AS SLU4 WHOSE COUNTLESS HOURS AND
                                                      ; INGENIOUS DETAILS HAVE MADE THE MINIMAL-CPU COME INTO EXISTENCE.
                                                      ;
                                                      ; NILS "SLOWCORNERS" KULLBERG
                                                      ; LUND, SWEDEN
                                                      ; MARCH 2021, IN THE MIDDLE OF THE COVID-19 PANDEMIC
                                                      ;
                                                      ; ----------------------------------------------------------------------
                                                      
                                                              ORG     0x8000
                                                              
                                                      
                                                      ; INCLUDE         defs.asm
                                                      
                                                      CH_BEL  EQU     7
                                                      CH_BSP  EQU     8
                                                      CH_LF   EQU     10
                                                      CH_CR   EQU     13
                                                      CH_ESC  EQU     27
                                                      CH_BL   EQU     32
                                                      CH_DEL  EQU     127
                                                      
                                                      ; INCLUDE         boot-table.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; BOOT TABLE
                                                      
8000 14 40 97                                         ORIGIN: JPA     CENT            ;  0: COLD start
8003 00                                                       NOP
8004 14 52 97                                                 JPA     WENT            ;  4: WARM start
8007 00                                                       NOP
8008 00 00                                                    DW      0               ;  8: Processor type in radix 36
800A 00 00                                                    DW      0               ; 10: Revision
800C ED 9E                                                    DW      HFORTH          ; 12: Pointer to latest word defined
800E 08 00                                                    DW      CH_BSP          ; 14: Backspace character
8010 8E F6                                                    DW      XUP             ; 16: Pointer to initial user area
8012 B9 F5                                                    DW      XSP             ; 18: Initial data stack pointer
8014 8D F6                                                    DW      XRP             ; 20: Initial return stack pointer
8016 BA F5                                                    DW      XTIB            ; 22: Pointer to terminal input buffer
8018 1F 00                                                    DW      31              ; 24: Maximum FORTH word name length
801A 00 00                                                    DW      0               ; 26: Initial WARNING mode
801C FF 9E                                                    DW      XDP             ; 28: Initial FENCE
801E FF 9E                                                    DW      XDP             ; 30: Initial HERE
8020 FD 9E                                                    DW      XXVOC           ; 32: Pointer to initial VOC-LINK
8022 DF F6                                                    DW      DSKBF           ; 34: Initial FIRST
8024 E7 FE                                                    DW      ENDBF           ; 36: Initial LIMIT
8026 00 00                                                    DW      0               ; 38: unused
8028 00 00                                                    DW      0               ; 40: unused
                                                      
                                                      ; INCLUDE         helpers.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; HELPER FUNCTIONS
                                                      ;
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (IP)+
                                                      
802A 1D E8 FE                                         _LIT:   LDR     IP
802D 16 F2 FE                                                 STA     R1.0
8030 2E E8 FE                                                 INW     IP
8033 1D E8 FE                                                 LDR     IP
8036 16 F3 FE                                                 STA     R1.1
8039 2E E8 FE                                                 INW     IP
803C 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       IP = IP + (IP)+
                                                      
803D 1D E8 FE                                         _BRAN:  LDR     IP
8040 16 F2 FE                                                 STA     R1.0
8043 2E E8 FE                                                 INW     IP
8046 1D E8 FE                                                 LDR     IP
8049 16 F3 FE                                                 STA     R1.1
804C 2F E8 FE                                                 DEW     IP
804F 15 F2 FE                                                 LDA     R1.0
8052 28 E8 FE                                                 ADB     IP.0
8055 15 F3 FE                                                 LDA     R1.1
8058 2A E9 FE                                                 ACB     IP.1
805B 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (SP) "half function"
                                                      
805C 1D EC FE                                         _GET1_: LDR     SP
805F 16 F2 FE                                                 STA     R1.0
8062 2E EC FE                                                 INW     SP
8065 1D EC FE                                                 LDR     SP
8068 16 F3 FE                                                 STA     R1.1
806B 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (SP)
                                                      
806C 38 5C 80                                         _GET1:  JPS     _GET1_
806F 2F EC FE                                                 DEW     SP
8072 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (SP)+
                                                      
8073 38 5C 80                                         _POP1:  JPS     _GET1_
8076 2E EC FE                                                 INW     SP
8079 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1X = (SP)+
                                                      
807A 1D EC FE                                         _DPOP1: LDR     SP
807D 16 F4 FE                                                 STA     R1.2
8080 2E EC FE                                                 INW     SP
8083 1D EC FE                                                 LDR     SP
8086 16 F5 FE                                                 STA     R1.3
8089 2E EC FE                                                 INW     SP
808C 1D EC FE                                                 LDR     SP
808F 16 F2 FE                                                 STA     R1.0
8092 2E EC FE                                                 INW     SP
8095 1D EC FE                                                 LDR     SP
8098 16 F3 FE                                                 STA     R1.1
809B 2E EC FE                                                 INW     SP
809E 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R2 = (SP) "half function"
                                                      
809F 1D EC FE                                         _GET2_: LDR     SP
80A2 16 F6 FE                                                 STA     R2.0
80A5 2E EC FE                                                 INW     SP
80A8 1D EC FE                                                 LDR     SP
80AB 16 F7 FE                                                 STA     R2.1
80AE 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R2 = (SP)
                                                      
80AF 38 9F 80                                         _GET2:  JPS     _GET2_
80B2 2F EC FE                                                 DEW     SP
80B5 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (SP)+
                                                      
80B6 38 9F 80                                         _POP2:  JPS     _GET2_
80B9 2E EC FE                                                 INW     SP
80BC 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R2X = (SP)+
                                                      
80BD 1D EC FE                                         _DPOP2: LDR     SP
80C0 16 F8 FE                                                 STA     R2.2
80C3 2E EC FE                                                 INW     SP
80C6 1D EC FE                                                 LDR     SP
80C9 16 F9 FE                                                 STA     R2.3
80CC 2E EC FE                                                 INW     SP
80CF 1D EC FE                                                 LDR     SP
80D2 16 F6 FE                                                 STA     R2.0
80D5 2E EC FE                                                 INW     SP
80D8 1D EC FE                                                 LDR     SP
80DB 16 F7 FE                                                 STA     R2.1
80DE 2E EC FE                                                 INW     SP
80E1 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R3 = (SP) "half function"
                                                      
80E2 1D EC FE                                         _GET3_: LDR     SP
80E5 16 FA FE                                                 STA     R3.0
80E8 2E EC FE                                                 INW     SP
80EB 1D EC FE                                                 LDR     SP
80EE 16 FB FE                                                 STA     R3.1
80F1 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R3 = (SP)
                                                      
80F2 38 E2 80                                         _GET3:  JPS     _GET3_
80F5 2F EC FE                                                 DEW     SP
80F8 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R3 = (SP)+
                                                      
80F9 38 E2 80                                         _POP3:  JPS     _GET3_
80FC 2E EC FE                                                 INW     SP
80FF 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R3 = (SP)+
                                                      ;       R2 = (SP)+
                                                      ;       R1 = (SP)+
                                                      
8100 38 F9 80                                         _POP321: JPS    _POP3
8103 38 B6 80                                         _POP21: JPS     _POP2
8106 38 73 80                                                 JPS     _POP1
8109 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (RP) "half function"
                                                      
810A 1D EE FE                                         _RGET1_: LDR    RP
810D 16 F2 FE                                                 STA     R1.0
8110 2E EE FE                                                 INW     RP
8113 1D EE FE                                                 LDR     RP
8116 16 F3 FE                                                 STA     R1.1
8119 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (RP)
                                                      
811A 38 0A 81                                         _RGET1: JPS     _RGET1_
811D 2F EE FE                                                 DEW     RP
8120 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (RP)+
                                                      
8121 38 0A 81                                         _RPOP1: JPS     _RGET1_
8124 2E EE FE                                                 INW     RP
8127 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R2 = (RP) "half function"
                                                      
8128 1D EE FE                                         _RGET2_: LDR    RP
812B 16 F6 FE                                                 STA     R2.0
812E 2E EE FE                                                 INW     RP
8131 1D EE FE                                                 LDR     RP
8134 16 F7 FE                                                 STA     R2.1
8137 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R2 = (RP)
                                                      
8138 38 28 81                                         _RGET2: JPS     _RGET2_
813B 2F EE FE                                                 DEW     RP
813E 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (RP)
                                                      
813F 38 28 81                                         _RPOP2: JPS     _RGET2_
8142 2E EE FE                                                 INW     RP
8145 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R3 = (RP) "half function"
                                                      
8146 1D EE FE                                         _RGET3_: LDR    RP
8149 16 FA FE                                                 STA     R3.0
814C 2E EE FE                                                 INW     RP
814F 1D EE FE                                                 LDR     RP
8152 16 FB FE                                                 STA     R3.1
8155 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R3 = (RP)
                                                      
8156 38 46 81                                         _RGET3: JPS     _RGET3_
8159 2F EE FE                                                 DEW     RP
815C 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R3 = (RP)
                                                      
815D 38 46 81                                         _RPOP3: JPS     _RGET3_
8160 2E EE FE                                                 INW     RP
8163 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (SP) = R1 "half function"
                                                      
8164 15 F3 FE                                         _PUT1_: LDA     R1.1
8167 1E EC FE                                                 STR     SP
816A 2F EC FE                                                 DEW     SP
816D 15 F2 FE                                                 LDA     R1.0
8170 1E EC FE                                                 STR     SP
8173 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (SP) = R1
                                                      
8174 2E EC FE                                         _PUT1:  INW     SP
8177 38 64 81                                                 JPS     _PUT1_
817A 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       -(SP) = R1
                                                      
817B 2F EC FE                                         _PUSH1: DEW     SP
817E 38 64 81                                                 JPS     _PUT1_
8181 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (SP) = R2 "half function"
                                                      
8182 15 F7 FE                                         _PUT2_: LDA     R2.1
8185 1E EC FE                                                 STR     SP
8188 2F EC FE                                                 DEW     SP
818B 15 F6 FE                                                 LDA     R2.0
818E 1E EC FE                                                 STR     SP
8191 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (SP) = R2
                                                      
8192 2E EC FE                                         _PUT2:  INW     SP
8195 38 82 81                                                 JPS     _PUT2_
8198 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       -(SP) = R2
                                                      
8199 2F EC FE                                         _PUSH2: DEW     SP
819C 38 82 81                                                 JPS     _PUT2_
819F 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (SP) = R3 "half function"
                                                      
81A0 15 FB FE                                         _PUT3_: LDA     R3.1
81A3 1E EC FE                                                 STR     SP
81A6 2F EC FE                                                 DEW     SP
81A9 15 FA FE                                                 LDA     R3.0
81AC 1E EC FE                                                 STR     SP
81AF 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (SP) = R3
                                                      
81B0 2E EC FE                                         _PUT3:  INW     SP
81B3 38 A0 81                                                 JPS     _PUT3_
81B6 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       -(SP) = R3
                                                      
81B7 2F EC FE                                         _PUSH3: DEW     SP
81BA 38 A0 81                                                 JPS     _PUT3_
81BD 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (RP) = R1 "half function"
                                                      
81BE 15 F3 FE                                         _RPUT1_: LDA    R1.1
81C1 1E EE FE                                                 STR     RP
81C4 2F EE FE                                                 DEW     RP
81C7 15 F2 FE                                                 LDA     R1.0
81CA 1E EE FE                                                 STR     RP
81CD 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (RP) = R1
                                                      
81CE 2E EE FE                                         _RPUT1: INW     RP
81D1 38 BE 81                                                 JPS     _RPUT1_
81D4 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       -(RP) = R1
                                                      
81D5 2F EE FE                                         _RPUSH1: DEW    RP
81D8 38 BE 81                                                 JPS     _RPUT1_
81DB 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (RP) = R2 "half function"
                                                      
81DC 15 F7 FE                                         _RPUT2_: LDA    R2.1
81DF 1E EE FE                                                 STR     RP
81E2 2F EE FE                                                 DEW     RP
81E5 15 F6 FE                                                 LDA     R2.0
81E8 1E EE FE                                                 STR     RP
81EB 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (RP) = R2
                                                      
81EC 2E EE FE                                         _RPUT2: INW     RP
81EF 38 DC 81                                                 JPS     _RPUT2_
81F2 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       -(RP) = R2
                                                      
81F3 2F EE FE                                         _RPUSH2: DEW    RP
81F6 38 DC 81                                                 JPS     _RPUT2_
81F9 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (RP) = R3 "half function"
                                                      
81FA 15 FB FE                                         _RPUT3_: LDA    R3.1
81FD 1E EE FE                                                 STR     RP
8200 2F EE FE                                                 DEW     RP
8203 15 FA FE                                                 LDA     R3.0
8206 1E EE FE                                                 STR     RP
8209 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (RP) = R3
                                                      
820A 2E EE FE                                         _RPUT3: INW     RP
820D 38 FA 81                                                 JPS     _RPUT3_
8210 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       -(RP) = R3
                                                      
8211 2F EE FE                                         _RPUSH3: DEW    RP
8214 38 FA 81                                                 JPS     _RPUT3_
8217 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = R1 + R2
                                                      
8218 15 F2 FE                                         _ADD16: LDA     R1.0
821B 17 F6 FE                                                 ADA     R2.0
821E 16 F2 FE                                                 STA     R1.0
8221 15 F3 FE                                                 LDA     R1.1
8224 1A F7 FE                                                 ACA     R2.1
8227 16 F3 FE                                                 STA     R1.1
822A 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1X = R1X + R2X
                                                      
822B 15 F2 FE                                         _ADD32: LDA     R1.0
822E 17 F6 FE                                                 ADA     R2.0
8231 16 F2 FE                                                 STA     R1.0
8234 15 F3 FE                                                 LDA     R1.1
8237 1A F7 FE                                                 ACA     R2.1
823A 16 F3 FE                                                 STA     R1.1
823D 15 F4 FE                                                 LDA     R1.2
8240 1A F8 FE                                                 ACA     R2.2
8243 16 F4 FE                                                 STA     R1.2
8246 15 F5 FE                                                 LDA     R1.3
8249 1A F9 FE                                                 ACA     R2.3
824C 16 F5 FE                                                 STA     R1.3
824F 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (R1)
                                                      
8250 1D F2 FE                                         _AT:    LDR     R1              ; Get LSB
8253 16 F4 FE                                                 STA     R1.2            ; ... Store temp
8256 2E F2 FE                                                 INW     R1              ; Bump
8259 1D F2 FE                                                 LDR     R1              ; Get MSB
825C 16 F5 FE                                                 STA     R1.3            ; ... Store temp
825F 15 F4 FE                                                 LDA     R1.2            ; Get temp LSB
8262 16 F2 FE                                                 STA     R1.0            ; ... Store
8265 15 F5 FE                                                 LDA     R1.3            ; Get temp MSB
8268 16 F3 FE                                                 STA     R1.1            ; ... Store
826B 39                                                       RTS                     ; Done
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = (R3)
                                                      
826C 1D FA FE                                         _LD16:  LDR     R3
826F 16 F2 FE                                                 STA     R1.0
8272 2E FA FE                                                 INW     R3
8275 1D FA FE                                                 LDR     R3
8278 16 F3 FE                                                 STA     R1.1
827B 2F FA FE                                                 DEW     R3
827E 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       (R3) = R1
                                                      
827F 15 F2 FE                                         _ST16:  LDA     R1.0
8282 1E FA FE                                                 STR     R3
8285 2E FA FE                                                 INW     R3
8288 15 F3 FE                                                 LDA     R1.1
828B 1E FA FE                                                 STR     R3
828E 2F FA FE                                                 DEW     R3
8291 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1.0 = R1.0 & R2.0
                                                      
8292 0E 08                                            _AND8:  LDI     8               ; Load bit counter
8294 16 FE FE                                                 STA     BC              ; :
8297 15 F6 FE                                         _AND81: LDA     R2.0            ; Load second operand
829A 05                                                       LSL                     ; Shift 2b7 into C
829B 16 F6 FE                                                 STA     R2.0            ; Store shifted second operand
829E 15 F2 FE                                                 LDA     R1.0            ; Load first operand
82A1 3C AA 82                                                 BCC     _AND82          ; If C is clear: Shift in a zero
                                                              ; 2b7 is set
82A4 11 00                                                    CPI     0               ; Is first operand < 0, i.e. is 1b7 set?
82A6 3F AA 82                                                 BMI     _AND82           ; N is set: 1b7 is set
                                                              ; 1b7 is clear
82A9 03                                                       CLC                     ; 1b7 is clear: Clear C
82AA 06                                               _AND82: ROL                     ; Shift C into result
82AB 16 F2 FE                                                 STA     R1.0            ; Store first operand/result
82AE 27 FE FE                                                 DEB     BC              ; All bits done?
82B1 3A 97 82                                                 BNE     _AND81          ;   NO: Do one more
82B4 39                                                       RTS                     ;   YES: All done
                                                      
                                                      ; ------------------------------
                                                      ;       R1.0 = R1.0 | R2.0
                                                      
82B5 0E 08                                            _OR8:   LDI     8               ; Load bit counter
82B7 16 FE FE                                                 STA     BC              ; :
82BA 15 F6 FE                                         _OR810: LDA     R2.0            ; Load second operand
82BD 05                                                       LSL                     ; Shift 2b7 into C
82BE 16 F6 FE                                                 STA     R2.0            ; Store shifted second operand
82C1 15 F2 FE                                                 LDA     R1.0            ; Load first operand
82C4 3D CD 82                                                 BCS     _OR820          ; If C is set, shift it into result
                                                              ; 2b7 is clear
82C7 11 00                                                    CPI     0               ; Is first operand < 0, i.e. is 1b7 set?
82C9 3F CD 82                                                 BMI     _OR820          ; N is clear: 1b7 is clear
                                                              ; 1b7 is clear
82CC 03                                                       CLC                     ; Neither bit is set: Clear C 
82CD 06                                               _OR820: ROL                     ; Shift C into result
82CE 16 F2 FE                                                 STA     R1.0            ; Store first operand/result
82D1 27 FE FE                                                 DEB     BC              ; All bits done?
82D4 3A BA 82                                                 BNE     _OR810          ;   NO: Do one more
82D7 39                                                       RTS                     ;   YES: All done
                                                      
                                                      ; ------------------------------
                                                      ;       R1.0 = R1.0 ^ R2.0
                                                      
82D8 0E 08                                            _XOR8:  LDI     8               ; Load bit counter
82DA 16 FE FE                                                 STA     BC              ; :
82DD 15 F6 FE                                         _XOR81: LDA     R2.0            ; Get second operand
82E0 05                                                       LSL                     ; Shift b7 into C
82E1 16 F6 FE                                                 STA     R2.0            ; Store shifted second operand
82E4 15 F2 FE                                                 LDA     R1.0            ; Load first operand
82E7 3D F2 82                                                 BCS     _XOR82          ; C is set, check 1b7 for zero
                                                              ; 2b7 is clear
82EA 11 00                                                    CPI     0               ; Is first operand < 0, i.e. is b7 set?
82EC 3F F8 82                                                 BMI     _XOR84          ; 1b7 is set and 2b7 is clear, shift in C which is set
82EF 14 F7 82                                                 JPA     _XOR83          ; 1b7 and 2b7 are both zero, clear C and shift in 
                                                              ; 2b7 is set, check 1b7 for zero
82F2 11 00                                            _XOR82: CPI     0
82F4 3E F8 82                                                 BPL     _XOR84          ; If 1b7 is zero, shift in C which is set
82F7 03                                               _XOR83: CLC                     ; 1b7 and 2b7 are equal, shift in a zero
82F8 06                                               _XOR84: ROL                     ; Shift whatever is in C into result
82F9 16 F2 FE                                                 STA     R1.0            ; Store first operand/result
82FC 27 FE FE                                                 DEB     BC              ; All bits done?
82FF 3A DD 82                                                 BNE     _XOR81          ;   NO: Do one more
8302 39                                                       RTS                     ;   YES: All done
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = ~R1
                                                      
8303 15 F5 FE                                         _NOT32: LDA     R1.3            ; Negate MSB
8306 0B                                                       NEG                     ; Two-complement negation
8307 10 01                                                    SBI     1               ; Adjust to bitwise not
8309 16 F5 FE                                                 STA     R1.3            ; Store negated MSB
830C 15 F4 FE                                                 LDA     R1.2            ; Negate byte2
830F 0B                                                       NEG                     ; Two-complement negation
8310 10 01                                                    SBI     1               ; Adjust to bitwise not
8312 16 F4 FE                                                 STA     R1.2            ; Store negated byte2
8315 15 F3 FE                                         _NOT16: LDA     R1.1            ; Negate byte1
8318 0B                                                       NEG                     ; Two-complement negation
8319 10 01                                                    SBI     1               ; Adjust to bitwise not
831B 16 F3 FE                                                 STA     R1.1            ; Store negated byte1
831E 15 F2 FE                                                 LDA     R1.0            ; Negate LSB
8321 0B                                                       NEG                     ; Two-complement negation
8322 10 01                                                    SBI     1               ; Adjust to bitwise not
8324 16 F2 FE                                                 STA     R1.0            ; Store negated LSB
8327 39                                                       RTS                     ; Done
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = -R1
                                                      
8328 38 15 83                                         _NEG16: JPS     _NOT16          ; Bitwise NOT R1
832B 15 F2 FE                                                 LDA     R1.0            ; Add one to make it 2-complement
832E 0F 01                                                    ADI     1               ; :
8330 16 F2 FE                                                 STA     R1.0            ; :
8333 15 F3 FE                                                 LDA     R1.1            ; :
8336 12 00                                                    ACI     0               ; :
8338 16 F3 FE                                                 STA     R1.1            ; :
833B 39                                                       RTS                     ; Done
                                                      
                                                      ; ------------------------------
                                                      ;       R1X = -R1X
                                                      
833C 38 03 83                                         _NEG32: JPS     _NOT32          ; Bitwise NOT R1X
833F 15 F2 FE                                                 LDA     R1.0            ; Add one to make it 2-complement
8342 0F 01                                                    ADI     1               ; :
8344 16 F2 FE                                                 STA     R1.0            ; :
8347 15 F3 FE                                                 LDA     R1.1            ; :
834A 12 00                                                    ACI     0               ; :
834C 16 F3 FE                                                 STA     R1.1            ; :
834F 15 F4 FE                                                 LDA     R1.2            ; :
8352 12 00                                                    ACI     0               ; :
8354 16 F4 FE                                                 STA     R1.2            ; :
8357 15 F5 FE                                                 LDA     R1.3            ; :
835A 12 00                                                    ACI     0               ; :
835C 16 F5 FE                                                 STA     R1.3            ; :
835F 39                                                       RTS                     ; Done
                                                      
                                                      ; ------------------------------
                                                      ;       R1 <-> R2
                                                      
8360 38 7B 81                                         _XCH16: JPS     _PUSH1          ; Temp = R1
8363 15 F6 FE                                                 LDA     R2.0            ; R1 = R2
8366 16 F2 FE                                                 STA     R1.0            ; :
8369 15 F7 FE                                                 LDA     R2.1            ; :
836C 16 F3 FE                                                 STA     R1.1            ; :
836F 38 B6 80                                                 JPS     _POP2           ; R2 = Temp
8372 39                                                       RTS                     ; Done
                                                      
                                                      ; ------------------------------
                                                      ;       +ORIGIN
                                                      ; NOTE: Index number in R2
                                                      
8373 0E 00                                            _PORIG: LDI     <ORIGIN         ; R3 = ORIGIN address
8375 16 FA FE                                                 STA     R3.0            ; :
8378 0E 80                                                    LDI     >ORIGIN         ; :
837A 16 FB FE                                                 STA     R3.1            ; :
837D 15 F6 FE                                                 LDA     R2.0            ; Get index number
8380 30 FA FE                                                 ADW     R3              ; Compute addr
8383 39                                                       RTS                     ; Done
                                                      
                                                      ; ------------------------------
                                                      ;       _USER
                                                      ; NOTE: Index number in R2
                                                      
8384 15 F0 FE                                         _USER:  LDA     UP.0            ; R3 = UP
8387 16 FA FE                                                 STA     R3.0            ; :
838A 15 F1 FE                                                 LDA     UP.1            ; :
838D 16 FB FE                                                 STA     R3.1            ; :
8390 15 F6 FE                                                 LDA     R2.0            ; Get index number
8393 30 FA FE                                                 ADW     R3              ; Compute addr
8396 39                                                       RTS                     ; Done
                                                      
                                                      ; ------------------------------
                                                      ;       _PICK
                                                      ; NOTE: Index number on Minimal stack
                                                      
8397 15 EC FE                                         _PICK:  LDA     SP.0            ; R3 = SP
839A 16 FA FE                                                 STA     R3.0            ; :
839D 15 ED FE                                                 LDA     SP.1            ; :
83A0 16 FB FE                                                 STA     R3.1            ; :
83A3 34 03                                                    LDS     3               ; Get index number
83A5 05                                                       LSL                     ; : word index --> byte index
83A6 30 FA FE                                                 ADW     R3              ; Compute addr
83A9 38 6C 82                                                 JPS     _LD16           ; Get the n:th word from stack
83AC 39                                                       RTS                     ; Done
                                                      
                                                      ; ------------------------------
                                                      ;       _ROLL
                                                      ; NOTE: Index number on Minimal stack
                                                      
83AD 34 03                                            _ROLL:  LDS     3               ; Get index number
83AF 16 FD FE                                                 STA     R3.3            ; Prepare loop counter
83B2 36                                                       PHS                     ; Push as parameter for _PICK
83B3 38 97 83                                                 JPS     _PICK           ; Pick n:th element in R1
83B6 37                                                       PLS                     ; Cleanup stack
                                                              ; Set up source pointer (R2) for move
83B7 15 FA FE                                                 LDA     R3.0            ; :
83BA 16 F6 FE                                                 STA     R2.0            ; :
83BD 15 FB FE                                                 LDA     R3.1            ; :
83C0 16 F7 FE                                                 STA     R2.1            ; :
83C3 2F F6 FE                                                 DEW     R2              ; :
83C6 2F F6 FE                                                 DEW     R2              ; :
                                                              ; All moved already?
83C9 15 FD FE                                         _ROL10: LDA     R3.3            ; Get loop counter
83CC 11 00                                                    CPI     0               ; Zero?
83CE 3B F3 83                                                 BEQ     _ROL99          ; YES: We are done
                                                              ; Move one word down in the stack
83D1 1D F6 FE                                                 LDR     R2              ; Move word
83D4 1E FA FE                                                 STR     R3              ; :
83D7 2E F6 FE                                                 INW     R2              ; :
83DA 2E FA FE                                                 INW     R3              ; :
83DD 1D F6 FE                                                 LDR     R2              ; :
83E0 1E FA FE                                                 STR     R3              ; :
                                                              ; Bump pointers upwards in the stack
83E3 0E 03                                                    LDI     3               ; :
83E5 31 F6 FE                                                 SBW     R2              ; :
83E8 0E 03                                                    LDI     3               ; :
83EA 31 FA FE                                                 SBW     R3              ; :
                                                              ; Decrement counter
83ED 27 FD FE                                                 DEB     R3.3            ; Decrement loop counter
83F0 14 C9 83                                                 JPA     _ROL10          ; Go for another round
                                                              ; All done
83F3 38 74 81                                         _ROL99: JPS     _PUT1           ; Replace top of stack with R1
83F6 39                                                       RTS                     ; :
                                                      
                                                      ; ------------------------------
                                                      ;       _SWAP8
                                                      ; Swaps R1.1 <-> R1.0
                                                      ;       R2.1 <-> R2.0
                                                      
83F7 15 F2 FE                                         _SWAP8: LDA     R1.0
83FA 16 FF FE                                                 STA     TMP
83FD 15 F3 FE                                                 LDA     R1.1
8400 16 F2 FE                                                 STA     R1.0
8403 15 FF FE                                                 LDA     TMP
8406 16 F3 FE                                                 STA     R1.1
8409 15 F6 FE                                                 LDA     R2.0
840C 16 FF FE                                                 STA     TMP
840F 15 F7 FE                                                 LDA     R2.1
8412 16 F6 FE                                                 STA     R2.0
8415 15 FF FE                                                 LDA     TMP
8418 16 F7 FE                                                 STA     R2.1
841B 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = R1 & R2
                                                      
841C 38 92 82                                         _AND16: JPS     _AND8
841F 38 F7 83                                                 JPS     _SWAP8
8422 38 92 82                                                 JPS     _AND8
8425 38 F7 83                                                 JPS     _SWAP8
8428 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = R1 | R2
                                                      
8429 38 B5 82                                         _OR16:  JPS     _OR8
842C 38 F7 83                                                 JPS     _SWAP8
842F 38 B5 82                                                 JPS     _OR8
8432 38 F7 83                                                 JPS     _SWAP8
8435 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1 = R1 ^ R2
                                                      
8436 38 D8 82                                         _XOR16: JPS     _XOR8
8439 38 F7 83                                                 JPS     _SWAP8
843C 38 D8 82                                                 JPS     _XOR8
843F 38 F7 83                                                 JPS     _SWAP8
8442 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R3X = R1X * R2X
                                                      
8443 0E 10                                            _UMULT: LDI     16              ; Set bit counter
8445 16 FE FE                                                 STA     BC
8448 0E 00                                                    LDI     0               ; R3X = 0
844A 16 FA FE                                                 STA     R3.0            ; :
844D 16 FB FE                                                 STA     R3.1            ; :
8450 16 FC FE                                                 STA     R3.2            ; :
8453 16 FD FE                                                 STA     R3.3            ; :
8456 16 F4 FE                                                 STA     R1.2            ; R1H = 0
8459 16 F5 FE                                                 STA     R1.3            ; :
845C 15 F7 FE                                         _UMU10: LDA     R2.1            ; R2 >> 1
845F 07                                                       LSR                     ; :
8460 16 F7 FE                                                 STA     R2.1            ; :
8463 15 F6 FE                                                 LDA     R2.0            ; :
8466 08                                                       ROR                     ; :
8467 16 F6 FE                                                 STA     R2.0            ; :
846A 3C 91 84                                                 BCC     _UMU20          ; No carry, no add
846D 15 FA FE                                                 LDA     R3.0            ; R3X = R3X + R1X
8470 17 F2 FE                                                 ADA     R1.0            ; :
8473 16 FA FE                                                 STA     R3.0            ; :
8476 15 FB FE                                                 LDA     R3.1            ; :
8479 1A F3 FE                                                 ACA     R1.1            ; :
847C 16 FB FE                                                 STA     R3.1            ; :
847F 15 FC FE                                                 LDA     R3.2            ; :
8482 1A F4 FE                                                 ACA     R1.2            ; :
8485 16 FC FE                                                 STA     R3.2            ; :
8488 15 FD FE                                                 LDA     R3.3            ; :
848B 1A F5 FE                                                 ACA     R1.3            ; :
848E 16 FD FE                                                 STA     R3.3            ; :
8491 15 F2 FE                                         _UMU20: LDA     R1.0            ; R1X << 1
8494 05                                                       LSL                     ; :
8495 16 F2 FE                                                 STA     R1.0            ; :
8498 15 F3 FE                                                 LDA     R1.1            ; :
849B 06                                                       ROL                     ; :
849C 16 F3 FE                                                 STA     R1.1            ; :
849F 15 F4 FE                                                 LDA     R1.2            ; :
84A2 06                                                       ROL                     ; :
84A3 16 F4 FE                                                 STA     R1.2            ; :
84A6 15 F5 FE                                                 LDA     R1.3            ; :
84A9 06                                                       ROL                     ; :
84AA 16 F5 FE                                                 STA     R1.3            ; :
84AD 27 FE FE                                                 DEB     BC              ; Decrement bit counter
84B0 3A 5C 84                                                 BNE     _UMU10          ; Not zero, more bits to go
84B3 39                                                       RTS
                                                      
                                                      ; ------------------------------
                                                      ;       R1X / R2L
                                                      ;       R1H: Quotient
                                                      ;       R1L: Remainder
                                                      
84B4 0E 10                                            _UDIV:  LDI     16              ; Set bit counter
84B6 16 FE FE                                                 STA     BC              ; :
                                                              
84B9 15 F2 FE                                         _UDI10: LDA     R1.0            ; R1X = R1X << 1
84BC 05                                                       LSL                     ; :
84BD 16 F2 FE                                                 STA     R1.0            ; :
84C0 15 F3 FE                                                 LDA     R1.1            ; :
84C3 06                                                       ROL                     ; :
84C4 16 F3 FE                                                 STA     R1.1            ; :
84C7 15 F4 FE                                                 LDA     R1.2            ; :
84CA 06                                                       ROL                     ; :
84CB 16 F4 FE                                                 STA     R1.2            ; :
84CE 15 F5 FE                                                 LDA     R1.3            ; :
84D1 06                                                       ROL                     ; :
84D2 16 F5 FE                                                 STA     R1.3            ; :
                                                      
84D5 15 F4 FE                                                 LDA     R1.2            ; R3H = R1H
84D8 16 FC FE                                                 STA     R3.2            ; :
84DB 15 F5 FE                                                 LDA     R1.3            ; :
84DE 16 FD FE                                                 STA     R3.3            ; :
                                                              
84E1 15 FC FE                                                 LDA     R3.2            ; R3H = R3H - R2L
84E4 18 F6 FE                                                 SBA     R2.0            ; :
84E7 16 FC FE                                                 STA     R3.2            ; :
84EA 15 FD FE                                                 LDA     R3.3            ; :
84ED 1B F7 FE                                                 SCA     R2.1            ; :
84F0 16 FD FE                                                 STA     R3.3            ; :
                                                              
84F3 3C 05 85                                                 BCC     _UDI20
                                                              
84F6 15 FC FE                                                 LDA     R3.2            ; R1H = R3H
84F9 16 F4 FE                                                 STA     R1.2            ; :
84FC 15 FD FE                                                 LDA     R3.3            ; :
84FF 16 F5 FE                                                 STA     R1.3            ; :
                                                              
8502 2E F2 FE                                                 INW     R1.0            ; R1L++
                                                              
8505 27 FE FE                                         _UDI20: DEB     BC              ; All bits done?
8508 3A B9 84                                                 BNE     _UDI10          ; NO: Loop again
                                                              
850B 39                                                       RTS
                                                      ; INCLUDE         debug.asm
                                                      
                                                      ; INCLUDE         inner.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; INNER INTERPRETER
                                                      
850C 2F EC FE                                         IPUSH:  DEW     SP              ; -(SP) = R1H
850F 15 F5 FE                                                 LDA     R1.3
8512 1E EC FE                                                 STR     SP
8515 2F EC FE                                                 DEW     SP
8518 15 F4 FE                                                 LDA     R1.2
851B 1E EC FE                                                 STR     SP
851E 2F EC FE                                         PUSH:   DEW     SP              ; -(SP) = R1L
8521 15 F3 FE                                                 LDA     R1.1
8524 1E EC FE                                                 STR     SP
8527 2F EC FE                                                 DEW     SP
852A 15 F2 FE                                                 LDA     R1.0
852D 1E EC FE                                                 STR     SP
8530 1D E8 FE                                         NEXT:   LDR     IP              ; WA = (IP)+
8533 16 EA FE                                                 STA     WA.0
8536 2E E8 FE                                                 INW     IP
8539 1D E8 FE                                                 LDR     IP
853C 16 EB FE                                                 STA     WA.1
853F 2E E8 FE                                                 INW     IP
8542 1D EA FE                                         NEXT10: LDR     WA              ; BC/TMP = (WA)+
8545 16 FE FE                                                 STA     BC
8548 2E EA FE                                                 INW     WA
854B 1D EA FE                                                 LDR     WA
854E 16 FF FE                                                 STA     TMP
8551 2E EA FE                                                 INW     WA
                                                      ;        LDA     DBG
                                                      ;        CPI     0
                                                      ;        BEQ     NEXT11
                                                      ;        JPS     DEBUG
8554 1C FE FE                                         NEXT11: JPR     BC              ; jump @(BC/TMP)
                                                      
                                                      ; ------------------------------
                                                      ;       Push TRUE and FALSE
                                                      
8557 2C F2 FE                                         PUSHT:  CLW     R1              ; A zero
855A 2F F2 FE                                                 DEW     R1              ; Make it into a -1 i.e. TRUE flag
855D 14 1E 85                                                 JPA     PUSH
                                                      
8560 2C F2 FE                                         PUSHF:  CLW     R1              ; A zero
8563 14 1E 85                                                 JPA     PUSH
                                                      
                                                      ; ------------------------------
                                                      ;       Push R1X, MSB as TOS
                                                      
8566 2F EC FE                                         DPUSH:  DEW     SP              ; -(SP) = R1X
8569 15 F3 FE                                                 LDA     R1.1
856C 1E EC FE                                                 STR     SP
856F 2F EC FE                                                 DEW     SP
8572 15 F2 FE                                                 LDA     R1.0
8575 1E EC FE                                                 STR     SP
8578 2F EC FE                                                 DEW     SP
857B 15 F5 FE                                                 LDA     R1.3
857E 1E EC FE                                                 STR     SP
8581 2F EC FE                                                 DEW     SP
8584 15 F4 FE                                                 LDA     R1.2
8587 1E EC FE                                                 STR     SP
858A 14 30 85                                                 JPA     NEXT
                                                      
                                                      ; INCLUDE         primaries.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; FORTH PRIMARIES
                                                      ;
                                                      
858D 83 4C 49 D4                                      HLIT:   DB      ^3 "LI" ^'T'                            ; ***** LIT
8591 00 00                                                    DW      0
8593 95 85                                            LIT:    DW      LIT0
8595 38 2A 80                                         LIT0:   JPS     _LIT            ; R1 = (IP)+
8598 14 1E 85                                                 JPA     PUSH            ; -(SP) = R1; NEXT
                                                      
859B 87 45 58 45 43 55 54 C5                          HEXEC:  DB      ^7 "EXECUT" ^'E'                        ; ***** EXECUTE
85A3 8D 85                                                    DW      HLIT
85A5 A7 85                                            EXEC:   DW      EXEC0
85A7 1D EC FE                                         EXEC0:  LDR     SP              ; WA = (SP)+
85AA 16 EA FE                                                 STA     WA.0
85AD 2E EC FE                                                 INW     SP
85B0 1D EC FE                                                 LDR     SP
85B3 16 EB FE                                                 STA     WA.1
85B6 2E EC FE                                                 INW     SP
85B9 14 42 85                                                 JPA     NEXT10          ; jump @(WA)+
                                                      
85BC 86 42 52 41 4E 43 C8                             HBRAN:  DB      ^6 "BRANC" ^'H'                         ; ***** BRANCH
85C3 9B 85                                                    DW      HEXEC
85C5 C7 85                                            BRAN:   DW      BRAN0
85C7 38 3D 80                                         BRAN0:  JPS     _BRAN           ; IP = IP + (IP)
85CA 14 30 85                                                 JPA     NEXT
                                                      
85CD 87 30 42 52 41 4E 43 C8                          HZBRAN: DB      ^7 "0BRANC" ^'H'                        ; ***** 0BRANCH
85D5 BC 85                                                    DW      HBRAN
85D7 D9 85                                            ZBRAN:  DW      ZBRAN0
85D9 1D EC FE                                         ZBRAN0: LDR     SP
85DC 11 00                                                    CPI     0               ; Low byte non-zero?
85DE 3A F2 85                                                 BNE     ZBRA10          ; YES: Do not branch
85E1 2E EC FE                                                 INW     SP
85E4 1D EC FE                                                 LDR     SP
85E7 11 00                                                    CPI     0               ; High byte non-zero?
85E9 3A F5 85                                                 BNE     ZBRA20          ; YES: Do not branch
85EC 2E EC FE                                                 INW     SP
85EF 14 C7 85                                                 JPA     BRAN0           ; IP = IP + (IP); NEXT
85F2 2E EC FE                                         ZBRA10: INW     SP
85F5 2E EC FE                                         ZBRA20: INW     SP
85F8 2E E8 FE                                                 INW     IP              ; Just skip jump offset
85FB 2E E8 FE                                                 INW     IP
85FE 14 30 85                                                 JPA     NEXT
                                                      
8601 87 28 2B 4C 4F 4F 50 A9                          HXPLOO: DB      ^7 "(+LOOP" ^')'                        ; ***** (+LOOP)
8609 CD 85                                                    DW      HZBRAN
860B 0D 86                                            XPLOO:  DW      XPLOO0
860D 38 AF 80                                         XPLOO0: JPS     _GET2           ; R2 = (SP) [only copying increment]
8610 38 21 81                                                 JPS     _RPOP1          ; R1 = (RP)+
8613 38 18 82                                                 JPS     _ADD16          ; R1 = counter'
8616 38 38 81                                                 JPS     _RGET2          ; R2 = limit
8619 38 D5 81                                                 JPS     _RPUSH1         ; -(RP) = R1'
861C 38 F9 80                                                 JPS     _POP3           ; R3 = (SP)+ [now popping incr]
861F 15 FB FE                                                 LDA     R3.1            ; Is increment negative?
8622 11 00                                                    CPI     0               ; :
8624 3E 2A 86                                                 BPL     XPLO10
                                                              ; Handle negative increment
8627 38 60 83                                                 JPS     _XCH16          ; R1 <-> R2
                                                              ; Compare counter to limit
862A 15 F3 FE                                         XPLO10: LDA     R1.1            ; Compare MSB
862D 19 F7 FE                                                 CPA     R2.1            ; :
8630 3F C7 85                                                 BMI     BRAN0           ; R2 is greater, continue looping
8633 3B 39 86                                                 BEQ     XPLO20          ; MSBs are equal, check LSBs
8636 14 42 86                                                 JPA     XPLO30          ; R1 is greater, stop looping
                                                              ; MSBs are equal
8639 15 F2 FE                                         XPLO20: LDA     R1.0            ; Compare LSB
863C 19 F6 FE                                                 CPA     R2.0            
863F 3F C7 85                                                 BMI     BRAN0           ; R2 is greater, continue looping
                                                              ; Limit reached, cleanup rstack and stop looping
8642 0E 04                                            XPLO30: LDI     4               ; Drop loop counter ...
8644 30 EE FE                                                 ADW     RP              ; ... and loop limit
8647 0E 02                                                    LDI     2               ; Skip branch offset
8649 30 E8 FE                                                 ADW     IP              ; :
864C 14 30 85                                                 JPA     NEXT
                                                      
864F 86 28 4C 4F 4F 50 A9                             HXLOOP: DB      ^6 "(LOOP" ^')'                         ; ***** (LOOP)
8656 01 86                                                    DW      HXPLOO
8658 5A 86                                            XLOOP:  DW      XLOOP0
865A 2C F2 FE                                         XLOOP0: CLW     R1              ; Push a one
865D 2E F2 FE                                                 INW     R1              ; :
8660 38 7B 81                                                 JPS     _PUSH1          ; :
8663 14 0D 86                                                 JPA     XPLOO0          ; (+LOOP)
                                                      
8666 84 28 44 4F A9                                   HXDO:   DB      ^4 "(DO" ^')'                           ; ***** (DO)
866B 4F 86                                                    DW      HXLOOP
866D 6F 86                                            XDO:    DW      XDO0
866F 38 03 81                                         XDO0:   JPS     _POP21          ; Loop counter, limit
8672 38 D5 81                                                 JPS     _RPUSH1         ; Push limit onto rstack
8675 38 F3 81                                                 JPS     _RPUSH2         ; Push loop counter onto rstack
8678 14 30 85                                                 JPA     NEXT
                                                      
867B 81 C9                                            HI:     DB      ^1 ^'I'                                 ; ***** I
867D 66 86                                                    DW      HXDO
867F 81 86                                            I:      DW      I0
8681 38 1A 81                                         I0:     JPS     _RGET1          ; Get loop counter
8684 14 1E 85                                                 JPA     PUSH            ; Push it onto dstack
                                                      
8687 85 44 49 47 49 D4                                HDIGIT: DB      ^5 "DIGI" ^'T'                          ; ***** DIGIT
868D 7B 86                                                    DW      HI
868F 91 86                                            DIGIT:  DW      DIGIT0
8691 38 03 81                                         DIGIT0: JPS     _POP21          ; R2 = base, R1 = char
8694 15 F2 FE                                                 LDA     R1.0            ; Get character into A
8697 10 30                                                    SBI     '0'             ; Assume '0' - '9'
8699 3F B5 86                                                 BMI     DIGI88          ; Oops! Negative
869C 11 0A                                                    CPI     10              ; Greater than 9?
869E 3F A3 86                                                 BMI     DIGI10          ; No, it is 0 - 9
                                                              ; 'A' - 'Z' case
86A1 10 07                                                    SBI     7               ; ch -= ('A' - '0') + 10
86A3 19 F6 FE                                         DIGI10: CPA     R2.0            ; Greater than base?
86A6 3F AC 86                                                 BMI     DIGI77
86A9 14 B5 86                                                 JPA     DIGI88
86AC 16 F2 FE                                         DIGI77: STA     R1.0            ; Store binary value
86AF 38 7B 81                                                 JPS     _PUSH1          ; Push the value
86B2 14 57 85                                                 JPA     PUSHT           ; Push TRUE; NEXT
86B5 14 60 85                                         DIGI88: JPA     PUSHF           ; Push FALSE; NEXT
                                                      
86B8 86 28 46 49 4E 44 A9                             HPFIND: DB      ^6 "(FIND" ^')'                         ; ***** (FIND)
86BF 87 86                                                    DW      HDIGIT
86C1 C3 86                                            PFIND:  DW      PFIND0
86C3 38 73 80                                         PFIND0: JPS     _POP1           ; NFA
86C6 38 F9 80                                                 JPS     _POP3           ; String address
86C9 15 FA FE                                         PFIN10: LDA     R3.0            ; R2 = R3 (string address)
86CC 16 F6 FE                                                 STA     R2.0            ; :
86CF 15 FB FE                                                 LDA     R3.1            ; :
86D2 16 F7 FE                                                 STA     R2.1            ; :
                                                              ; Fast comparison of length bytes
86D5 1D F2 FE                                                 LDR     R1              ; Get lByte
86D8 16 F4 FE                                                 STA     R1.2            ; ... Store as potential result
86DB 05                                                       LSL                     ; lByte &= 0x3F
86DC 05                                                       LSL                     ; :
86DD 07                                                       LSR                     ; :
86DE 07                                                       LSR                     ; :
86DF 16 F8 FE                                                 STA     R2.2            ; R2.2 is counter for string match
86E2 21 F6 FE                                                 CPR     R2              ; lByte == string length?
86E5 3A 04 87                                                 BNE     PFIN25          ; NO: Move over to next header
                                                              ; Length bytes match, check names
86E8 2E F2 FE                                         PFIN20: INW     R1              ; Bump pointers
86EB 2E F6 FE                                                 INW     R2              ; :
86EE 1D F2 FE                                                 LDR     R1              ; Get char from dictionary
86F1 05                                                       LSL                     ; char &= 0x7F
86F2 07                                                       LSR                     ; :
86F3 21 F6 FE                                                 CPR     R2              ; Is it a match with search string?
86F6 3A 10 87                                                 BNE     PFIN30          ; NO: Look at next header in dictionary
86F9 27 F8 FE                                                 DEB     R2.2            ; YES: Decrement character counter
86FC 11 00                                                    CPI     0               ; At end of string?
86FE 3B 31 87                                                 BEQ     PFIN77          ; YES: This is the word we are looking for
8701 14 E8 86                                                 JPA     PFIN20          ; Match so far, try next char
                                                              ; Step to next header in dictionary
8704 05                                               PFIN25: LSL                     ; Eliminate potential smudge bit
8705 05                                                       LSL                     ; A = A & 0x1F
8706 05                                                       LSL                     ; lByte consists of [^ISnnnnn]
8707 07                                                       LSR                     ; :
8708 07                                                       LSR                     ; :
8709 07                                                       LSR                     ; :
870A 16 F8 FE                                                 STA     R2.2            ; : also update char counter
870D 2E F2 FE                                                 INW     R1              ; Bump NFA pointer to actual characters
8710 2E F2 FE                                         PFIN30: INW     R1              ; Bump NFA pointer
8713 27 F8 FE                                                 DEB     R2.2            ; Decrement character counter
8716 11 00                                                    CPI     0               ; End of name field?
8718 3A 10 87                                                 BNE     PFIN30          ; NO: Step to next char
871B 38 50 82                                                 JPS     _AT             ; YES: R1 = (R1)
871E 15 F3 FE                                                 LDA     R1.1            ; At end of dictionary?
8721 11 00                                                    CPI     0               ; :
8723 3A C9 86                                                 BNE     PFIN10          ; NO: Try this word for match
8726 15 F2 FE                                                 LDA     R1.0            ; :
8729 11 00                                                    CPI     0               ; :
872B 3A C9 86                                                 BNE     PFIN10          ; NO: Try this word for match
                                                              ; Word not found, return a single FALSE
872E 14 60 85                                         PFIN88: JPA     PUSHF           ; Done
                                                              ; Word found, return PFA, lByte, TRUE
8731 0E 05                                            PFIN77: LDI     5               ; Bump ptr to PFA
8733 30 F2 FE                                                 ADW     R1              ; :
8736 38 7B 81                                                 JPS     _PUSH1          ; Push PFA
8739 15 F4 FE                                                 LDA     R1.2            ; Get stored length byte
873C 16 F2 FE                                                 STA     R1.0            ; :
873F 24 F3 FE                                                 CLB     R1.1            ; Clear MSB
8742 38 7B 81                                                 JPS     _PUSH1          ; Push length byte
8745 14 57 85                                                 JPA     PUSHT           ; Done
                                                      
8748 87 45 4E 43 4C 4F 53 C5                          HENCL:  DB      ^7 "ENCLOS" ^'E'                        ; ***** ENCLOSE
8750 B8 86                                                    DW      HPFIND
8752 54 87                                            ENCL:   DW      ENCL0
8754 38 F9 80                                         ENCL0:  JPS     _POP3           ; Get delimiter char
8757 38 6C 80                                                 JPS     _GET1           ; Get addr of input
875A 2C F6 FE                                                 CLW     R2              ; Initialize char index
                                                              ; Scan preceeding delimiters
875D 1D F2 FE                                         ENCL10: LDR     R1              ; Get char from input
8760 11 00                                                    CPI     0               ; Is it <NUL>?
8762 3B 9A 87                                                 BEQ     ENCL50          ; YES: <NUL> before first non-delimiter
8765 19 FA FE                                                 CPA     R3.0            ; Is it a delimiter?
8768 3A 74 87                                                 BNE     ENCL20          ; NO: We have the start of next token
876B 2E F2 FE                                                 INW     R1              ; Bump to next char ...
876E 26 F6 FE                                                 INB     R2.0            ; ... also increase index
8771 14 5D 87                                                 JPA     ENCL10          ; Go back to look at next char
                                                              ; Start of token
8774 38 99 81                                         ENCL20: JPS     _PUSH2          ; Push result n1 (first char of token)
8777 1D F2 FE                                         ENCL30: LDR     R1              ; Get char from input
877A 11 00                                                    CPI     0               ; Is it <NUL>?
877C 3B A9 87                                                 BEQ     ENCL60          ; YES: <NUL> found
877F 19 FA FE                                                 CPA     R3.0            ; Is it a delimiter?
8782 3B 8E 87                                                 BEQ     ENCL40          ; YES: We have the end of the token
8785 2E F2 FE                                                 INW     R1              ; Bump to next char ...
8788 26 F6 FE                                                 INB     R2.0            ; ... also increase index
878B 14 77 87                                                 JPA     ENCL30          ; Go back to look at next char
                                                              ; End of token
878E 38 99 81                                         ENCL40: JPS     _PUSH2          ; Push result n2 (ending delimiter)
8791 26 F6 FE                                                 INB     R2.0            ; Also push n3 ...
8794 38 99 81                                                 JPS     _PUSH2          ; : ... (index to first non-scanned char)
8797 14 30 85                                                 JPA     NEXT            ; Done
                                                              ; <NUL> word found
879A 38 99 81                                         ENCL50: JPS     _PUSH2          ; Push i (index to <NUL>)
879D 26 F6 FE                                                 INB     R2.0            ; Push i + 1 (a null is one character long)
87A0 38 99 81                                                 JPS     _PUSH2          ; :
87A3 38 99 81                                                 JPS     _PUSH2          ; :
87A6 14 30 85                                                 JPA     NEXT            ; Done
                                                              ; Token ends with a <NUL>
87A9 38 99 81                                         ENCL60: JPS     _PUSH2          ; Push i twice to continue next round ...
87AC 38 99 81                                                 JPS     _PUSH2          ; : ... by scanning the <NUL>
87AF 14 30 85                                                 JPA     NEXT            ; Done
                                                      
87B2 84 45 4D 49 D4                                   HEMIT:  DB      ^4 "EMI" ^'T'                           ; ***** EMIT
87B7 48 87                                                    DW      HENCL
87B9 BB 87                                            EMIT:   DW      EMIT0
87BB 38 73 80                                         EMIT0:  JPS     _POP1           ; Get character
87BE 15 F2 FE                                                 LDA     R1.0            ; Send char to terminal
87C1 02                                                       OUT                     ; :
87C2 0E 22                                                    LDI     34              ; OUT++
87C4 16 F6 FE                                                 STA     R2.0            ; : R2 = Index to OUT
87C7 38 84 83                                                 JPS     _USER           ; : R3 = Addr to OUT
87CA 38 6C 82                                                 JPS     _LD16           ; : R1 = OUT
87CD 2E F2 FE                                                 INW     R1              ; : R1++
87D0 38 7F 82                                                 JPS     _ST16           ; : OUT = R1'
87D3 14 30 85                                                 JPA     NEXT            ; Done
                                                      
87D6 83 4B 45 D9                                      HKEY:   DB      ^3 "KE" ^'Y'                            ; ***** KEY
87DA B2 87                                                    DW      HEMIT
87DC DE 87                                            KEY:    DW      KEY0
87DE 0A                                               KEY0:   INP                     ; Get char form terminal
87DF 11 FF                                                    CPI     0xFF            ; Did we get a character?
87E1 3B DE 87                                                 BEQ     KEY0            ; NO: Try again
87E4 16 F2 FE                                                 STA     R1.0            ; YES: Push character
87E7 24 F3 FE                                                 CLB     R1.1            ; :
87EA 14 1E 85                                                 JPA     PUSH            ; Push R1; NEXT
                                                      
87ED 89 3F 54 45 52 4D 49 4E 41 CC                    HQTERM: DB      ^9 "?TERMINA" ^'L'                      ; ***** ?TERMINAL
87F7 D6 87                                                    DW      HKEY
87F9 FB 87                                            QTERM:  DW      QTERM0
87FB 2C F2 FE                                         QTERM0: CLW     R1              ; Default FALSE to return
87FE 0A                                                       INP                     ; Get char from terminal
87FF 11 FF                                                    CPI     0xFF            ; Did we get a character?
8801 3B 07 88                                                 BEQ     QTER10          ; NO: Return FALSE
8804 2F F2 FE                                                 DEW     R1              ; Make default FALSE into TRUE
8807 14 1E 85                                         QTER10: JPA     PUSH            ; Push R1; NEXT
                                                      
880A 85 43 4D 4F 56 C5                                HCMOVE: DB      ^5 "CMOV" ^'E'                          ; ***** CMOVE
8810 ED 87                                                    DW      HQTERM
8812 14 88                                            CMOVE:  DW      CMOVE0
8814 38 F9 80                                         CMOVE0: JPS     _POP3           ; R3 = count
8817 38 03 81                                                 JPS     _POP21          ; R2 = dst, R1 = src
881A 1D F2 FE                                         CMOV10: LDR     R1              ; Get byte from source
881D 1E F6 FE                                                 STR     R2              ; Store to destination
8820 2E F2 FE                                                 INW     R1              ; Bump source pointer
8823 2E F6 FE                                                 INW     R2              ; Bump destination pointer
8826 2F FA FE                                                 DEW     R3              ; Decrement count
8829 15 FA FE                                                 LDA     R3.0            ; Low byte zero?
882C 11 00                                                    CPI     0               ; :
882E 3A 1A 88                                                 BNE     CMOV10          ; NO: One more byte
8831 15 FB FE                                                 LDA     R3.1            ; High byte zero?
8834 11 00                                                    CPI     0               ; :
8836 3A 1A 88                                                 BNE     CMOV10          ; NO: One more byte
8839 14 30 85                                                 JPA     NEXT            ; YES: Count zero. Done.
                                                      
883C 82 55 AA                                         HUSTAR: DB      ^2 "U" ^'*'                             ; ***** U*
883F 0A 88                                                    DW      HCMOVE
8841 43 88                                            USTAR:  DW      USTAR0
8843 38 03 81                                         USTAR0: JPS     _POP21          ; R2 = oper2, R1 = oper1
8846 38 43 84                                                 JPS     _UMULT          ; u32 = u16 * u16
8849 2F EC FE                                                 DEW     SP              ; -(SP) = R3X
884C 15 FB FE                                                 LDA     R3.1            ; :
884F 1E EC FE                                                 STR     SP              ; :
8852 2F EC FE                                                 DEW     SP              ; :
8855 15 FA FE                                                 LDA     R3.0            ; :
8858 1E EC FE                                                 STR     SP              ; :
885B 2F EC FE                                                 DEW     SP              ; :
885E 15 FD FE                                                 LDA     R3.3            ; :
8861 1E EC FE                                                 STR     SP              ; :
8864 2F EC FE                                                 DEW     SP              ; :
8867 15 FC FE                                                 LDA     R3.2            ; :
886A 1E EC FE                                                 STR     SP              ; :
886D 14 30 85                                                 JPA     NEXT            ; Done
                                                      
8870 82 55 AF                                         HUSLAS: DB      ^2 "U" ^'/'                             ; ***** U/
8873 3C 88                                                    DW      HUSTAR
8875 77 88                                            USLAS:  DW      USLAS0
8877 38 03 81                                         USLAS0: JPS     _POP21          ; R2 = divisor, R1 = dividend-hi
887A 15 F2 FE                                                 LDA     R1.0            ; Move high part to R1.2 and R1.3
887D 16 F4 FE                                                 STA     R1.2            ; :
8880 15 F3 FE                                                 LDA     R1.1            ; :
8883 16 F5 FE                                                 STA     R1.3            ; :
8886 38 73 80                                                 JPS     _POP1           ; dividend, low 16b
8889 38 B4 84                                                 JPS     _UDIV           ; u32 / u16 --> quot_u16, rem_u16
888C 14 0C 85                                                 JPA     IPUSH           ; Push R1H; Push R1L; NEXT
                                                      
888F 83 41 4E C4                                      HAND:   DB      ^3 "AN" ^'D'                            ; ***** AND
8893 70 88                                                    DW      HUSLAS
8895 97 88                                            AND:    DW      AND0
8897 38 03 81                                         AND0:   JPS     _POP21          ; R2 = oper2, R1 = oper1
889A 38 1C 84                                                 JPS     _AND16          ; R1 = R1 & R2
889D 14 1E 85                                                 JPA     PUSH            ; Done
                                                      
88A0 82 4F D2                                         HOR:    DB      ^2 "O" ^'R'                             ; ***** OR
88A3 8F 88                                                    DW      HAND
88A5 A7 88                                            OR:     DW      OR0
88A7 38 03 81                                         OR0:    JPS     _POP21          ; R2 = oper2, R1 = oper1
88AA 38 29 84                                                 JPS     _OR16           ; R1 = R1 | R2
88AD 14 1E 85                                                 JPA     PUSH            ; Done
                                                      
88B0 83 58 4F D2                                      HXOR:   DB      ^3 "XO" ^'R'                            ; ***** XOR
88B4 A0 88                                                    DW      HOR
88B6 B8 88                                            XOR:    DW      XOR0
88B8 38 03 81                                         XOR0:   JPS     _POP21          ; R2 = oper2, R1 = oper1
88BB 38 36 84                                                 JPS     _XOR16          ; R1 = R1 ^ R2
88BE 14 1E 85                                                 JPA     PUSH            ; Done
                                                      
88C1 83 53 50 C0                                      HSPAT:  DB      ^3 "SP" ^'@'                            ; ***** SP@
88C5 B0 88                                                    DW      HXOR
88C7 C9 88                                            SPAT:   DW      SPAT0
88C9 15 EC FE                                         SPAT0:  LDA     SP.0            ; Get stack pointer
88CC 16 F2 FE                                                 STA     R1.0            ; : into R1
88CF 15 ED FE                                                 LDA     SP.1            ; :
88D2 16 F3 FE                                                 STA     R1.1            ; :
88D5 14 1E 85                                                 JPA     PUSH            ; Push R1; NEXT
                                                      
88D8 83 53 50 A1                                      HSPSTO: DB      ^3 "SP" ^'!'                            ; ***** SP!
88DC C1 88                                                    DW      HSPAT
88DE E0 88                                            SPSTO:  DW      SPSTO0
88E0 0E 12                                            SPSTO0: LDI     18              ; Index of SP0
88E2 16 F6 FE                                                 STA     R2.0            ; : in boot table
88E5 38 73 83                                                 JPS     _PORIG          ; R3 = &bootTable[R2]
88E8 38 6C 82                                                 JPS     _LD16           ; R1 = XSP
88EB 15 F2 FE                                                 LDA     R1.0            ; SP = R1
88EE 16 EC FE                                                 STA     SP.0            ; :
88F1 15 F3 FE                                                 LDA     R1.1            ; :
88F4 16 ED FE                                                 STA     SP.1            ; :
88F7 14 30 85                                                 JPA     NEXT            ; Done
                                                      
88FA 83 52 50 A1                                      HRPSTO: DB      ^3 "RP" ^'!'                            ; ***** RP!
88FE D8 88                                                    DW      HSPSTO
8900 02 89                                            RPSTO:  DW      RPSTO0
8902 0E 14                                            RPSTO0: LDI     20              ; Index of SP0
8904 16 F6 FE                                                 STA     R2.0            ; : in boot table
8907 38 73 83                                                 JPS     _PORIG          ; R3 = &bootTable[R2]
890A 38 6C 82                                                 JPS     _LD16           ; R1 = XRP
890D 15 F2 FE                                                 LDA     R1.0            ; SP = R1
8910 16 EE FE                                                 STA     RP.0            ; :
8913 15 F3 FE                                                 LDA     R1.1            ; :
8916 16 EF FE                                                 STA     RP.1            ; :
8919 14 30 85                                                 JPA     NEXT            ; Done
                                                      
891C 83 55 50 A1                                      HUPSTO: DB      ^3 "UP" ^'!'                            ; ***** UP!
8920 FA 88                                                    DW      HRPSTO
8922 24 89                                            UPSTO:  DW      UPSTO0
8924 0E 10                                            UPSTO0: LDI     16              ; Index of UP0
8926 16 F6 FE                                                 STA     R2.0            ; : in boot table
8929 38 73 83                                                 JPS     _PORIG          ; R3 = &bootTable[R2]
892C 38 6C 82                                                 JPS     _LD16           ; R1 = XUP
892F 15 F2 FE                                                 LDA     R1.0            ; UP = R1
8932 16 F0 FE                                                 STA     UP.0            ; :
8935 15 F3 FE                                                 LDA     R1.1            ; :
8938 16 F1 FE                                                 STA     UP.1            ; :
893B 14 30 85                                                 JPA     NEXT            ; Done
                                                      
893E 82 3B D3                                         HSEMIS: DB      ^2 ";" ^'S'                             ; ***** ;S
8941 FA 88                                                    DW      HRPSTO
8943 45 89                                            SEMIS:  DW      SEMIS0
8945 1D EE FE                                         SEMIS0: LDR     RP              ; IP = (RP)+
8948 16 E8 FE                                                 STA     IP.0            ; :
894B 2E EE FE                                                 INW     RP              ; :
894E 1D EE FE                                                 LDR     RP              ; :
8951 16 E9 FE                                                 STA     IP.1            ; :
8954 2E EE FE                                                 INW     RP              ; :
8957 14 30 85                                                 JPA     NEXT            ; Done
                                                      
895A 85 4C 45 41 56 C5                                HLEAVE: DB      ^5 "LEAV" ^'E'                          ; ***** LEAVE
8960 3E 89                                                    DW      HSEMIS
8962 64 89                                            LEAVE:  DW      LEAVE0
8964 38 21 81                                         LEAVE0: JPS     _RPOP1          ; 2(RP) = (RP)
8967 38 CE 81                                                 JPS     _RPUT1          ; :
896A 38 D5 81                                                 JPS     _RPUSH1         ; :
896D 14 30 85                                                 JPA     NEXT
                                                      
8970 82 3E D2                                         HTOR:   DB      ^2 ">" ^'R'                             ; ***** >R
8973 5A 89                                                    DW      HLEAVE
8975 77 89                                            TOR:    DW      TOR0
8977 38 73 80                                         TOR0:   JPS     _POP1           ; -(RP) = (SP)+
897A 38 D5 81                                                 JPS     _RPUSH1         ; :
897D 14 30 85                                                 JPA     NEXT
                                                      
8980 82 52 BE                                         HFROMR: DB      ^2 "R" ^'>'                             ; ***** R>
8983 70 89                                                    DW      HTOR
8985 87 89                                            FROMR:  DW      FROMR0
8987 38 21 81                                         FROMR0: JPS     _RPOP1          ; -(SP) = (RP)+
898A 14 1E 85                                                 JPA     PUSH            ; :
                                                      
898D 81 D2                                            HR:     DB      ^1 ^'R'                                 ; ***** R
898F 80 89                                                    DW      HFROMR
8991 93 89                                            R:      DW      R0
8993 38 1A 81                                         R0:     JPS     _RGET1          ; -(SP) = (RP)
8996 14 1E 85                                                 JPA     PUSH            ; :
                                                      
8999 82 30 BD                                         HZEQU:  DB      ^2 "0" ^'='                             ; ***** 0=
899C 8D 89                                                    DW      HR
899E A0 89                                            ZEQU:   DW      ZEQU0
89A0 1D EC FE                                         ZEQU0:  LDR     SP              ; Get low byte
89A3 11 00                                                    CPI     0               ; Is it zero?
89A5 3A B9 89                                                 BNE     ZEQU10          ; NO: Return FALSE
89A8 2E EC FE                                                 INW     SP              ; YES: Have to inspect
89AB 1D EC FE                                                 LDR     SP              ; : high byte as well
89AE 11 00                                                    CPI     0               ; Is it zero?
89B0 3A BC 89                                                 BNE     ZEQU20          ; NO: Return FALSE
89B3 2E EC FE                                                 INW     SP              ; Make POP complete
89B6 14 57 85                                                 JPA     PUSHT           ; YES: Return TRUE
89B9 2E EC FE                                         ZEQU10: INW     SP              ; POP argument off dstack
89BC 2E EC FE                                         ZEQU20: INW     SP              ; : Make POP complete
89BF 14 60 85                                                 JPA     PUSHF           ; Return FALSE
                                                      
89C2 82 30 BC                                         HZLESS: DB      ^2 "0" ^'<'                             ; ***** 0<
89C5 99 89                                                    DW      HZEQU
89C7 C9 89                                            ZLESS:  DW      ZLESS0
89C9 2E EC FE                                         ZLESS0: INW     SP              ; Inspect high byte only
89CC 1D EC FE                                                 LDR     SP              ; Get high byte
89CF 11 00                                                    CPI     0               ; Is high byte negative?
89D1 3F DA 89                                                 BMI     ZLES10          ; YES: Return TRUE
89D4 2E EC FE                                                 INW     SP              ; NO: POP high byte also
89D7 14 60 85                                                 JPA     PUSHF           ; Return FALSE
89DA 2E EC FE                                         ZLES10: INW     SP              ; POP high byte also
89DD 14 57 85                                                 JPA     PUSHT           ; Return TRUE
                                                      
89E0 81 AB                                            HPLUS:  DB      ^1 ^'+'                                 ; ***** +
89E2 C2 89                                                    DW      HZLESS
89E4 E6 89                                            PLUS:   DW      PLUS0
89E6 38 03 81                                         PLUS0:  JPS     _POP21          ; R2 = oper2, R1 = oper1
89E9 38 18 82                                                 JPS     _ADD16          ; R1 = R1 + R2
89EC 14 1E 85                                                 JPA     PUSH            ; -(SP) = R1; NEXT
                                                      
89EF 82 44 AB                                         HDPLUS: DB      ^2 "D" ^'+'                             ; ***** D+
89F2 E0 89                                                    DW      HPLUS
89F4 F6 89                                            DPLUS:  DW      DPLUS0
89F6 38 BD 80                                         DPLUS0: JPS     _DPOP2          ; Get second operand
89F9 38 7A 80                                                 JPS     _DPOP1          ; Get first operand
89FC 38 2B 82                                                 JPS     _ADD32          ; R1X = R1X + R2X
89FF 14 66 85                                                 JPA     DPUSH           ; -(SP) = R1X; NEXT
                                                      
8A02 85 4D 49 4E 55 D3                                HMINUS: DB      ^5 "MINU" ^'S'                          ; ***** MINUS
8A08 EF 89                                                    DW      HDPLUS
8A0A 0C 8A                                            MINUS:  DW      MINUS0
8A0C 38 73 80                                         MINUS0: JPS     _POP1           ; Get operand
8A0F 38 28 83                                                 JPS     _NEG16          ; Negate
8A12 14 1E 85                                                 JPA     PUSH
                                                      
8A15 86 44 4D 49 4E 55 D3                             HDMINU: DB      ^6 "DMINU" ^'S'                         ; ***** DMINUS
8A1C 02 8A                                                    DW      HMINUS
8A1E 20 8A                                            DMINU:  DW      DMINU0
8A20 38 7A 80                                         DMINU0: JPS     _DPOP1          ; Get operand
8A23 38 3C 83                                                 JPS     _NEG32          ; Negate
8A26 14 66 85                                                 JPA     DPUSH
                                                      
8A29 84 50 49 43 CB                                   HPICK:  DB      ^4 "PIC" ^'K'                           ; ***** PICK
8A2E 15 8A                                                    DW      HDMINU
8A30 32 8A                                            PICK:   DW      PICK0
8A32 38 73 80                                         PICK0:  JPS     _POP1           ; Get index number
8A35 15 F2 FE                                                 LDA     R1.0            ; Push onto Minimal stack
8A38 36                                                       PHS                     ; :
8A39 38 97 83                                                 JPS     _PICK           ; R1 = n(SP)
8A3C 37                                                       PLS                     ; Remove index number
8A3D 14 1E 85                                                 JPA     PUSH            ; -(SP) = R1; NEXT
                                                      
8A40 84 52 4F 4C CC                                   HROLL:  DB      ^4 "ROL" ^'L'                           ; ***** ROLL
8A45 29 8A                                                    DW      HPICK
8A47 49 8A                                            ROLL:   DW      ROLL0
8A49 38 73 80                                         ROLL0:  JPS     _POP1           ; Get index number
8A4C 15 F2 FE                                                 LDA     R1.0            ; Push onto Minimal stack
8A4F 36                                                       PHS                     ; :
8A50 38 AD 83                                                 JPS     _ROLL           ; R1 = n(SP)
8A53 37                                                       PLS                     ; Remove index number
8A54 14 30 85                                                 JPA     NEXT            ; Done
                                                      
8A57 84 4F 56 45 D2                                   HOVER:  DB      ^4 "OVE" ^'R'                           ; ***** OVER
8A5C 40 8A                                                    DW      HROLL
8A5E 60 8A                                            OVER:   DW      OVER0
8A60 38 B6 80                                         OVER0:  JPS     _POP2           ; n1 n2 -- n1 n2 n1
8A63 38 6C 80                                                 JPS     _GET1           ; :
8A66 38 99 81                                                 JPS     _PUSH2          ; :
8A69 14 1E 85                                                 JPA     PUSH            ; :
                                                      
8A6C 84 44 52 4F D0                                   HDROP:  DB      ^4 "DRO" ^'P'                           ; **** DROP
8A71 57 8A                                                    DW      HOVER
8A73 75 8A                                            DROP:   DW      DROP0
8A75 0E 02                                            DROP0:  LDI     2               ; n1 --
8A77 30 EC FE                                                 ADW     SP              ; :
8A7A 14 30 85                                                 JPA     NEXT            ; Done
                                                      
8A7D 84 53 57 41 D0                                   HSWAP:  DB      ^4 "SWA" ^'P'                           ; **** SWAP
8A82 6C 8A                                                    DW      HDROP
8A84 86 8A                                            SWAP:   DW      SWAP0
8A86 38 03 81                                         SWAP0:  JPS     _POP21          ; n1 n2 -- n2 n1
8A89 38 99 81                                                 JPS     _PUSH2          ; :
8A8C 14 1E 85                                                 JPA     PUSH            ; :
                                                      
8A8F 83 44 55 D0                                      HDUP:   DB      ^3 "DU" ^'P'                            ; **** DUP
8A93 7D 8A                                                    DW      HSWAP
8A95 97 8A                                            DUP:    DW      DUP0
8A97 38 6C 80                                         DUP0:   JPS     _GET1           ; n1 -- n1 n1
8A9A 14 1E 85                                                 JPA     PUSH            ; :
                                                      
8A9D 85 32 4F 56 45 D2                                HTOVER: DB      ^5 "2OVE" ^'R'                          ; ***** 2OVER
8AA3 8F 8A                                                    DW      HDUP
8AA5 A7 8A                                            TOVER:  DW      TOVER0
8AA7 0E 03                                            TOVER0: LDI     3
8AA9 36                                                       PHS
8AAA 38 97 83                                                 JPS     _PICK           ; 3 PICK
8AAD 38 7B 81                                                 JPS     _PUSH1
8AB0 38 97 83                                                 JPS     _PICK           ; 3 PICK
8AB3 37                                                       PLS
8AB4 14 1E 85                                                 JPA     PUSH
                                                      
8AB7 85 32 44 52 4F D0                                HTDROP: DB      ^5 "2DRO" ^'P'                          ; ***** 2DROP
8ABD 9D 8A                                                    DW      HTOVER
8ABF C1 8A                                            TDROP:  DW      TDROP0
8AC1 0E 04                                            TDROP0: LDI     4
8AC3 30 EC FE                                                 ADW     SP
8AC6 14 30 85                                                 JPA     NEXT
                                                      
8AC9 85 32 53 57 41 D0                                HTSWAP: DB      ^5 "2SWA" ^'P'                          ; ***** 2SWAP
8ACF B7 8A                                                    DW      HTDROP
8AD1 D3 8A                                            TSWAP:  DW      TSWAP0
8AD3 0E 03                                            TSWAP0: LDI     3
8AD5 36                                                       PHS
8AD6 38 AD 83                                                 JPS     _ROLL           ; 3 ROLL
8AD9 38 AD 83                                                 JPS     _ROLL           ; 3 ROLL
8ADC 37                                                       PLS
8ADD 14 30 85                                                 JPA     NEXT
                                                      
8AE0 84 32 44 55 D0                                   HTDUP:  DB      ^4 "2DU" ^'P'                           ; ***** 2DUP
8AE5 C9 8A                                                    DW      HTSWAP
8AE7 E9 8A                                            TDUP:   DW      TDUP0
8AE9 38 B6 80                                         TDUP0:  JPS     _POP2           ; OVER
8AEC 38 6C 80                                                 JPS     _GET1           ; :
8AEF 38 99 81                                                 JPS     _PUSH2          ; :
8AF2 38 7B 81                                                 JPS     _PUSH1          ; :
8AF5 38 B6 80                                                 JPS     _POP2           ; OVER
8AF8 38 6C 80                                                 JPS     _GET1           ; :
8AFB 38 99 81                                                 JPS     _PUSH2          ; :
8AFE 14 1E 85                                                 JPA     PUSH            ; :
                                                      
                                                      
8B01 82 2B A1                                         HPSTOR: DB      ^2 "+" ^'!'                             ; ***** +!
8B04 E0 8A                                                    DW      HTDUP
8B06 08 8B                                            PSTOR:  DW      PSTOR0
8B08 38 F9 80                                         PSTOR0: JPS     _POP3           ; R3 = addr
8B0B 38 B6 80                                                 JPS     _POP2           ; R2 = incr
8B0E 38 6C 82                                                 JPS     _LD16           ; R1 = (R3)
8B11 38 18 82                                                 JPS     _ADD16          ; R1 = R1 + R2
8B14 38 7F 82                                                 JPS     _ST16           ; (R3) = R1
8B17 14 30 85                                                 JPA     NEXT            ; Done
                                                      
8B1A 86 54 4F 47 47 4C C5                             HTOGGL: DB      ^6 "TOGGL" ^'E'                         ; ***** TOGGLE
8B21 01 8B                                                    DW      HPSTOR
8B23 25 8B                                            TOGGL:  DW      TOGGL0
8B25 38 B6 80                                         TOGGL0: JPS     _POP2           ; R2 = bit mask
8B28 38 F2 80                                                 JPS     _GET3           ; R3 = addr (leave copy on stack)
8B2B 1D FA FE                                                 LDR     R3              ; Get the byte
8B2E 16 F2 FE                                                 STA     R1.0            ; :
8B31 38 D8 82                                                 JPS     _XOR8           ; R1.0 = R1.0 ^ R2.0
8B34 38 F9 80                                                 JPS     _POP3           ; R3 = addr
8B37 15 F2 FE                                                 LDA     R1.0            ; Update the byte
8B3A 1E FA FE                                                 STR     R3              ; :
8B3D 14 30 85                                                 JPA     NEXT            ; Done
                                                      
8B40 85 3E 42 41 4E CB                                HTBANK: DB      ^5 ">BAN" ^'K'                          ; >BANK
8B46 1A 8B                                                    DW      HTOGGL
8B48 4A 8B                                            TBANK:  DW      TBANK0
8B4A 38 73 80                                         TBANK0: JPS     _POP1           ; Get bank number from data stack into R1
8B4D 0E 3E                                                    LDI     62              ; Get index to user variable BANK
8B4F 16 F6 FE                                                 STA     R2.0            ; : into R2.0
8B52 38 84 83                                                 JPS     _USER           ; R3 now contains absolute address of BANK
8B55 38 7F 82                                                 JPS     _ST16           ; Save the bank number in user variable BANK
8B58 15 F2 FE                                                 LDA     R1.0            ; Do the actual bank switch
8B5B 01                                                       BNK                     ; :
8B5C 14 30 85                                                 JPA     NEXT
                                                              
8B5F 81 C0                                            HAT:    DB      ^1 ^'@'                                 ; ***** @
8B61 40 8B                                                    DW      HTBANK
8B63 65 8B                                            AT:     DW      AT0
8B65 38 F9 80                                         AT0:    JPS     _POP3           ; R3 = addr
8B68 38 6C 82                                                 JPS     _LD16           ; R1 = (R3)
8B6B 14 1E 85                                                 JPA     PUSH            ; -(SP) = R1; NEXT
                                                      
8B6E 82 43 C0                                         HCAT:   DB      ^2 "C" ^'@'                             ; ***** C@
8B71 5F 8B                                                    DW      HAT
8B73 75 8B                                            CAT:    DW      CAT0
8B75 2C F2 FE                                         CAT0:   CLW     R1              ; R1 = 0
8B78 38 F9 80                                                 JPS     _POP3           ; R3 = addr
8B7B 1D FA FE                                                 LDR     R3              ; A = (R3)
8B7E 16 F2 FE                                                 STA     R1.0            ; R1 = A
8B81 14 1E 85                                                 JPA     PUSH            ; -(SP) = R1; NEXT
                                                      
8B84 81 A1                                            HSTORE: DB      ^1 ^'!'                                 ; ***** !
8B86 6E 8B                                                    DW      HCAT
8B88 8A 8B                                            STORE:  DW      STORE0
8B8A 38 F9 80                                         STORE0: JPS     _POP3           ; R3 = addr
8B8D 38 73 80                                                 JPS     _POP1           ; R1 = data
8B90 38 7F 82                                                 JPS     _ST16           ; (R3) = R1
8B93 14 30 85                                                 JPA     NEXT            ; Done
                                                      
8B96 82 43 A1                                         HCSTOR: DB      ^2 "C" ^'!'                             ; ***** C!
8B99 84 8B                                                    DW      HSTORE
8B9B 9D 8B                                            CSTOR:  DW      CSTOR0
8B9D 38 03 81                                         CSTOR0: JPS     _POP21          ; R2 = addr, R1 = data
8BA0 15 F2 FE                                                 LDA     R1.0            ; A = R1.0
8BA3 1E F6 FE                                                 STR     R2              ; (R3) = A
8BA6 14 30 85                                                 JPA     NEXT            ; Done
                                                      
                                                      ; INCLUDE         precompiled.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; PRECOMPILED FORTH WORDS
                                                      ;
                                                      
8BA9 C1 BA                                            HCOLON: DB      ^^1 ^':'                                ; ***** :
8BAB 96 8B                                                    DW      HCSTOR
8BAD C1 8B E9 8F A4 8F 8F 8D 63 8B 81 8D 88 8B        COLON:  DW      DOCOL QEXEC SCSP CURR AT CONT STORE
8BBB 2F 95 6E 90 D5 90                                        DW      CREAT RBRAC PSCOD
8BC1 2F EE FE                                         DOCOL:  DEW     RP              ; -(RP) = IP
8BC4 15 E9 FE                                                 LDA     IP.1            ; :
8BC7 1E EE FE                                                 STR     RP              ; :
8BCA 2F EE FE                                                 DEW     RP              ; :
8BCD 15 E8 FE                                                 LDA     IP.0            ; :
8BD0 1E EE FE                                                 STR     RP              ; :
8BD3 15 EA FE                                                 LDA     WA.0            ; IP = WA
8BD6 16 E8 FE                                                 STA     IP.0            ; :
8BD9 15 EB FE                                                 LDA     WA.1            ; :
8BDC 16 E9 FE                                                 STA     IP.1            ; :
8BDF 14 30 85                                                 JPA     NEXT
                                                      
8BE2 C1 BB                                            HSEMI:  DB      ^^1 ^';'                                ; ***** ;
8BE4 A9 8B                                                    DW      HCOLON
8BE6 C1 8B 13 90 4A 90 43 89 83 90 60 90 43 89        SEMI:   DW      DOCOL QCSP COMP SEMIS SMUDG LBRAC SEMIS
                                                      
8BF4 88 43 4F 4E 53 54 41 4E D4                       HCON:   DB      ^8 "CONSTAN" ^'T'                       ; ***** CONSTANT
8BFD E2 8B                                                    DW      HSEMI
8BFF C1 8B 2F 95 83 90 99 8E D5 90                    CON:    DW      DOCOL CREAT SMUDG COMMA PSCOD
8C09 1D EA FE                                         DOCON:  LDR     WA              ; -(SP) = (WA)
8C0C 16 F2 FE                                                 STA     R1.0            ; :
8C0F 2E EA FE                                                 INW     WA              ; :
8C12 1D EA FE                                                 LDR     WA              ; :
8C15 16 F3 FE                                                 STA     R1.1            ; :
8C18 2F EA FE                                                 DEW     WA              ; :
8C1B 14 1E 85                                                 JPA     PUSH            ; Done
                                                      
8C1E 88 56 41 52 49 41 42 4C C5                       HVAR:   DB      ^8 "VARIABL" ^'E'                       ; ***** VARIABLE
8C27 F4 8B                                                    DW      HCON
8C29 C1 8B FF 8B D5 90                                VAR:    DW      DOCOL CON PSCOD
8C2F 2F EC FE                                         DOVAR:  DEW     SP              ; -(SP) = WA
8C32 15 EB FE                                                 LDA     WA.1            ; :
8C35 1E EC FE                                                 STR     SP              ; :
8C38 2F EC FE                                                 DEW     SP              ; :
8C3B 15 EA FE                                                 LDA     WA.0            ; :
8C3E 1E EC FE                                                 STR     SP              ; :
8C41 14 30 85                                                 JPA     NEXT            ; Done
                                                      
8C44 84 55 53 45 D2                                   HUSER:  DB      ^4 "USE" ^'R'                           ; ***** USER
8C49 1E 8C                                                    DW      HVAR
8C4B C1 8B FF 8B D5 90                                USER:   DW      DOCOL CON PSCOD
8C51 1D EA FE                                         DOUSE:  LDR     WA              ; Compute UP[index]
8C54 17 F0 FE                                                 ADA     UP.0            ; :
8C57 16 F2 FE                                                 STA     R1.0            ; :
8C5A 2E EA FE                                                 INW     WA              ; :
8C5D 1D EA FE                                                 LDR     WA              ; :
8C60 1A F1 FE                                                 ACA     UP.1            ; :
8C63 16 F3 FE                                                 STA     R1.1            ; :
8C66 14 1E 85                                                 JPA     PUSH            ; Push address; NEXT
                                                      
                                                      ; ------------------------------
                                                      ; PRECOMPILED CONSTANTS
                                                      
8C69 82 2D B1                                         HMONE:  DB      ^2 "-" ^'1'                             ; ***** -1
8C6C 44 8C                                                    DW      HUSER
8C6E 09 8C FF FF                                      MONE:   DW      DOCON -1
                                                      
8C72 81 B0                                            HZERO:  DB      ^1 ^'0'                                 ; ***** 0
8C74 69 8C                                                    DW      HMONE
8C76 09 8C 00 00                                      ZERO:   DW      DOCON 0
                                                      
8C7A 81 B1                                            HONE:   DB      ^1 ^'1'                                 ; ***** 1
8C7C 72 8C                                                    DW      HZERO
8C7E 09 8C 01 00                                      ONE:    DW      DOCON 1
                                                      
8C82 81 B2                                            HTWO:   DB      ^1 ^'2'                                 ; ***** 2
8C84 7A 8C                                                    DW      HONE
8C86 09 8C 02 00                                      TWO:    DW      DOCON 2
                                                      
8C8A 81 B3                                            HTHREE: DB      ^1 ^'3'                                 ; ***** 3
8C8C 82 8C                                                    DW      HTWO
8C8E 09 8C 03 00                                      THREE:  DW      DOCON 3
                                                      
8C92 82 42 CC                                         HBL:    DB      ^2 "B" ^'L'                             ; ***** BL
8C95 8A 8C                                                    DW      HTHREE
8C97 09 8C 20 00                                      BL:     DW      DOCON 32
                                                      
8C9B 83 43 2F CC                                      HCL:    DB      ^3 "C/" ^'L'                            ; ***** C/L
8C9F 92 8C                                                    DW      HBL
8CA1 09 8C 40 00                                      CL:     DW      DOCON 64
                                                      
8CA5 85 42 2F 42 55 C6                                HBBUF:  DB      ^5 "B/BU" ^'F'                          ; ***** B/BUF
8CAB 9B 8C                                                    DW      HCL
8CAD 09 8C 00 04                                      BBUF:   DW      DOCON 1024
                                                      
8CB1 85 42 2F 53 43 D2                                HBSCR:  DB      ^5 "B/SC" ^'R'                          ; ***** B/SCR
8CB7 A5 8C                                                    DW      HBBUF
8CB9 09 8C 01 00                                      BSCR:   DW      DOCON 1
                                                      
8CBD 87 2B 4F 52 49 47 49 CE                          HPORIG: DB      ^7 "+ORIGI" ^'N'                        ; ***** +ORIGIN
8CC5 B1 8C                                                    DW      HBSCR
8CC7 C1 8B 93 85 00 80 E4 89 43 89                    PORIG:  DW      DOCOL LIT ORIGIN PLUS SEMIS
                                                      
                                                      ; ------------------------------
                                                      ; USER VARIABLES
                                                      
8CD1 82 53 B0                                         HSZERO: DB      ^2 "S" ^'0'                             ; ***** S0
8CD4 BD 8C                                                    DW      HPORIG
8CD6 51 8C 06 00                                      SZERO:  DW      DOUSE 6
                                                      
8CDA 82 52 B0                                         HRZERO: DB      ^2 "R" ^'0'                             ; ***** R0
8CDD D1 8C                                                    DW      HSZERO
8CDF 51 8C 08 00                                      RZERO:  DW      DOUSE 8
                                                      
8CE3 83 54 49 C2                                      HTIB:   DB      ^3 "TI" ^'B'                            ; ***** TIB
8CE7 DA 8C                                                    DW      HRZERO
8CE9 51 8C 0A 00                                      TIB:    DW      DOUSE 10
                                                      
8CED 85 57 49 44 54 C8                                HWIDTH: DB      ^5 "WIDT" ^'H'                          ; ***** WIDTH
8CF3 E3 8C                                                    DW      HTIB
8CF5 51 8C 0C 00                                      WIDTH:  DW      DOUSE 12
                                                      
8CF9 87 57 41 52 4E 49 4E C7                          HWARN:  DB      ^7 "WARNIN" ^'G'                        ; ***** WARNING
8D01 ED 8C                                                    DW      HWIDTH
8D03 51 8C 0E 00                                      WARN:   DW      DOUSE 14
                                                      
8D07 85 46 45 4E 43 C5                                HFENCE: DB      ^5 "FENC" ^'E'                          ; ***** FENCE
8D0D F9 8C                                                    DW      HWARN
8D0F 51 8C 10 00                                      FENCE:  DW      DOUSE 16
                                                      
8D13 82 44 D0                                         HDP:    DB      ^2 "D" ^'P'                             ; ***** DP
8D16 07 8D                                                    DW      HFENCE
8D18 51 8C 12 00                                      DP:     DW      DOUSE 18
                                                      
8D1C 88 56 4F 43 2D 4C 49 4E CB                       HVOCL:  DB      ^8 "VOC-LIN" ^'K'                       ; ***** VOC-LINK
8D25 13 8D                                                    DW      HDP
8D27 51 8C 14 00                                      VOCL:   DW      DOUSE 20
                                                      
8D2B 85 46 49 52 53 D4                                HFIRST: DB      ^5 "FIRS" ^'T'                          ; ***** FIRST
8D31 1C 8D                                                    DW      HVOCL
8D33 51 8C 16 00                                      FIRST:  DW      DOUSE 22
                                                      
8D37 85 4C 49 4D 49 D4                                HLIMIT: DB      ^5 "LIMI" ^'T'                          ; ***** LIMIT
8D3D 2B 8D                                                    DW      HFIRST
8D3F 51 8C 18 00                                      LIMIT:  DW      DOUSE 24
                                                      
8D43 83 42 4C CB                                      HBLK:   DB      ^3 "BL" ^'K'                            ; ***** BLK
8D47 37 8D                                                    DW      HLIMIT
8D49 51 8C 1E 00                                      BLK:    DW      DOUSE 30
                                                      
8D4D 82 49 C9                                         HIN:    DB      ^2 "I" ^'I'                             ; ***** IN
8D50 43 8D                                                    DW      HBLK
8D52 51 8C 20 00                                      IN:     DW      DOUSE 32
                                                      
8D56 83 4F 55 D4                                      HOUT:   DB      ^3 "OU" ^'T'                            ; ***** OUT
8D5A 4D 8D                                                    DW      HIN
8D5C 51 8C 22 00                                      OUT:    DW      DOUSE 34
                                                      
8D60 83 53 43 D2                                      HSCR:   DB      ^3 "SC" ^'R'                            ; ***** SCR
8D64 56 8D                                                    DW      HOUT
8D66 51 8C 24 00                                      SCR:    DW      DOUSE 36
                                                      
8D6A 86 4F 46 46 53 45 D4                             HOFFSE: DB      ^6 "OFFSE" ^'T'                         ; ***** OFFSET
8D71 60 8D                                                    DW      HSCR
8D73 51 8C 26 00                                      OFFSE:  DW      DOUSE 38
                                                      
8D77 87 43 4F 4E 54 45 58 D4                          HCONT:  DB      ^7 "CONTEX" ^'T'                        ; ***** CONTEXT
8D7F 6A 8D                                                    DW      HOFFSE
8D81 51 8C 28 00                                      CONT:   DW      DOUSE 40
                                                      
8D85 87 43 55 52 52 45 4E D4                          HCURR:  DB      ^7 "CURREN" ^'T'                        ; ***** CURRENT
8D8D 77 8D                                                    DW      HCONT
8D8F 51 8C 2A 00                                      CURR:   DW      DOUSE 42
                                                      
8D93 85 53 54 41 54 C5                                HSTATE: DB      ^5 "STAT" ^'E'                          ; ***** STATE
8D99 85 8D                                                    DW      HCURR
8D9B 51 8C 2C 00                                      STATE:  DW      DOUSE 44
                                                      
8D9F 84 42 41 53 C5                                   HBASE:  DB      ^4 "BAS" ^'E'                           ; ***** BASE
8DA4 93 8D                                                    DW      HSTATE
8DA6 51 8C 2E 00                                      BASE:   DW      DOUSE 46
                                                      
8DAA 83 44 50 CC                                      HDPL:   DB      ^3 "DP" ^'L'                            ; ***** DPL
8DAE 9F 8D                                                    DW      HBASE
8DB0 51 8C 32 00                                      DPL:    DW      DOUSE 50
                                                      
8DB4 83 46 4C C4                                      HFLD:   DB      ^3 "FL" ^'D'                            ; ***** FLD
8DB8 AA 8D                                                    DW      HDPL
8DBA 51 8C 34 00                                      FLD:    DW      DOUSE 52
                                                      
8DBE 83 43 53 D0                                      HCSP:   DB      ^3 "CS" ^'P'                            ; ***** CSP
8DC2 B4 8D                                                    DW      HFLD
8DC4 51 8C 34 00                                      CSP:    DW      DOUSE 52
                                                      
8DC8 82 52 A3                                         HRNUM:  DB      ^2 "R" ^'#'                             ; ***** R#
8DCB BE 8D                                                    DW      HCSP
8DCD 51 8C 36 00                                      RNUM:   DW      DOUSE 54
                                                      
8DD1 83 48 4C C4                                      HHLD:   DB      ^3 "HL" ^'D'                            ; ***** HLD
8DD5 C8 8D                                                    DW      HRNUM
8DD7 51 8C 38 00                                      HLD:    DW      DOUSE 56
                                                      
8DDB 83 55 53 C5                                      HUSE:   DB      ^3 "US" ^'E'                            ; ***** USE
8DDF D1 8D                                                    DW      HHLD
8DE1 51 8C 3A 00                                      USE:    DW      DOUSE 58
                                                      
8DE5 84 50 52 45 D6                                   HPREV:  DB      ^4 "PRE" ^'V'                           ; ***** PREV
8DEA DB 8D                                                    DW      HUSE
8DEC 51 8C 3C 00                                      PREV:   DW      DOUSE 60
                                                      
8DF0 84 42 41 4E CB                                   HBANK:  DB      ^4 "BAN" ^'K'                           ; ***** BANK
8DF5 E5 8D                                                    DW      HPREV
8DF7 51 8C 3E 00                                      BANK:   DW      DOUSE 62
                                                      
                                                      ; END OF USER VARIABLES
                                                      ; ------------------------------
                                                      
8DFB 82 3E BE                                         HRSHFT: DB      ^2 ">" ^'>'                             ; ***** >>
8DFE F0 8D                                                    DW      HBANK
8E00 02 8E                                            RSHFT:  DW      RSHFT0
8E02 38 03 81                                         RSHFT0: JPS     _POP21
8E05 15 F3 FE                                         RSHF10: LDA     R1.1
8E08 07                                                       LSR
8E09 16 F3 FE                                                 STA     R1.1
8E0C 15 F2 FE                                                 LDA     R1.0
8E0F 08                                                       ROR
8E10 16 F2 FE                                                 STA     R1.0
8E13 27 F6 FE                                                 DEB     R2.0
8E16 3A 05 8E                                                 BNE     RSHF10
8E19 14 1E 85                                                 JPA     PUSH
                                                      
8E1C 82 3C BC                                         HLSHFT: DB      ^2 "<" ^'<'                             ; ***** <<
8E1F FB 8D                                                    DW      HRSHFT
8E21 23 8E                                            LSHFT:  DW      LSHFT0
8E23 38 03 81                                         LSHFT0: JPS     _POP21
8E26 15 F2 FE                                         LSHF10: LDA     R1.0
8E29 05                                                       LSL
8E2A 16 F2 FE                                                 STA     R1.0
8E2D 15 F3 FE                                                 LDA     R1.1
8E30 06                                                       ROL
8E31 16 F3 FE                                                 STA     R1.1
8E34 27 F6 FE                                                 DEB     R2.0
8E37 3A 26 8E                                                 BNE     LSHF10
8E3A 14 1E 85                                                 JPA     PUSH
                                                      
8E3D 82 31 AB                                         HONEP:  DB      ^2 "1" ^'+'                             ; ***** 1+
8E40 1C 8E                                                    DW      HLSHFT
8E42 44 8E                                            ONEP:   DW      ONEP0
                                                      ONEP0:  
8E44 38 73 80                                                 JPS     _POP1
8E47 15 F2 FE                                                 LDA     R1.0
8E4A 0C                                                       INC
8E4B 16 F2 FE                                                 STA     R1.0
8E4E 15 F3 FE                                                 LDA     R1.1
8E51 12 00                                                    ACI     0
8E53 16 F3 FE                                                 STA     R1.1
8E56 14 1E 85                                                 JPA     PUSH
                                                      
8E59 82 32 AB                                         HTWOP:  DB      ^2 "2" ^'+'                             ; ***** 2+
8E5C 3D 8E                                                    DW      HONEP
8E5E 60 8E                                            TWOP:   DW      TWOP0
8E60 38 73 80                                         TWOP0:  JPS     _POP1
8E63 15 F2 FE                                                 LDA     R1.0
8E66 0F 02                                                    ADI     2
8E68 16 F2 FE                                                 STA     R1.0
8E6B 15 F3 FE                                                 LDA     R1.1
8E6E 12 00                                                    ACI     0
8E70 16 F3 FE                                                 STA     R1.1
8E73 14 1E 85                                                 JPA     PUSH
                                                      
8E76 84 48 45 52 C5                                   HHERE:  DB      ^4 "HER" ^'E'                           ; ***** HERE
8E7B 59 8E                                                    DW      HTWOP
8E7D C1 8B 18 8D 63 8B 43 89                          HERE:   DW      DOCOL DP AT SEMIS
                                                      
8E85 85 41 4C 4C 4F D4                                HALLOT: DB      ^5 "ALLO" ^'T'                          ; ***** ALLOT
8E8B 76 8E                                                    DW      HHERE
8E8D C1 8B 18 8D 06 8B 43 89                          ALLOT:  DW      DOCOL DP PSTOR SEMIS
                                                      
8E95 81 AC                                            HCOMMA: DB      ^1 ^','                                 ; ***** ,
8E97 85 8E                                                    DW      HALLOT
8E99 C1 8B 7D 8E 88 8B 86 8C 8D 8E 43 89              COMMA:  DW      DOCOL HERE STORE TWO ALLOT SEMIS
                                                      
8EA5 81 AD                                            HSUB:   DB      ^1 ^'-'                                 ; ***** -
8EA7 95 8E                                                    DW      HCOMMA
8EA9 C1 8B 0A 8A E4 89 43 89                          SUB:    DW      DOCOL MINUS PLUS SEMIS
                                                      
8EB1 81 BD                                            HEQUAL: DB      ^1 ^'='                                 ; ***** =
8EB3 A5 8E                                                    DW      HSUB
8EB5 C1 8B A9 8E 9E 89 43 89                          EQUAL:  DW      DOCOL SUB ZEQU SEMIS
                                                      
8EBD 81 BC                                            HLESS:  DB      ^1 ^'<'                                 ; ***** <
8EBF B1 8E                                                    DW      HEQUAL
8EC1 C1 8B A9 8E C7 89 43 89                          LESS:   DW      DOCOL SUB ZLESS SEMIS
                                                      
8EC9 81 BE                                            HGREAT: DB      ^1 ^'>'                                 ; ***** >
8ECB BD 8E                                                    DW      HLESS
8ECD C1 8B 84 8A C1 8E 43 89                          GREAT:  DW      DOCOL SWAP LESS SEMIS
                                                      
8ED5 83 52 4F D4                                      HROT:   DB      ^3 "RO" ^'T'                            ; ***** ROT
8ED9 C9 8E                                                    DW      HGREAT
8EDB DD 8E                                            ROT:    DW      ROT0
8EDD 38 00 81                                         ROT0:   JPS     _POP321
8EE0 38 99 81                                                 JPS     _PUSH2
8EE3 38 B7 81                                                 JPS     _PUSH3
8EE6 14 1E 85                                                 JPA     PUSH
                                                      
8EE9 85 53 50 41 43 C5                                HSPACE: DB      ^5 "SPAC" ^'E'                          ; ***** SPACE
8EEF D5 8E                                                    DW      HROT
8EF1 C1 8B 97 8C B9 87 43 89                          SPACE:  DW      DOCOL BL EMIT SEMIS
                                                      
8EF9 84 2D 44 55 D0                                   HDDUP:  DB      ^4 "-DU" ^'P'                           ; ***** -DUP
8EFE E9 8E                                                    DW      HSPACE
8F00 02 8F                                            DDUP:   DW      DDUP0
8F02 38 6C 80                                         DDUP0:  JPS     _GET1
8F05 15 F2 FE                                                 LDA     R1.0
8F08 11 00                                                    CPI     0
8F0A 3A 18 8F                                                 BNE     DDUP10
8F0D 15 F3 FE                                                 LDA     R1.1
8F10 11 00                                                    CPI     0
8F12 3A 18 8F                                                 BNE     DDUP10
8F15 14 30 85                                                 JPA     NEXT
8F18 14 1E 85                                         DDUP10: JPA     PUSH
                                                      
8F1B 88 54 52 41 56 45 52 53 C5                       HTRAV:  DB      ^8 "TRAVERS" ^'E'                       ; ***** TRAVERSE
8F24 F9 8E                                                    DW      HDDUP
8F26 C1 8B 84 8A                                      TRAV:   DW      DOCOL SWAP
8F2A 5E 8A E4 89 93 85 7F 00                          TRAV10: DW      OVER PLUS LIT 0x7F
8F32 5E 8A 73 8B C1 8E D7 85 F0 FF                            DW      OVER CAT LESS ZBRAN +TRAV10
8F3C 84 8A 73 8A 43 89                                        DW      SWAP DROP SEMIS
                                                      
8F42 86 4C 41 54 45 53 D4                             HLATES: DB      ^6 "LATES" ^'T'                         ; ***** LATEST
8F49 1B 8F                                                    DW      HTRAV
8F4B C1 8B 8F 8D 63 8B 63 8B 43 89                    LATES:  DW      DOCOL CURR AT AT SEMIS
                                                      
8F55 83 4C 46 C1                                      HLFA:   DB      ^3 "LF" ^'A'                            ; ***** LFA
8F59 42 8F                                                    DW      HLATES
8F5B C1 8B 93 85 04 00 A9 8E 43 89                    LFA:    DW      DOCOL LIT 4 SUB SEMIS
                                                      
8F65 83 43 46 C1                                      HCFA:   DB      ^3 "CF" ^'A'                            ; ***** CFA
8F69 55 8F                                                    DW      HLFA
8F6B C1 8B 86 8C A9 8E 43 89                          CFA:    DW      DOCOL TWO SUB SEMIS
                                                      
8F73 83 4E 46 C1                                      HNFA:   DB      ^3 "NF" ^'A'                            ; ***** NFA
8F77 65 8F                                                    DW      HCFA
8F79 C1 8B 93 85 05 00 A9 8E 93 85 FF FF 26 8F 43 89  NFA:    DW      DOCOL LIT 5 SUB LIT -1 TRAV SEMIS
                                                      
8F89 83 50 46 C1                                      HPFA:   DB      ^3 "PF" ^'A'                            ; ***** PFA
8F8D 73 8F                                                    DW      HNFA
8F8F C1 8B 7E 8C 26 8F 93 85 05 00 E4 89 43 89        PFA:    DW      DOCOL ONE TRAV LIT 5 PLUS SEMIS
                                                      
                                                      ; ------------------------------
                                                      ; COMPILE TIME CHECKS
                                                      
8F9D 84 21 43 53 D0                                   HSCSP:  DB      ^4 "!CS" ^'P'                           ; ***** !CSP
8FA2 89 8F                                                    DW      HPFA
8FA4 C1 8B C7 88 C4 8D 88 8B 43 89                    SCSP:   DW      DOCOL SPAT CSP STORE SEMIS
                                                      
8FAE 86 3F 45 52 52 4F D2                             HQERR:  DB      ^6 "?ERRO" ^'R'                         ; ***** ?ERROR
8FB5 9D 8F                                                    DW      HSCSP
8FB7 C1 8B 84 8A D7 85 08 00                          QERR:   DW      DOCOL SWAP ZBRAN +QERR10
8FBF B2 94 C5 85 04 00                                        DW      ERROR BRAN +QERR20
8FC5 73 8A                                            QERR10: DW      DROP
8FC7 43 89                                            QERR20: DW      SEMIS
                                                      
8FC9 85 3F 43 4F 4D D0                                HQCOMP: DB      ^5 "?COM" ^'P'                          ; ***** ?COMP
8FCF AE 8F                                                    DW      HQERR
8FD1 C1 8B 9B 8D 63 8B 9E 89 93 85 11 00 B7 8F 43 89  QCOMP:  DW      DOCOL STATE AT ZEQU LIT 17 QERR SEMIS
                                                      
8FE1 85 3F 45 58 45 C3                                HQEXEC: DB      ^5 "?EXE" ^'C'                          ; ***** ?EXEC
8FE7 C9 8F                                                    DW      HQCOMP
8FE9 C1 8B 9B 8D 63 8B 93 85 12 00 B7 8F 43 89        QEXEC:  DW      DOCOL STATE AT LIT 18 QERR SEMIS
                                                      
8FF7 86 3F 50 41 49 52 D3                             HQPAIR: DB      ^6 "?PAIR" ^'S'                         ; ***** ?PAIRS
8FFE E1 8F                                                    DW      HQEXEC
9000 C1 8B A9 8E 93 85 13 00 B7 8F 43 89              QPAIR:  DW      DOCOL SUB LIT 19 QERR SEMIS
                                                      
900C 84 3F 43 53 D0                                   HQCSP:  DB      ^4 "?CS" ^'P'                           ; ***** ?CSP
9011 F7 8F                                                    DW      HQPAIR
9013 C1 8B C7 88 C4 8D 63 8B A9 8E                    QCSP:   DW      DOCOL SPAT CSP AT SUB
901D 93 85 14 00 B7 8F 43 89                                  DW      LIT 20 QERR SEMIS
                                                      
9025 88 3F 4C 4F 41 44 49 4E C7                       HQLOAD: DB      ^8 "?LOADIN" ^'G'                       ; ***** ?LOADING
902E 0C 90                                                    DW      HQCSP
9030 C1 8B 49 8D 63 8B 9E 89 93 85 16 00 B7 8F 43 89  QLOAD:  DW      DOCOL BLK AT ZEQU LIT 22 QERR SEMIS
                                                      
                                                      ; ------------------------------
                                                      ; COMPILER WORDS
                                                      
9040 87 43 4F 4D 50 49 4C C5                          HCOMP:  DB      ^7 "COMPIL" ^'E'                        ; ***** COMPILE
9048 25 90                                                    DW      HQLOAD
904A C1 8B D1 8F 85 89 95 8A                          COMP:   DW      DOCOL QCOMP FROMR DUP
9052 5E 8E 75 89 63 8B 99 8E 43 89                            DW      TWOP TOR AT COMMA SEMIS
                                                      
905C C1 DB                                            HLBRAC: DB      ^^1 ^'['                                ; ***** [
905E 40 90                                                    DW      HCOMP
9060 C1 8B 76 8C 9B 8D 88 8B 43 89                    LBRAC:  DW      DOCOL ZERO STATE STORE SEMIS
                                                      
906A 81 DD                                            HRBRAC: DB      ^1 ^']'                                 ; ***** ]
906C 5C 90                                                    DW      HLBRAC
906E C1 8B 93 85 C0 00 9B 8D 88 8B 43 89              RBRAC:  DW      DOCOL LIT 0xC0 STATE STORE SEMIS
                                                      
907A 86 53 4D 55 44 47 C5                             HSMUDG: DB      ^6 "SMUDG" ^'E'                         ; ***** SMUDGE
9081 6A 90                                                    DW      HRBRAC
9083 C1 8B 4B 8F 93 85 20 00 23 8B 43 89              SMUDG:  DW      DOCOL LATES LIT 0x20 TOGGL SEMIS
                                                      
908F 83 48 45 D8                                      HHEX:   DB      ^3 "HE" ^'X'                            ; ***** HEX
9093 7A 90                                                    DW      HSMUDG
9095 C1 8B 93 85 10 00 A6 8D 88 8B 43 89              HEX:    DW      DOCOL LIT 16 BASE STORE SEMIS
                                                      
90A1 87 44 45 43 49 4D 41 CC                          HDEC:   DB      ^7 "DECIMA" ^'L'                        ; ***** DECIMAL
90A9 8F 90                                                    DW      HHEX
90AB C1 8B 93 85 0A 00 A6 8D 88 8B 43 89              DEC:    DW      DOCOL LIT 10 BASE STORE SEMIS
                                                      
90B7 85 4F 43 54 41 CC                                HOCTAL: DB      ^5 "OCTA" ^'L'                          ; ***** OCTAL
90BD A1 90                                                    DW      HDEC
90BF C1 8B 93 85 08 00 A6 8D 88 8B 43 89              OCTAL:  DW      DOCOL LIT 8 BASE STORE SEMIS
                                                      
90CB 87 28 3B 43 4F 44 45 A9                          HPSCOD: DB      ^7 "(;CODE" ^')'                        ; ***** (;CODE)
90D3 B7 90                                                    DW      HOCTAL
90D5 C1 8B 85 89 4B 8F 8F 8F 6B 8F 88 8B 43 89        PSCOD:  DW      DOCOL FROMR LATES PFA CFA STORE SEMIS
                                                      
90E3 87 3C 42 55 49 4C 44 D3                          HBUILD: DB      ^7 "<BUILD" ^'S'                        ; ***** <BUILDS
90EB CB 90                                                    DW      HPSCOD
90ED C1 8B 76 8C FF 8B 43 89                          BUILD:  DW      DOCOL ZERO CON SEMIS
                                                      
90F5 85 44 4F 45 53 BE                                HDOES:  DB      ^5 "DOES" ^'>'                          ; ***** DOES>
90FB E3 90                                                    DW      HBUILD
90FD C1 8B 85 89 4B 8F 8F 8F 88 8B D5 90              DOES:   DW      DOCOL FROMR LATES PFA STORE PSCOD
9109 2F EE FE                                         DODOE:  DEW     RP              ; -(RP) = IP
910C 15 E9 FE                                                 LDA     IP.1            ; :
910F 1E EE FE                                                 STR     RP              ; :
9112 2F EE FE                                                 DEW     RP              ; :
9115 15 E8 FE                                                 LDA     IP.0            ; :
9118 1E EE FE                                                 STR     RP              ; :
911B 1D EA FE                                                 LDR     WA              ; IP = (WA)+
911E 16 E8 FE                                                 STA     IP.0            ; :
9121 2E EA FE                                                 INW     WA              ; :
9124 1D EA FE                                                 LDR     WA              ; :
9127 16 E9 FE                                                 STA     IP.1            ; :
912A 2E EA FE                                                 INW     WA              ; :
912D 2F EC FE                                                 DEW     SP              ; -(SP) = WA
9130 15 EB FE                                                 LDA     WA.1            ; :
9133 1E EC FE                                                 STR     SP              ; :
9136 2F EC FE                                                 DEW     SP              ; :
9139 15 EA FE                                                 LDA     WA.0            ; :
913C 1E EC FE                                                 STR     SP              ; :
913F 14 30 85                                                 JPA     NEXT            ; Done
                                                      
                                                      ; ------------------------------
                                                      ; MISC WORDS RELATED TO PRINTING
                                                      
9142 85 43 4F 55 4E D4                                HCOUNT: DB      ^5 "COUN" ^'T'                          ; ***** COUNT
9148 F5 90                                                    DW      HDOES
914A C1 8B 95 8A 42 8E 84 8A 73 8B 43 89              COUNT:  DW      DOCOL DUP ONEP SWAP CAT SEMIS
                                                      
9156 84 54 59 50 C5                                   HTYPE:  DB      ^4 "TYP" ^'E'                           ; ***** TYPE
915B 42 91                                                    DW      HCOUNT
915D C1 8B 00 8F D7 85 18 00                          TYPE:   DW      DOCOL DDUP ZBRAN +TYPE20
9165 5E 8A E4 89 84 8A 6D 86                                  DW      OVER PLUS SWAP XDO
916D 7F 86 73 8B B9 87 58 86 F8 FF                    TYPE10: DW      I CAT EMIT XLOOP +TYPE10
9177 C5 85 04 00                                              DW      BRAN +TYPE30
917B 73 8A                                            TYPE20: DW      DROP
917D 43 89                                            TYPE30: DW      SEMIS
                                                      
917F 89 2D 54 52 41 49 4C 49 4E C7                    HDTRAI: DB      ^9 "-TRAILIN" ^'G'                      ; ***** -TRAILING
9189 56 91                                                    DW      HTYPE
918B C1 8B 95 8A 76 8C 6D 86                          DTRAI:  DW      DOCOL DUP ZERO XDO
9193 5E 8A 5E 8A E4 89 7E 8C A9 8E                    DTRA10: DW      OVER OVER PLUS ONE SUB
919D 73 8B 97 8C A9 8E D7 85 08 00                            DW      CAT BL SUB ZBRAN +DTRA20
91A7 62 89 C5 85 06 00                                        DW      LEAVE BRAN +DTRA30
91AD 7E 8C A9 8E                                      DTRA20: DW      ONE SUB
91B1 58 86 E0 FF                                      DTRA30: DW      XLOOP +DTRA10
91B5 43 89                                                    DW      SEMIS
                                                      
91B7 84 28 2E 22 A9                                   HPDOTQ: DB      ^4 "(." '"' ^')'                        ; ***** (.")
91BC 7F 91                                                    DW      HDTRAI
91BE C1 8B 91 89 4A 91 95 8A 42 8E                    PDOTQ:  DW      DOCOL R COUNT DUP ONEP
91C8 85 89 E4 89 75 89 5D 91 43 89                            DW      FROMR PLUS TOR TYPE SEMIS
                                                      
91D2 C2 2E A2                                         HDOTQ:  DB      ^^2 "." ^'"'                            ; ***** ."
91D5 B7 91                                                    DW      HPDOTQ
91D7 C1 8B 93 85 22 00 9B 8D 63 8B D7 85 14 00        DOTQ:   DW      DOCOL LIT '"' STATE AT ZBRAN +DOTQ10
91E5 4A 90 BE 91 44 93 7D 8E 73 8B 42 8E                      DW      COMP PDOTQ WORD HERE CAT ONEP
91F1 8D 8E C5 85 0A 00                                        DW      ALLOT BRAN +DOTQ20
91F7 44 93 7D 8E 4A 91 5D 91                          DOTQ10: DW      WORD HERE COUNT TYPE
91FF 43 89                                            DOTQ20: DW      SEMIS
                                                      
                                                      ; ------------------------------
                                                      ; OUTER INTERPRETER
                                                      
9201 86 45 58 50 45 43 D4                             HEXPEC: DB      ^6 "EXPEC" ^'T'                         ; ***** EXPECT
9208 D2 91                                                    DW      HDOTQ
920A C1 8B 5E 8A E4 89 5E 8A 6D 86                    EXPEC:  DW      DOCOL OVER PLUS OVER XDO
9214 DC 87 95 8A 93 85 0E 00 C7 8C                    EXPE10: DW      KEY DUP LIT 14 PORIG
921E 63 8B B5 8E D7 85 2A 00                                  DW      AT EQUAL ZBRAN +EXPE20
9226 73 8A 95 8A 7F 86 B5 8E 95 8A 85 89 86 8C A9 8E          DW      DROP DUP I EQUAL DUP FROMR TWO SUB
9236 E4 89 75 89 D7 85 0A 00                                  DW      PLUS TOR ZBRAN +EXPE60
923E 93 85 07 00 C5 85 06 00                                  DW      LIT CH_BEL BRAN +EXPE70
9246 93 85 08 00                                      EXPE60: DW      LIT CH_BSP
924A C5 85 28 00                                      EXPE70: DW      BRAN +EXPE30
924E 95 8A 93 85 0A 00 B5 8E D7 85 0E 00              EXPE20: DW      DUP LIT 10 EQUAL ZBRAN +EXPE40
925A 62 89 73 8A 97 8C 76 8C C5 85 04 00                      DW      LEAVE DROP BL ZERO BRAN +EXPE50
9266 95 8A                                            EXPE40: DW      DUP
9268 7F 86 9B 8B 76 8C 7F 86 42 8E 88 8B              EXPE50: DW      I CSTOR ZERO I ONEP STORE
9274 B9 87 58 86 9C FF                                EXPE30: DW      EMIT XLOOP +EXPE10
927A 73 8A 43 89                                              DW      DROP SEMIS
                                                      
927E 85 51 55 45 52 D9                                HQUERY: DB      ^5 "QUER" ^'Y'                          ; ***** QUERY
9284 01 92                                                    DW      HEXPEC
9286 C1 8B E9 8C 63 8B 93 85 50 00 0A 92              QUERY:  DW      DOCOL TIB AT LIT 80 EXPEC
9292 76 8C 52 8D 88 8B 43 89                                  DW      ZERO IN STORE SEMIS
                                                      
929A C1 80                                            HNULL:  DB      ^^1 ^0                                  ; ***** <the NULL word>
929C 7E 92                                                    DW      HQUERY
929E C1 8B 49 8D 63 8B D7 85 26 00                    NULL:   DW      DOCOL BLK AT ZBRAN +NULL20
92A8 7E 8C 49 8D 06 8B 76 8C 52 8D 88 8B                      DW      ONE BLK PSTOR ZERO IN STORE
92B4 49 8D 63 8B B9 8C DC 98 9E 89 D7 85 08 00                DW      BLK AT BSCR MOD ZEQU ZBRAN +NULL10
92C2 E9 8F 85 89 73 8A                                        DW      QEXEC FROMR DROP
92C8 C5 85 06 00                                      NULL10: DW      BRAN +NULL30
92CC 85 89 73 8A                                      NULL20: DW      FROMR DROP
92D0 43 89                                            NULL30: DW      SEMIS
                                                      
92D2 84 46 49 4C CC                                   HFILL:  DB      ^4 "FIL" ^'L'                           ; ***** FILL
92D7 9A 92                                                    DW      HNULL
92D9 C1 8B 84 8A 75 89 5E 8A 9B 8B 95 8A              FILL:   DW      DOCOL SWAP TOR OVER CSTOR DUP
92E5 42 8E 85 89 7E 8C A9 8E 12 88 43 89                      DW      ONEP FROMR ONE SUB CMOVE SEMIS
                                                      
92F1 85 45 52 41 53 C5                                HERASE: DB      ^5 "ERAS" ^'E'                          ; ***** ERASE
92F7 D2 92                                                    DW      HFILL
92F9 C1 8B 76 8C D9 92 43 89                          ERASE:  DW      DOCOL ZERO FILL SEMIS
                                                      
9301 86 42 4C 41 4E 4B D3                             HBLANK: DB      ^6 "BLANK" ^'S'                         ; ***** BLANKS
9308 F1 92                                                    DW      HERASE
930A C1 8B 97 8C D9 92 43 89                          BLANK:  DW      DOCOL BL FILL SEMIS
                                                      
9312 84 48 4F 4C C4                                   HHOLD:  DB      ^4 "HOL" ^'D'                           ; ***** HOLD
9317 01 93                                                    DW      HBLANK
9319 C1 8B 93 85 FF FF D7 8D 06 8B                    HOLD:   DW      DOCOL LIT -1 HLD PSTOR
9323 D7 8D 63 8B 9B 8B 43 89                                  DW      HLD AT CSTOR SEMIS
                                                      
932B 83 50 41 C4                                      HPAD:   DB      ^3 "PA" ^'D'                            ; ***** PAD
932F 12 93                                                    DW      HHOLD
9331 C1 8B 7D 8E 93 85 54 00 E4 89 43 89              PAD:    DW      DOCOL HERE LIT 84 PLUS SEMIS
                                                      
933D 84 57 4F 52 C4                                   HWORD:  DB      ^4 "WOR" ^'D'                           ; ***** WORD
9342 2B 93                                                    DW      HPAD
9344 C1 8B 49 8D 63 8B D7 85 0C 00                    WORD:   DW      DOCOL BLK AT ZBRAN +WORD10
934E 49 8D 63 8B 50 9A C5 85 06 00                            DW      BLK AT BLOCK BRAN +WORD20
9358 E9 8C 63 8B                                      WORD10: DW      TIB AT
935C 52 8D 63 8B E4 89 84 8A 52 87                    WORD20: DW      IN AT PLUS SWAP ENCL
9366 7D 8E 93 85 22 00 0A 93 52 8D                            DW      HERE LIT 34 BLANK IN
9370 06 8B 5E 8A A9 8E 75 89 91 89 7D 8E 9B 8B E4 89          DW      PSTOR OVER SUB TOR R HERE CSTOR PLUS
9380 7D 8E 42 8E 85 89 12 88 43 89                            DW      HERE ONEP FROMR CMOVE SEMIS
                                                      
938A 88 28 4E 55 4D 42 45 52 A9                       HPNUMB: DB      ^8 "(NUMBER" ^')'                       ; ***** (NUMBER)
9393 3D 93                                                    DW      HWORD
9395 C1 8B                                            PNUMB:  DW      DOCOL
9397 42 8E 95 8A 75 89 73 8B                          PNUM10: DW      ONEP DUP TOR CAT
939F A6 8D 63 8B 8F 86 D7 85 2C 00                            DW      BASE AT DIGIT ZBRAN +PNUM30
93A9 84 8A A6 8D 63 8B 41 88 73 8A DB 8E A6 8D 63 8B          DW      SWAP BASE AT USTAR DROP ROT BASE AT
93B9 41 88 F4 89 B0 8D 63 8B 42 8E D7 85 08 00                DW      USTAR DPLUS DPL AT ONEP ZBRAN +PNUM20
93C7 7E 8C B0 8D 06 8B                                        DW      ONE DPL PSTOR
93CD 85 89 C5 85 C6 FF                                PNUM20: DW      FROMR BRAN +PNUM10
93D3 85 89 43 89                                      PNUM30: DW      FROMR SEMIS
                                                      
93D7 86 4E 55 4D 42 45 D2                             HNUMB:  DB      ^6 "NUMBE" ^'R'                         ; ***** NUMBER
93DE 8A 93                                                    DW      HPNUMB
93E0 C1 8B 76 8C 76 8C DB 8E 95 8A 42 8E 73 8B        NUMB:   DW      DOCOL ZERO ZERO ROT DUP ONEP CAT
93EE 93 85 2D 00 B5 8E 95 8A 75 89 A9 8E 93 85 FF FF          DW      LIT '-' EQUAL DUP TOR SUB LIT -1
93FE B0 8D 88 8B 95 93 95 8A                          NUMB10: DW      DPL STORE PNUMB DUP
9406 73 8B 97 8C A9 8E D7 85 16 00                            DW      CAT BL SUB ZBRAN +NUMB20
9410 95 8A 73 8B 93 85 2E 00 A9 8E                            DW      DUP CAT LIT '.' SUB
941A 76 8C B7 8F 76 8C C5 85 DC FF                            DW      ZERO QERR ZERO BRAN +NUMB10
9424 73 8A 85 89 D7 85 04 00                          NUMB20: DW      DROP FROMR ZBRAN +NUMB30
942C 1E 8A                                                    DW      DMINU
942E 43 89                                            NUMB30: DW      SEMIS
                                                      
9430 85 2D 46 49 4E C4                                HDFIND: DB      ^5 "-FIN" ^'D'                          ; ***** -FIND
9436 D7 93                                                    DW      HNUMB
9438 C1 8B 97 8C 44 93 7D 8E 4A 91 68 94              DFIND:  DW      DOCOL BL WORD HERE COUNT UPPER
9444 7D 8E 81 8D 63 8B 63 8B C1 86                            DW      HERE CONT AT AT PFIND
944E 95 8A 9E 89 D7 85 0A 00                                  DW      DUP ZEQU ZBRAN +DFIN10
9456 73 8A 7D 8E 4B 8F C1 86                                  DW      DROP HERE LATES PFIND
945E 43 89                                            DFIN10: DW      SEMIS
                                                      
9460 85 55 50 50 45 D2                                HUPPER: DB      ^5 "UPPE" ^'R'                          ; ***** UPPER
9466 30 94                                                    DW      HDFIND
9468 C1 8B 5E 8A E4 89 84 8A 6D 86                    UPPER:  DW      DOCOL OVER PLUS SWAP XDO
9472 7F 86 73 8B 93 85 60 00 CD 8E                    UPPE10: DW      I CAT LIT 0x60 GREAT
947C 7F 86 73 8B 93 85 7B 00 C1 8E                            DW      I CAT LIT 0x7B LESS
9486 95 88 D7 85 0A 00                                        DW      AND ZBRAN +UPPE20
948C 7F 86 93 85 20 00 23 8B                                  DW      I LIT 0x20 TOGGL
9494 58 86 DC FF                                      UPPE20: DW      XLOOP +UPPE10
9498 43 89                                                    DW      SEMIS
                                                      
949A 87 28 41 42 4F 52 54 A9                          HPABOR: DB      ^7 "(ABORT" ^')'                        ; ***** (ABORT)
94A2 60 94                                                    DW      HUPPER
94A4 C1 8B 18 97 43 89                                PABOR:  DW      DOCOL ABORT SEMIS
                                                      
94AA 85 45 52 52 4F D2                                HERROR: DB      ^5 "ERRO" ^'R'                          ; ***** ERROR
94B0 9A 94                                                    DW      HPABOR
94B2 C1 8B 03 8D 63 8B C7 89 D7 85 04 00              ERROR:  DW      DOCOL WARN AT ZLESS ZBRAN +ERRO10
94BE A4 94                                                    DW      PABOR
94C0 7D 8E 4A 91 5D 91 BE 91                          ERRO10: DW      HERE COUNT TYPE PDOTQ
94C8 03 20 3F 20                                              DB      3 32 '?' 32
94CC E5 9A DE 88 52 8D 63 8B 49 8D 63 8B EA 96 43 89          DW      MESS SPSTO IN AT BLK AT QUIT SEMIS
                                                      
94DC 83 49 44 AE                                      HIDDOT: DB      ^3 "ID" ^'.'                            ; ***** ID.
94E0 AA 94                                                    DW      HERROR
94E2 C1 8B 31 93 97 8C 93 85 5F 00 D9 92              IDDOT:  DW      DOCOL PAD BL LIT 95 FILL
94EE 95 8A 8F 8F 5B 8F 5E 8A A9 8E 31 93 84 8A 12 88          DW      DUP PFA LFA OVER SUB PAD SWAP CMOVE
94FE 31 93 4A 91 93 85 1F 00 95 88                            DW      PAD COUNT LIT 31 AND
9508 5E 8A 5E 8A 7E 8C A9 8E E4 89 95 8A 73 8B                DW      OVER OVER ONE SUB PLUS DUP CAT
9516 93 85 7F 00 95 88 84 8A 9B 8B                            DW      LIT 0x7F AND SWAP CSTOR
9520 5D 91 F1 8E 43 89                                        DW      TYPE SPACE SEMIS
                                                      
9526 86 43 52 45 41 54 C5                             HCREAT: DB      ^6 "CREAT" ^'E'                         ; ***** CREATE
952D DC 94                                                    DW      HIDDOT
952F C1 8B 38 94 D7 85 10 00                          CREAT:  DW      DOCOL DFIND ZBRAN +CREA10
9537 73 8A 79 8F E2 94 93 85 04 00 E5 9A F1 8E                DW      DROP NFA IDDOT LIT 4 MESS SPACE
9545 7D 8E 95 8A 73 8B F5 8C 63 8B 3B 98 42 8E 8D 8E  CREA10: DW      HERE DUP CAT WIDTH AT MIN ONEP ALLOT
9555 95 8A 93 85 A0 00 23 8B 7D 8E 7E 8C A9 8E                DW      DUP LIT 0xA0 TOGGL HERE ONE SUB
9563 93 85 80 00 23 8B 4B 8F 99 8E 8F 8D 63 8B 88 8B          DW      LIT 0x80 TOGGL LATES COMMA CURR AT STORE
9573 7D 8E 5E 8E 99 8E 43 89                                  DW      HERE TWOP COMMA SEMIS
                                                      
957B C9 5B 43 4F 4D 50 49 4C 45 DD                    HBCOMP: DB      ^^9 "[COMPILE" ^']'                     ; ***** [COMPILE]
9585 26 95                                                    DW      HCREAT
9587 C1 8B 38 94 9E 89 76 8C B7 8F                    BCOMP:  DW      DOCOL DFIND ZEQU ZERO QERR
9591 73 8A 6B 8F 99 8E 43 89                                  DW      DROP CFA COMMA SEMIS
                                                      
9599 C7 4C 49 54 45 52 41 CC                          HLITER: DB      ^^7 "LITERA" ^'L'                       ; ***** LITERAL
95A1 7B 95                                                    DW      HBCOMP
95A3 C1 8B 9B 8D 63 8B D7 85 08 00                    LITER:  DW      DOCOL STATE AT ZBRAN +LITE10
95AD 4A 90 93 85 99 8E                                        DW      COMP LIT COMMA
95B3 43 89                                            LITE10: DW      SEMIS
                                                      
95B5 C8 44 4C 49 54 45 52 41 CC                       HDLITE: DB      ^^8 "DLITERA" ^'L'                      ; ***** DLITERAL
95BE 99 95                                                    DW      HLITER
95C0 C1 8B 9B 8D 63 8B D7 85 08 00                    DLITE:  DW      DOCOL STATE AT ZBRAN +DLIT10
95CA 84 8A A3 95 A3 95                                        DW      SWAP LITER LITER
95D0 43 89                                            DLIT10: DW      SEMIS
                                                      
95D2 82 55 BC                                         HULESS: DB      ^2 "U" ^'<'                             ; ***** U<
95D5 B5 95                                                    DW      HDLITE
95D7 C1 8B 5E 8A 5E 8A B6 88 C7 89 D7 85 0C 00        ULESS:  DW      DOCOL OVER OVER XOR ZLESS ZBRAN +ULES10
95E5 73 8A C7 89 9E 89 C5 85 06 00                            DW      DROP ZLESS ZEQU BRAN +ULES20
95EF A9 8E C7 89                                      ULES10: DW      SUB ZLESS
95F3 43 89                                            ULES20: DW      SEMIS
                                                      
95F5 86 3F 53 54 41 43 CB                             HQSTAC: DB      ^6 "?STAC" ^'K'                         ; ***** ?STACK
95FC D2 95                                                    DW      HULESS
95FE C1 8B C7 88 D6 8C 63 8B 84 8A D7 95              QSTAC:  DW      DOCOL SPAT SZERO AT SWAP ULESS
960A 7E 8C B7 8F C7 88 7D 8E 93 85 80 00                      DW      ONE QERR SPAT HERE LIT 128
9616 E4 89 D7 95 86 8C B7 8F 43 89                            DW      PLUS ULESS TWO QERR SEMIS
                                                      
9620 89 49 4E 54 45 52 50 52 45 D4                    HINTER: DB      ^9 "INTERPRE" ^'T'                      ; ***** INTERPRET
962A F5 95                                                    DW      HQSTAC
962C C1 8B                                            INTER:  DW      DOCOL
962E 38 94 D7 85 1E 00                                INTE10: DW      DFIND ZBRAN +INTE40
9634 9B 8D 63 8B C1 8E D7 85 0A 00                            DW      STATE AT LESS ZBRAN +INTE20
963E 6B 8F 99 8E C5 85 06 00                                  DW      CFA COMMA BRAN +INTE30
9646 6B 8F A5 85                                      INTE20: DW      CFA EXEC
964A FE 95 C5 85 1C 00                                INTE30: DW      QSTAC BRAN +INTE70
9650 7D 8E E0 93 B0 8D 63 8B 42 8E D7 85 08 00        INTE40: DW      HERE NUMB DPL AT ONEP ZBRAN +INTE50
965E C0 95 C5 85 06 00                                        DW      DLITE BRAN +INTE60
9664 73 8A A3 95                                      INTE50: DW      DROP LITER
9668 FE 95                                            INTE60: DW      QSTAC
966A C5 85 C2 FF                                      INTE70: DW      BRAN +INTE10
                                                      
966E 89 49 4D 4D 45 44 49 41 54 C5                    HIMMED: DB      ^9 "IMMEDIAT" ^'E'                      ; ***** IMMEDIATE
9678 20 96                                                    DW      HINTER
967A C1 8B 4B 8F 93 85 40 00 23 8B 43 89              IMMED:  DW      DOCOL LATES LIT 0x40 TOGGL SEMIS
                                                      
9686 8A 56 4F 43 41 42 55 4C 41 52 D9                 HVOCAB: DB      ^10 "VOCABULAR" ^'Y'                    ; ***** VOCABULARY
9691 6E 96                                                    DW      HIMMED
9693 C1 8B ED 90 93 85 81 A0 99 8E                    VOCAB:  DW      DOCOL BUILD LIT 0xa081 COMMA
969D 8F 8D 63 8B 6B 8F 99 8E                                  DW      CURR AT CFA COMMA
96A5 7D 8E 27 8D 63 8B 99 8E 27 8D 88 8B FD 90                DW      HERE VOCL AT COMMA VOCL STORE DOES
96B3 5E 8E 81 8D 88 8B 43 89                          DOVOC:  DW      TWOP CONT STORE SEMIS
                                                      
96BB 8B 44 45 46 49 4E 49 54 49 4F 4E D3              HDEFIN: DB      ^11 "DEFINITION" ^'S'                   ; ***** DEFINITIONS
96C7 86 96                                                    DW      HVOCAB
96C9 C1 8B 81 8D 63 8B 8F 8D 88 8B 43 89              DEFIN:  DW      DOCOL CONT AT CURR STORE SEMIS
                                                      
96D5 81 A8                                            HPAREN: DB      ^1 ^'('                                 ; ***** (
96D7 BB 96                                                    DW      HDEFIN
96D9 C1 8B 93 85 29 00 44 93 43 89                    PAREN:  DW      DOCOL LIT ')' WORD SEMIS
                                                      
96E3 84 51 55 49 D4                                   HQUIT:  DB      ^4 "QUI" ^'T'                           ; ***** QUIT
96E8 D5 96                                                    DW      HPAREN
96EA C1 8B 76 8C 49 8D 88 8B 60 90                    QUIT:   DW      DOCOL ZERO BLK STORE LBRAC
96F4 00 89 C4 9E 86 92 2C 96 9B 8D 63 8B              QUIT10: DW      RPSTO CR QUERY INTER STATE AT
9700 9E 89 D7 85 08 00                                        DW      ZEQU ZBRAN +QUIT20
9706 BE 91                                                    DW      PDOTQ
9708 03 20 6F 6B                                              DB      3 32 "ok"
970C C5 85 E6 FF                                      QUIT20: DW      BRAN +QUIT10
                                                      
9710 85 41 42 4F 52 D4                                HABORT: DB      ^5 "ABOR" ^'T'                          ; ***** ABORT
9716 E3 96                                                    DW      HQUIT
9718 C1 8B                                            ABORT:  DW      DOCOL
971A 00 89 DE 88 AB 90 F1 8E C4 9E BE 91              ABOR10: DW      RPSTO SPSTO DEC SPACE CR PDOTQ
9726 13 4D 69 6E 69 6D 61 6C 2D 46 4F 52 54 48                DB      19 "Minimal-FORTH"
9734 20 76 20 30 2E 31                                        DB      32 "v" 32 "0.1"
973A F5 9E C9 96 EA 96                                        DW      FORTH DEFIN QUIT
                                                      
                                                      ; INCLUDE         coldwarm.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; COLD AND WARM START ENTRY POINTS
                                                      
9740 0E FE                                            CENT:   LDI     0xFE            ; Initialize Minimal stack pointer
9742 16 FF FF                                                 STA     0xFFFF          ; :
9745 0E 6D                                                    LDI     <COLD10         ; Start by executing COLD
9747 16 E8 FE                                                 STA     IP.0            ; :
974A 0E 97                                                    LDI     >COLD10         ; :
974C 16 E9 FE                                                 STA     IP.1            ; :
974F 14 30 85                                                 JPA     NEXT            ; ... and over to FORTH VM
                                                      
9752 0E FE                                            WENT:   LDI     0xFE            ; Initialize Minimal stack pointer
9754 16 FF FF                                                 STA     0xFFFF          ; :
9757 0E 1A                                                    LDI     <ABOR10         ; Start by executing ABORT
9759 16 E8 FE                                                 STA     IP.0            ; :
975C 0E 97                                                    LDI     >ABOR10         ; :
975E 16 E9 FE                                                 STA     IP.1            ; :
9761 14 30 85                                                 JPA     NEXT            ; ... and over to FORTH VM
                                                      
9764 84 43 4F 4C C4                                   HCOLD:  DB      ^4 "COL" ^'D'                           ; ***** COLD
9769 10 97                                                    DW      HABORT
976B C1 8B                                            COLD:   DW      DOCOL
                                                      COLD10: ; Init FORTH registers
976D 00 89 DE 88 22 89                                        DW      RPSTO SPSTO UPSTO
                                                              ; Set FORTH vocabulary
9773 93 85 0C 00 C7 8C 63 8B                                  DW      LIT 12 PORIG AT
977B 93 85 06 00 93 85 F5 9E E4 89 88 8B                      DW      LIT 6 LIT FORTH PLUS STORE
                                                              ; Init 12 items (24 bytes) in user area ...
                                                              ; ... with values from boot table
9787 93 85 12 00 C7 8C                                        DW      LIT 18 PORIG
978D 93 85 10 00 C7 8C 63 8B 93 85 06 00 E4 89                DW      LIT 16 PORIG AT LIT 6 PLUS
979B 93 85 18 00 12 88                                        DW      LIT 24 CMOVE
                                                              ; Erase disk buffers
97A1 93 85 22 00 C7 8C 63 8B 93 85 24 00 C7 8C 63 8B          DW      LIT 34 PORIG AT LIT 36 PORIG AT
97B1 5E 8A A9 8E F9 92                                        DW      OVER SUB ERASE
                                                              ; Initialize some of the user variables
97B7 76 8C 5C 8D 88 8B                                        DW      ZERO OUT STORE
97BD 33 8D 63 8B E1 8D 88 8B                                  DW      FIRST AT USE STORE
97C5 33 8D 63 8B EC 8D 88 8B                                  DW      FIRST AT PREV STORE
                                                              ; Continue via ABORT
97CD 18 97                                                    DW      ABORT
                                                      
                                                      ; INCLUDE         math.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; MATHEMATICS WORDS
                                                      
97CF 84 53 2D 3E C4                                   HSTOD:  DB      ^4 "S->" ^'D'                           ; ***** S->D
97D4 64 97                                                    DW      HCOLD
97D6 D8 97                                            STOD:   DW      STOD0
97D8 2C F2 FE                                         STOD0:  CLW     R1              ; Assume high word zero
97DB 2E EC FE                                                 INW     SP              ; Get operand high byte
97DE 1D EC FE                                                 LDR     SP              ; :
97E1 11 00                                                    CPI     0               ; Negative?
97E3 3F EC 97                                                 BMI     STOD10          ; YES: Push 0xFFFF
97E6 2F EC FE                                                 DEW     SP              ; :
97E9 14 1E 85                                                 JPA     PUSH            ; NO: Push 0x0000
97EC 2F EC FE                                         STOD10: DEW     SP              ; :
97EF 2F F2 FE                                                 DEW     R1              ; Make 0x0000 into 0xFFFF
97F2 14 1E 85                                                 JPA     PUSH            ; Done
                                                      
97F5 82 2B AD                                         HPM:    DB      ^2 "+" ^'-'                             ; ***** +-
97F8 CF 97                                                    DW      HSTOD
97FA C1 8B C7 89 D7 85 04 00                          PM:     DW      DOCOL ZLESS ZBRAN +PM10
9802 0A 8A                                                    DW      MINUS
9804 43 89                                            PM10:   DW      SEMIS
                                                      
9806 83 44 2B AD                                      HDPM:   DB      ^3 "D+" ^'-'                            ; ***** D+-
980A F5 97                                                    DW      HPM
980C C1 8B C7 89 D7 85 04 00                          DPM:    DW      DOCOL ZLESS ZBRAN +DPM10
9814 1E 8A                                                    DW      DMINU
9816 43 89                                            DPM10:  DW      SEMIS
                                                      
9818 83 41 42 D3                                      HABS:   DB      ^3 "AB" ^'S'                            ; ***** ABS
981C 06 98                                                    DW      HDPM
981E C1 8B 95 8A FA 97 43 89                          ABS:    DW      DOCOL DUP PM SEMIS
                                                      
9826 84 44 41 42 D3                                   HDABS:  DB      ^4 "DAB" ^'S'                           ; ***** DABS
982B 18 98                                                    DW      HABS
982D C1 8B 95 8A 0C 98 43 89                          DABS:   DW      DOCOL DUP DPM SEMIS
                                                      
9835 83 4D 49 CE                                      HMIN:   DB      ^3 "MI" ^'N'                            ; ***** MIN
9839 26 98                                                    DW      HDABS
983B C1 8B 5E 8A 5E 8A CD 8E D7 85 04 00              MIN:    DW      DOCOL OVER OVER GREAT ZBRAN +MIN10
9847 84 8A                                                    DW      SWAP
9849 73 8A 43 89                                      MIN10:  DW      DROP SEMIS
                                                      
984D 83 4D 41 D8                                      HMAX:   DB      ^3 "MA" ^'X'                            ; ***** MAX
9851 35 98                                                    DW      HMIN
9853 C1 8B 5E 8A 5E 8A C1 8E D7 85 04 00              MAX:    DW      DOCOL OVER OVER LESS ZBRAN +MAX10
985F 84 8A                                                    DW      SWAP
9861 73 8A 43 89                                      MAX10:  DW      DROP SEMIS
                                                      
9865 82 4D AA                                         HMSTAR: DB      ^2 "M" ^'*'                             ; ****** M*
9868 4D 98                                                    DW      HMAX
986A C1 8B 5E 8A 5E 8A B6 88 75 89 1E 98 84 8A 1E 98  MSTAR:  DW      DOCOL OVER OVER XOR TOR ABS SWAP ABS
987A 41 88 85 89 0C 98 43 89                                  DW      USTAR FROMR DPM SEMIS
                                                      
9882 82 4D AF                                         HMSLAS: DB      ^2 "M" ^'/'                             ; ***** M/
9885 65 98                                                    DW      HMSTAR
9887 C1 8B 5E 8A 75 89 75 89 2D 98 91 89 1E 98        MSLAS:  DW      DOCOL OVER TOR TOR DABS R ABS
9895 75 88 85 89 91 89 B6 88 FA 97 84 8A                      DW      USLAS FROMR R XOR PM SWAP
98A1 85 89 FA 97 84 8A 43 89                                  DW      FROMR PM SWAP SEMIS
                                                      
98A9 81 AA                                            HSTAR:  DB      ^1 ^'*'                                 ; ***** *
98AB 82 98                                                    DW      HMSLAS
98AD C1 8B 6A 98 73 8A 43 89                          STAR:   DW      DOCOL MSTAR DROP SEMIS
                                                      
98B5 84 2F 4D 4F C4                                   HSLMOD: DB      ^4 "/MO" ^'D'                           ; ***** /MOD
98BA A9 98                                                    DW      HSTAR
98BC C1 8B 75 89 D6 97 85 89 87 98 43 89              SLMOD:  DW      DOCOL TOR STOD FROMR MSLAS SEMIS
                                                      
98C8 81 AF                                            HSLAS:  DB      ^1 ^'/'                                 ; ***** /
98CA B5 98                                                    DW      HSLMOD
98CC C1 8B BC 98 84 8A 73 8A 43 89                    SLASH:  DW      DOCOL SLMOD SWAP DROP SEMIS
                                                      
98D6 83 4D 4F C4                                      HMOD:   DB      ^3 "MO" ^'D'                            ; ***** MOD
98DA C8 98                                                    DW      HSLAS
98DC C1 8B BC 98 73 8A 43 89                          MOD:    DW      DOCOL SLMOD DROP SEMIS
                                                      
98E4 85 2A 2F 4D 4F C4                                HSSMOD: DB      ^5 "*/MO" ^'D'                          ; ***** */MOD
98EA D6 98                                                    DW      HMOD
98EC C1 8B 75 89 6A 98 85 89 87 98 43 89              SSMOD:  DW      DOCOL TOR MSTAR FROMR MSLAS SEMIS
                                                      
98F8 82 2A AF                                         HSSLA:  DB      ^2 "*" ^'/'                             ; ***** */
98FB E4 98                                                    DW      HSSMOD
98FD C1 8B EC 98 84 8A 73 8A 43 89                    SSLA:   DW      DOCOL SSMOD SWAP DROP SEMIS
                                                      
9907 85 4D 2F 4D 4F C4                                HMSMOD: DB      ^5 "M/MO" ^'D'                          ; ***** M/MOD
990D E4 98                                                    DW      HSSMOD
990F C1 8B 75 89 76 8C 91 89 75 88 85 89              MSMOD:  DW      DOCOL TOR ZERO R USLAS FROMR
991B 84 8A 75 89 75 88 85 89 43 89                            DW      SWAP TOR USLAS FROMR SEMIS
                                                      
                                                      ; INCLUDE         diskio.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; DISK I/O
                                                      
9925 83 52 2F D7                                      HRW:    DB      ^3 "R/" ^'W'                            ; ***** R/W
9929 07 99                                                    DW      HMSMOD
992B C1 8B 75 89                                      RW:     DW      DOCOL TOR
992F 93 85 20 00 BC 98 42 8E 48 8B                            DW      LIT 32 SLMOD ONEP TBANK
9939 93 85 00 04 AD 98 85 89 D7 85 04 00                      DW      LIT 1024 STAR FROMR ZBRAN +RW10
9945 84 8A                                                    DW      SWAP
9947 93 85 00 04 12 88 43 89                          RW10:   DW      LIT 1024 CMOVE SEMIS
                                                      
994F 84 2B 42 55 C6                                   HPBUF:  DB      ^4 "+BU" ^'F'                           ; ***** +BUF
9954 25 99                                                    DW      HRW
9956 C1 8B AD 8C 93 85 04 00 E4 89 E4 89              PBUF:   DW      DOCOL BBUF LIT 4 PLUS PLUS
9962 95 8A 3F 8D 63 8B B5 8E D7 85 08 00                      DW      DUP LIMIT AT EQUAL ZBRAN +PBUF10
996E 73 8A 33 8D 63 8B                                        DW      DROP FIRST AT
9974 95 8A EC 8D 63 8B A9 8E 43 89                    PBUF10: DW      DUP PREV AT SUB SEMIS
                                                      
997E 86 55 50 44 41 54 C5                             HUPDAT: DB      ^6 "UPDAT" ^'E'                         ; ***** UPDATE
9985 4F 99                                                    DW      HPBUF
9987 C1 8B EC 8D 63 8B 63 8B 93 85 00 80              UPDAT:  DW      DOCOL PREV AT AT LIT 0x8000
9993 A5 88 EC 8D 63 8B 88 8B 43 89                            DW      OR PREV AT STORE SEMIS
                                                      
999D 8D 45 4D 50 54 59 2D 42 55 46 46 45 52 D3        HMTBUF: DB      ^13 "EMPTY-BUFFER" ^'S'                 ; ***** EMPTY-BUFFERS
99AB 7E 99                                                    DW      HUPDAT
99AD C1 8B 33 8D 63 8B 3F 8D 63 8B                    MTBUF:  DW      DOCOL FIRST AT LIMIT AT
99B7 5E 8A A9 8E F9 92 43 89                                  DW      OVER SUB ERASE SEMIS
                                                      
99BF 85 46 4C 55 53 C8                                HFLUSH: DB      ^5 "FLUS" ^'H'                          ; ***** FLUSH
99C5 9D 99                                                    DW      HMTBUF
99C7 C1 8B 3F 8D 63 8B 33 8D 63 8B 6D 86              FLUSH:  DW      DOCOL LIMIT AT FIRST AT XDO
99D3 7F 86 63 8B C7 89 D7 85 14 00                    FLUS10: DW      I AT ZLESS ZBRAN +FLUS20
99DD 7F 86 5E 8E 7F 86 63 8B 93 85 FF 7F                      DW      I TWOP I AT LIT 0x7FFF
99E9 95 88 76 8C 2B 99                                        DW      AND ZERO RW
99EF AD 8C 93 85 04 00 E4 89 0B 86 DA FF              FLUS20: DW      BBUF LIT 4 PLUS XPLOO +FLUS10
99FB AD 99 43 89                                              DW      MTBUF SEMIS
                                                      
99FF 86 42 55 46 46 45 D2                             HBUFFE: DB      ^6 "BUFFE" ^'R'                         ; ***** BUFFER
9A06 BF 99                                                    DW      HFLUSH
9A08 C1 8B E1 8D 63 8B 95 8A 75 89                    BUFFE:  DW      DOCOL USE AT DUP TOR
9A12 56 99 D7 85 FC FF                                BUFF10: DW      PBUF ZBRAN +BUFF10
9A18 E1 8D 88 8B 91 89 63 8B C7 89 D7 85 14 00                DW      USE STORE R AT ZLESS ZBRAN +BUFF20
9A26 91 89 5E 8E 91 89 63 8B 93 85 FF 7F                      DW      R TWOP R AT LIT 0x7FFF
9A32 95 88 76 8C 2B 99                                        DW      AND ZERO RW
9A38 91 89 88 8B 91 89 EC 8D 88 8B 85 89 5E 8E 43 89  BUFF20: DW      R STORE R PREV STORE FROMR TWOP SEMIS
                                                      
9A48 85 42 4C 4F 43 CB                                HBLOCK: DB      ^5 "BLOC" ^'K'                          ; ***** BLOCK
9A4E FF 99                                                    DW      HBUFFE
9A50 C1 8B 75 89 EC 8D 63 8B 95 8A 63 8B              BLOCK:  DW      DOCOL TOR PREV AT DUP AT
9A5C 93 85 FF 7F 95 88 91 89 A9 8E D7 85 36 00                DW      LIT 0x7FFF AND R SUB ZBRAN +BLOC30
9A6A 56 99 9E 89 D7 85 14 00                          BLOC10: DW      PBUF ZEQU ZBRAN +BLOC20
9A72 73 8A 91 89 08 9A 95 8A 91 89                            DW      DROP R BUFFE DUP R
9A7C 7E 8C 2B 99 86 8C A9 8E                                  DW      ONE RW TWO SUB
9A84 95 8A 63 8B 93 85 FF 7F 95 88 91 89              BLOC20: DW      DUP AT LIT 0x7FFF AND R
9A90 A9 8E 9E 89 D7 85 D4 FF                                  DW      SUB ZEQU ZBRAN +BLOC10
9A98 95 8A EC 8D 88 8B                                        DW      DUP PREV STORE
9A9E 85 89 73 8A 5E 8E 43 89                          BLOC30: DW      FROMR DROP TWOP SEMIS
                                                      
9AA6 86 28 4C 49 4E 45 A9                             HPLINE: DB      ^6 "(LINE" ^')'                         ; ***** (LINE)
9AAD 48 9A                                                    DW      HBLOCK
9AAF C1 8B 75 89 A1 8C AD 8C EC 98 85 89 B9 8C        PLINE:  DW      DOCOL TOR CL BBUF SSMOD FROMR BSCR
9ABD AD 98 E4 89 50 9A E4 89 A1 8C 43 89                      DW      STAR PLUS BLOCK PLUS CL SEMIS
                                                      
9AC9 85 2E 4C 49 4E C5                                HDLINE: DB      ^5 ".LIN" ^'E'                          ; ***** .LINE
9ACF A6 9A                                                    DW      HPLINE
9AD1 C1 8B AF 9A 8B 91 5D 91 43 89                    DLINE:  DW      DOCOL PLINE DTRAI TYPE SEMIS
                                                      
9ADB 87 4D 45 53 53 41 47 C5                          HMESS:  DB      ^7 "MESSAG" ^'E'                        ; ***** MESSAGE
9AE3 C9 9A                                                    DW      HDLINE
9AE5 C1 8B 03 8D 63 8B D7 85 1A 00                    MESS:   DW      DOCOL WARN AT ZBRAN +MESS20
9AEF 00 8F D7 85 10 00                                        DW      DDUP ZBRAN +MESS10
9AF5 93 85 10 00 BC 98 93 85 04 00 E4 89 D1 9A                DW      LIT 16 SLMOD LIT 4 PLUS DLINE
9B03 C5 85 0D 00                                      MESS10: DW      BRAN +MESS30
9B07 BE 91                                            MESS20: DW      PDOTQ
9B09 06 4D 53 47 20 23 20                                     DB      6 "MSG" 32 '#' 32
9B10 CE 9D                                                    DW      DOT
9B12 43 89                                            MESS30: DW      SEMIS
                                                      
9B14 84 4C 4F 41 C4                                   HLOAD:  DB      ^4 "LOA" ^'D'                           ; ***** LOAD
9B19 DB 9A                                                    DW      HMESS
9B1B C1 8B 49 8D 63 8B 75 89 52 8D 63 8B 75 89 76 8C  LOAD:   DW      DOCOL BLK AT TOR IN AT TOR ZERO IN
9B2B 52 8D 88 8B B9 8C AD 98 49 8D 88 8B 2C 96 85 89          DW      STORE BSCR STAR BLK STORE INTER FROMR
9B3B 52 8D 88 8B 85 89 49 8D 88 8B 43 89                      DW      IN STORE FROMR BLK STORE SEMIS
                                                      
9B47 C3 2D 2D BE                                      HARROW: DB      ^^3 "--" ^'>'                           ; ***** -->
9B4B 14 9B                                                    DW      HLOAD
9B4D C1 8B 30 90 76 8C 52 8D 88 8B B9 8C 49 8D 63 8B  ARROW:  DW      DOCOL QLOAD ZERO IN STORE BSCR BLK AT
9B5D 5E 8A DC 98 A9 8E 49 8D 06 8B 43 89                      DW      OVER MOD SUB BLK PSTOR SEMIS
                                                      
                                                      ; INCLUDE         misc.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; MISCELLANEOUS HIGHER LEVEL
                                                      
9B69 C1 A7                                            HTICK:  DB      ^^1 ^39                                 ; ***** '
9B6B 47 9B                                                    DW      HARROW
9B6D C1 8B 38 94 9E 89 76 8C B7 8F 73 8A A3 95 43 89  TICK:   DW      DOCOL DFIND ZEQU ZERO QERR DROP LITER SEMIS
                                                      
9B7D 86 46 4F 52 47 45 D4                             HFORGE: DB      ^6 "FORGE" ^'T'                         ; ***** FORGET
9B84 69 9B                                                    DW      HTICK
9B86 C1 8B 8F 8D 63 8B 81 8D 63 8B A9 8E 93 85 18 00  FORGE:  DW      DOCOL CURR AT CONT AT SUB LIT 24
9B96 B7 8F 6D 9B 95 8A 0F 8D 63 8B C1 8E 93 85 15 00          DW      QERR TICK DUP FENCE AT LESS LIT 21
9BA6 B7 8F 95 8A 79 8F 18 8D 88 8B 5B 8F 63 8B 81 8D          DW      QERR DUP NFA DP STORE LFA AT CONT
9BB6 63 8B 88 8B 43 89                                        DW      AT STORE SEMIS
                                                      
9BBC 84 42 41 43 CB                                   HBACK:  DB      ^4 "BAC" ^'K'                           ; ***** BACK
9BC1 7D 9B                                                    DW      HFORGE
9BC3 C1 8B 7D 8E A9 8E 99 8E 43 89                    BACK:   DW      DOCOL HERE SUB COMMA SEMIS
                                                      
9BCD C5 42 45 47 49 CE                                HBEGIN: DB      ^^5 "BEGI" ^'N'                         ; ***** BEGIN
9BD3 BC 9B                                                    DW      HBACK
9BD5 C1 8B D1 8F 7D 8E 7E 8C 43 89                    BEGIN:  DW      DOCOL QCOMP HERE ONE SEMIS
                                                      
9BDF C5 45 4E 44 49 C6                                HENDIF: DB      ^^5 "ENDI" ^'F'                         ; ***** ENDIF
9BE5 CD 9B                                                    DW      HBEGIN
9BE7 C1 8B D1 8F 86 8C 00 90 7D 8E                    ENDIF:  DW      DOCOL QCOMP TWO QPAIR HERE
9BF1 5E 8A A9 8E 84 8A 88 8B 43 89                            DW      OVER SUB SWAP STORE SEMIS
                                                      
9BFB C4 54 48 45 CE                                   HTHEN:  DB      ^^4 "THE" ^'N'                          ; ***** THEN
9C00 DF 9B                                                    DW      HENDIF
9C02 C1 8B E7 9B 43 89                                THEN:   DW      DOCOL ENDIF SEMIS
                                                      
9C08 C2 44 CF                                         HDO:    DB      ^^2 "D" ^'O'                            ; ***** DO
9C0B FB 9B                                                    DW      HTHEN
9C0D C1 8B 4A 90 6D 86 7D 8E 93 85 03 00 43 89        DO:     DW      DOCOL COMP XDO HERE LIT 3 SEMIS
                                                      
9C1B C4 4C 4F 4F D0                                   HLOOP:  DB      ^^4 "LOO" ^'P'                          ; ***** LOOP
9C20 08 9C                                                    DW      HDO
9C22 C1 8B 93 85 03 00 00 90 4A 90 58 86 C3 9B 43 89  LOOP:   DW      DOCOL LIT 3 QPAIR COMP XLOOP BACK SEMIS
                                                      
9C32 C5 2B 4C 4F 4F D0                                HPLOOP: DB      ^^5 "+LOO" ^'P'                         ; ***** +LOOP
9C38 1B 9C                                                    DW      HLOOP
9C3A C1 8B 93 85 03 00 00 90 4A 90 0B 86 C3 9B 43 89  PLOOP:  DW      DOCOL LIT 3 QPAIR COMP XPLOO BACK SEMIS
                                                      
9C4A C5 55 4E 54 49 CC                                HUNTIL: DB      ^^5 "UNTI" ^'L'                         ; ***** UNTIL
9C50 32 9C                                                    DW      HPLOOP
9C52 C1 8B 7E 8C 00 90 4A 90 D7 85 C3 9B 43 89        UNTIL:  DW      DOCOL ONE QPAIR COMP ZBRAN BACK SEMIS
                                                      
9C60 C3 45 4E C4                                      HEND:   DB      ^^3 "EN" ^'D'                           ; ***** ENDI
9C64 4A 9C                                                    DW      HUNTIL
9C66 C1 8B 52 9C 43 89                                END:    DW      DOCOL UNTIL SEMIS
                                                      
9C6C C5 41 47 41 49 CE                                HAGAIN: DB      ^^5 "AGAI" ^'N'                         ; ***** AGAIN
9C72 60 9C                                                    DW      HEND
9C74 C1 8B 7E 8C 00 90 4A 90 C5 85 C3 9B 43 89        AGAIN:  DW      DOCOL ONE QPAIR COMP BRAN BACK SEMIS
                                                      
9C82 C6 52 45 50 45 41 D4                             HREPEA: DB      ^^6 "REPEA" ^'T'                        ; ***** REPEAT
9C89 6C 9C                                                    DW      HAGAIN
9C8B C1 8B 75 89 75 89 74 9C 85 89 85 89              REPEA:  DW      DOCOL TOR TOR AGAIN FROMR FROMR
9C97 86 8C A9 8E E7 9B 43 89                                  DW      TWO SUB ENDIF SEMIS
                                                      
9C9F C2 49 C6                                         HIF:    DB      ^^2 "I" ^'F'                            ; ***** IF
9CA2 82 9C                                                    DW      HREPEA
9CA4 C1 8B 4A 90 D7 85 7D 8E 76 8C 99 8E 86 8C 43 89  IF:     DW      DOCOL COMP ZBRAN HERE ZERO COMMA TWO SEMIS
                                                      
9CB4 C4 45 4C 53 C5                                   HELSE:  DB      ^^4 "ELS" ^'E'                          ; ***** ELSE
9CB9 9F 9C                                                    DW      HIF
9CBB C1 8B 86 8C 00 90 4A 90 C5 85 7D 8E 86 8C 99 8E  ELSE:   DW      DOCOL TWO QPAIR COMP BRAN HERE TWO COMMA
9CCB 84 8A 86 8C E7 9B 86 8C 43 89                            DW      SWAP TWO ENDIF TWO SEMIS
                                                      
9CD5 C5 57 48 49 4C C5                                HWHILE: DB      ^^5 "WHIL" ^'E'                         ; ***** WHILE
9CDB B4 9C                                                    DW      HELSE
9CDD C1 8B A4 9C 5E 8E 43 89                          WHILE:  DW      DOCOL IF TWOP SEMIS
                                                      
9CE5 86 53 50 41 43 45 D3                             HSPACS: DB      ^6 "SPACE" ^'S'                         ; ***** SPACES
9CEC D5 9C                                                    DW      HWHILE
9CEE C1 8B 76 8C 53 98 00 8F D7 85 0C 00              SPACS:  DW      DOCOL ZERO MAX DDUP ZBRAN +SPAC20
9CFA 76 8C 6D 86                                              DW      ZERO XDO
9CFE F1 8E 58 86 FC FF                                SPAC10: DW      SPACE XLOOP +SPAC10
9D04 43 89                                            SPAC20: DW      SEMIS
                                                      
9D06 82 3C A3                                         HBDIGS: DB      ^2 "<" ^'#'                             ; ***** <#
9D09 E5 9C                                                    DW      HSPACS
9D0B C1 8B 31 93 D7 8D 88 8B 43 89                    BDIGS:  DW      DOCOL PAD HLD STORE SEMIS
                                                      
9D15 82 23 BE                                         HEDIGS: DB      ^2 "#" ^'>'                             ; ***** #>
9D18 06 9D                                                    DW      HBDIGS
9D1A C1 8B 73 8A 73 8A D7 8D 63 8B                    EDIGS:  DW      DOCOL DROP DROP HLD AT
9D24 31 93 5E 8A A9 8E 43 89                                  DW      PAD OVER SUB SEMIS
                                                      
9D2C 84 53 49 47 CE                                   HSIGN:  DB      ^4 "SIG" ^'N'                           ; ***** SIGN
9D31 15 9D                                                    DW      HEDIGS
9D33 C1 8B DB 8E C7 89 D7 85 08 00                    SIGN:   DW      DOCOL ROT ZLESS ZBRAN +SIGN10
9D3D 93 85 2D 00 19 93                                        DW      LIT '-' HOLD
9D43 43 89                                            SIGN10: DW      SEMIS
                                                      
9D45 81 A3                                            HDIG:   DB      ^1 ^'#'                                 ; ***** #
9D47 2C 9D                                                    DW      HSIGN
9D49 C1 8B A6 8D 63 8B 0F 99 DB 8E                    DIG:    DW      DOCOL BASE AT MSMOD ROT
9D53 93 85 09 00 5E 8A C1 8E D7 85 08 00                      DW      LIT 9 OVER LESS ZBRAN +DIG10
9D5F 93 85 07 00 E4 89                                        DW      LIT 7 PLUS
9D65 93 85 30 00 E4 89 19 93 43 89                    DIG10:  DW      LIT '0' PLUS HOLD SEMIS
                                                      
9D6F 82 23 D3                                         HDIGS:  DB      ^2 "#" ^'S'                             ; ***** #S
9D72 45 9D                                                    DW      HDIG
9D74 C1 8B                                            DIGS:   DW      DOCOL
9D76 49 9D 5E 8A 5E 8A A5 88 9E 89 D7 85 F4 FF        DIGS10: DW      DIG OVER OVER OR ZEQU ZBRAN +DIGS10
9D84 43 89                                                    DW      SEMIS
                                                      
9D86 83 44 2E D2                                      HDDOTR: DB      ^3 "D." ^'R'                            ; ***** D.R
9D8A 6F 9D                                                    DW      HDIGS
9D8C C1 8B 75 89 84 8A 5E 8A 2D 98                    DDOTR:  DW      DOCOL TOR SWAP OVER DABS
9D96 0B 9D 74 9D 33 9D 1A 9D                                  DW      BDIGS DIGS SIGN EDIGS
9D9E 85 89 5E 8A A9 8E EE 9C 5D 91 43 89                      DW      FROMR OVER SUB SPACS TYPE SEMIS
                                                      
9DAA 82 2E D2                                         HDOTR:  DB      ^2 "." ^'R'                             ; ***** .R
9DAD 86 9D                                                    DW      HDDOTR
9DAF C1 8B 75 89 D6 97 85 89 8C 9D 43 89              DOTR:   DW      DOCOL TOR STOD FROMR DDOTR SEMIS
                                                      
9DBB 82 44 AE                                         HDDOT:  DB      ^2 "D" ^'.'                             ; ***** D.
9DBE AA 9D                                                    DW      HDOTR
9DC0 C1 8B 76 8C 8C 9D F1 8E 43 89                    DDOT:   DW      DOCOL ZERO DDOTR SPACE SEMIS
                                                      
9DCA 81 AE                                            HDOT:   DB      ^1 ^'.'                                 ; ***** .
9DCC BB 9D                                                    DW      HDDOT
9DCE C1 8B D6 97 C0 9D 43 89                          DOT:    DW      DOCOL STOD DDOT SEMIS
                                                      
9DD6 81 BF                                            HQUEST: DB      ^1 ^'?'                                 ; ***** ?
9DD8 CA 9D                                                    DW      HDOT
9DDA C1 8B 63 8B CE 9D 43 89                          QUEST:  DW      DOCOL AT DOT SEMIS
                                                      
9DE2 82 55 AE                                         HUDOT:  DB      ^2 "U" ^'.'                             ; ***** U.
9DE5 D6 9D                                                    DW      HQUEST
9DE7 C1 8B 76 8C C0 9D 43 89                          UDOT:   DW      DOCOL ZERO DDOT SEMIS
                                                      
                                                      ; ----------------------------------
                                                      ; UTILITY WORDS
                                                      
9DEF 84 4C 49 53 D4                                   HLIST:  DB      ^4 "LIS" ^'T'                           ; ***** LIST
9DF4 E2 9D                                                    DW      HUDOT
9DF6 C1 8B AB 90 C4 9E 95 8A 66 8D 88 8B BE 91        LIST:   DW      DOCOL DEC CR DUP SCR STORE PDOTQ
9E04 06 53 43 52 20 23 20                                     DB      6 "SCR" 32 "#" 32
9E0B CE 9D 93 85 10 00 76 8C 6D 86                            DW      DOT LIT 16 ZERO XDO
9E15 C4 9E 7F 86 8E 8C AF 9D F1 8E                    LIST10: DW      CR I THREE DOTR SPACE
9E1F 7F 86 66 8D 63 8B D1 9A 58 86 EC FF                      DW      I SCR AT DLINE XLOOP +LIST10
9E2B C4 9E 43 89                                              DW      CR SEMIS
                                                      
9E2F 85 49 4E 44 45 D8                                HINDEX: DB      ^5 "INDE" ^'X'                          ; ***** INDEX
9E35 EF 9D                                                    DW      HLIST
9E37 C1 8B C4 9E 42 8E 84 8A 6D 86                    INDEX:  DW      DOCOL CR ONEP SWAP XDO
9E41 C4 9E 7F 86 8E 8C AF 9D F1 8E 76 8C 7F 86 D1 9A  INDE10: DW      CR I THREE DOTR SPACE ZERO I DLINE
9E51 F9 87 D7 85 04 00                                        DW      QTERM ZBRAN +INDE20
9E57 62 89                                                    DW      LEAVE
9E59 58 86 E6 FF                                      INDE20: DW      XLOOP +INDE10
9E5D 43 89                                                    DW      SEMIS
                                                      
9E5F 85 56 4C 49 53 D4                                HVLIST: DB      ^5 "VLIS" ^'T'                          ; ***** VLIST
9E65 2F 9E                                                    DW      HINDEX
9E67 C1 8B 93 85 80 00 5C 8D 88 8B 81 8D 63 8B 63 8B  VLIST:  DW      DOCOL LIT 128 OUT STORE CONT AT AT
9E77 5C 8D 63 8B 93 85 1C 00 CD 8E D7 85 0A 00        VLIS10: DW      OUT AT LIT 28 GREAT ZBRAN +VLIS20
9E85 C4 9E 76 8C 5C 8D 88 8B                                  DW      CR ZERO OUT STORE
9E8D 95 8A E2 94 F1 8E 8F 8F 5B 8F 63 8B              VLIS20: DW      DUP IDDOT SPACE PFA LFA AT
9E99 95 8A 9E 89 F9 87 A5 88 D7 85 D4 FF                      DW      DUP ZEQU QTERM OR ZBRAN +VLIS10
9EA5 73 8A 43 89                                              DW      DROP SEMIS
                                                      
9EA9 C5 3B 43 4F 44 C5                                HSCODE: DB      ^^5 ";COD" ^'E'                         ; ***** ;CODE
9EAF 5F 9E                                                    DW      HVLIST
9EB1 C1 8B 13 90 4A 90 D5 90 60 90 83 90 43 89        SCODE:  DW      DOCOL QCSP COMP PSCOD LBRAC SMUDG SEMIS
                                                      
9EBF 82 43 D2                                         HCR:    DB      ^2 "C" ^'R'                             ; ***** CR
9EC2 A9 9E                                                    DW      HSCODE
9EC4 C1 8B 93 85 0D 00 B9 87 93 85 0A 00 B9 87 43 89  CR:     DW      DOCOL LIT 13 EMIT LIT 10 EMIT SEMIS
                                                      
9ED4 84 4E 4F 4F D0                                   HNOOP:  DB      ^4 "NOO" ^'P'                           ; ***** NOOP
9ED9 BF 9E                                                    DW      HCR
9EDB C1 8B 43 89                                      NOOP:   DW      DOCOL SEMIS
                                                      
9EDF 83 42 59 C5                                      HBYE:   DB      ^3 "BY" ^'E'                            ; ***** BYE
9EE3 D4 9E                                                    DW      HNOOP
9EE5 E7 9E                                            BYE:    DW      BYE0
9EE7 0E 00                                            BYE0:   LDI     0               ; Select EEPROM bank 0
9EE9 01                                                       BNK                     ; :
9EEA 14 00 00                                                 JPA     0               ; Re-start monitor
                                                      
9EED C5 46 4F 52 54 C8                                HFORTH: DB      ^^5 "FORT" ^'H'                         ; ***** FORTH
9EF3 DF 9E                                                    DW      HBYE
9EF5 09 91 B3 96 81 A0 ED 9E                          FORTH:  DW      DODOE DOVOC 0xA081 HFORTH
9EFD 00 00                                            XXVOC:  DW      0
                                                      
9EFF 00                                               XDP:    DB      0
                                                      
                                                      ; INCLUDE         uppermem.asm
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; UPPER MEMORY AREA
                                                      
                                                              ORG     0xF5B9
                                                      
F5B9 00                                               XSP:    DB      0
F5BA 00                                               XTIB:   DB      0
                                                              DS      210             ; TIB:      84
F68D 00                                               XRP:    DB      0               ; RSTACK:  128
F68E 00                                               XUP:    DB      0
                                                              DS      80              ; Room for 40 variables
F6DF 00                                               DSKBF:  DB      0
                                                              DS      2055            ; 2 * 1028 bytes
FEE7 00                                               ENDBF:  DB      0
                                                      
                                                      ; ----------------------------------------------------------------------
                                                      ; THE VIRTUAL FORTH MACHINE REGISTERS
                                                      
                                                      IP:                             ; Instruction Pointer
FEE8 00                                               IP.0:   DB      0
FEE9 00                                               IP.1:   DB      0
                                                      
                                                      WA:                             ; Word Address Register
FEEA 00                                               WA.0:   DB      0
FEEB 00                                               WA.1:   DB      0
                                                      
                                                      SP:                             ; Data stack pointer
FEEC 00                                               SP.0:   DB      0
FEED 00                                               SP.1:   DB      0
                                                      
                                                      RP:                             ; Return stack pointer
FEEE 00                                               RP.0:   DB      0
FEEF 00                                               RP.1:   DB      0
                                                      
                                                      UP:                             ; User area pointer
FEF0 00                                               UP.0:   DB      0
FEF1 00                                               UP.1:   DB      0
                                                      
                                                      R1:                             ; Working register R1
FEF2 00                                               R1.0:   DB      0
FEF3 00                                               R1.1:   DB      0
                                                      R1H:
FEF4 00                                               R1.2:   DB      0
FEF5 00                                               R1.3:   DB      0
                                                      
                                                      R2:                             ; Working register R2
FEF6 00                                               R2.0:   DB      0
FEF7 00                                               R2.1:   DB      0
                                                      R2H:
FEF8 00                                               R2.2:   DB      0
FEF9 00                                               R2.3:   DB      0
                                                      
                                                      R3:                             ; Working register R3
FEFA 00                                               R3.0:   DB      0
FEFB 00                                               R3.1:   DB      0
                                                      R3H:
FEFC 00                                               R3.2:   DB      0
FEFD 00                                               R3.3:   DB      0
                                                      
FEFE 00                                               BC:     DB      0               ; "Hidden" registers
FEFF 00                                               TMP:    DB      0               ; (used by _AND8 _OR8 _XOR8)
